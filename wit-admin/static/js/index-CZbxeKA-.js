var _=(w,g,r)=>new Promise((l,u)=>{var e=t=>{try{c(r.next(t))}catch(p){u(p)}},f=t=>{try{c(r.throw(t))}catch(p){u(p)}},c=t=>t.done?l(t.value):Promise.resolve(t.value).then(e,f);c((r=r.apply(w,g)).next())});import{d as L,g as Q,_ as U}from"./versionManagementEdit-ZiCELEZN.js";import{d as E,P as k,r as i,b as F,h as R,m as j,o as q,c as P,y as m,p as n,a6 as A,n as v,s as h,x as S,B as W,af as G,ag as H}from"./index-CmC8Jr0A.js";import{_ as I}from"./index.vue_vue_type_style_index_0_lang-D4meg1a3.js";import"./fileUpload-XyOau-In.js";import"./ifComponent.vue_vue_type_style_index_0_lang-ZpisXDR_.js";import"./index-COFi4TtR.js";import"./index.vue_vue_type_script_setup_true_lang-DtyLHHVv.js";import"./dict-BvhWhz6G.js";const J={class:"version-container auto-height-container"},K={class:"app-content padding-out"},O=["href"],X={class:"app-pagination"},le=E({name:"VersionManagement",__name:"index",setup(w){const g=k("$baseConfirm"),r=k("$baseMessage"),l=i(!1),u=i(),e=i({pageNum:1,pageSize:20,searchQuick:{keyword:""}}),f=F({searchListButtons:[{label:"搜 索",isShowLoading:!0,attrs:{type:"primary"},events:{click:b}},{label:"发布新版",icon:"icon-jiansuo",attrs:{type:"warning"},events:{click:C}}],searchList:[{type:"searchQuick",field:"searchQuick",attrs:{width:180,placeholder:"请输入内容",clearable:!0,isFetch:!0},events:{clear:b}}]}),c=i([]),t=i(0),p=i([{field:"version",title:"版本号",width:"120"},{field:"description",title:"更新内容",minWidth:"200"},{field:"updateType",title:"更新类型",align:"center",width:"150",render:!0},{field:"downloadUrl",title:"安装包下载",width:"150",align:"center",render:!0},{field:"createTime",title:"上传时间",align:"center",width:"180"},{field:"btns",title:"操作",align:"center",width:"200",fixed:"right",render:!0}]),y=i(null);function C(){y.value.showEdit()}function z(a){return"https://mock.apipark.cn/m1/4593503-4242983-default"+a.downloadUrl}const N=(a={})=>{a.id&&g("您确定要删除当前项吗",null,()=>_(this,null,function*(){const{msg:o}=yield L(a.id);r(o,"success","hey"),yield d()}))},x=a=>{e.value.pageNum=1,e.value.pageSize=a,d()},$=a=>{e.value.pageNum=a,d()};function b(){u.value.search()}function d(){return _(this,null,function*(){l.value=!0;let a={pageNum:e.value.pageNum,pageSize:e.value.pageSize,keyword:e.value.searchQuick.keyword};const{data:o}=yield Q(a);c.value=o.records,t.value=o.total,l.value=!1})}return R(()=>{d()}),(a,o)=>{const D=I,T=j("el-button"),V=G,B=H,M=U;return q(),P("div",J,[m(D,{ref_key:"refSearch",ref:u,modelValue:n(e),"onUpdate:modelValue":o[0]||(o[0]=s=>A(e)?e.value=s:null),"search-data":n(f),"search-name":"system-versionManagement",searching:n(l),onSearch:d,isCache:!1},null,8,["modelValue","search-data","searching"]),v("div",K,[m(V,{"table-name":"system-versionManagement",isShowTableSet:!1,loading:n(l),tableData:n(c),columns:n(p)},{updateType:h(s=>[S(W(s.row.updateType==="full"?"全量更新":"增量更新"),1)]),downloadUrl:h(s=>[v("a",{href:z(s.row),target:"_blank"},"下载",8,O)]),btns:h(s=>[m(T,{text:"",type:"primary",onClick:Y=>N(s.row)},{default:h(()=>[S("删除")]),_:2},1032,["onClick"])]),_:1},8,["loading","tableData","columns"])]),v("div",X,[m(B,{"current-page":n(e).pageNum,"page-size":n(e).pageSize,total:n(t),onCurrentChange:$,onSizeChange:x},null,8,["current-page","page-size","total"])]),m(M,{ref_key:"versionEditRef",ref:y,onQuery:d},null,512)])}}});export{le as default};
