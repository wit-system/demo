var k=(g,v,c)=>new Promise((S,x)=>{var R=_=>{try{r(c.next(_))}catch(d){x(d)}},V=_=>{try{r(c.throw(_))}catch(d){x(d)}},r=_=>_.done?S(_.value):Promise.resolve(_.value).then(R,V);r((c=c.apply(g,v)).next())});import xe from"./editIncompatibilityPrescriptionDiag-DqOQePgD.js";import Ve from"./ruleEditing-DV3TpLnw.js";import{d as Ie,r as p,aj as ze,P as Be,b as Fe,b9 as C,a0 as Le,bs as Ne,m,o as y,c as T,n as s,a7 as L,p as t,y as o,s as i,B as N,z as j,q as D,aY as $e,C as E,F as Re,A as Me,x as Z,t as ee,v as te,aa as Ue,bL as Te,H as je,af as De,ag as Ee,I as Pe,J as qe,_ as Ae}from"./index-CmC8Jr0A.js";import{I as Je,J as Oe,K as He,L as ae,M as Ke}from"./indication-Cjl8NcsF.js";import"./ruleSetItemContent-C1CWiyzb.js";import"./ruleItem-D1B3madY.js";import"./judgingConditions-DCjH_Uof.js";import"./index.vue_vue_type_style_index_0_lang-D4meg1a3.js";import"./ifComponent.vue_vue_type_style_index_0_lang-ZpisXDR_.js";import"./index-COFi4TtR.js";import"./index.vue_vue_type_script_setup_true_lang-DtyLHHVv.js";import"./dict-BvhWhz6G.js";import"./ruleCustomParameters-Dcw2hLI-.js";const $=g=>(Pe("data-v-d1807ce0"),g=g(),qe(),g),Qe={class:"flex justify-between"},We={class:"flex justify-between align-center"},Ye=$(()=>s("div",{class:"title"},"配伍禁忌",-1)),Ge={class:"header-action-icon"},Xe={key:0},Ze={class:"flex justify-between align-center",style:{"flex-wrap":"wrap"}},et={class:"flex"},tt=$(()=>s("span",null,"新增配伍禁忌",-1)),at=$(()=>s("div",{class:"top"},null,-1)),nt={class:"center"},ot=$(()=>s("div",{class:"bottom"},null,-1)),lt=Ie({__name:"index",props:{ruleForm:{type:Object,default:()=>{}}},setup(g){const v=g,c=p("rule_compatibility"),S=p(null),x=p("176196503914628300811111"),R=p("1762071989564805120"),V=p(null),r=ze(),{refreshCheckStatus:_}=r,d=Be("$baseMessage"),P=p(null),u=p(!1),F=p(!1),I=p([]),z=p([]),w=p(!0),h=Fe({keyword:"",pageNum:1,pageSize:10,total:0,generalId:"",checkStatus:""}),ne=p([{width:"40",type:"checkbox"},{field:"checkStatus",title:"检查标识",width:"100",align:"center",show:C("editor"),render:!0,filters:[{label:"是",value:"1"},{label:"否",value:"0"}],filterMultiple:!1},{field:"updateName",title:"编辑人",width:"80",show:C("editor")},{field:"updateTime",title:"编辑时间",width:"165",show:C("editor")},{field:"generalInfo",title:"名称",minWidth:"140"},{field:"tipContent",title:"提示内容",width:"120"},{field:"reference",title:"参考文献",width:"120"},{field:"severity",title:"问题级别",width:"100",render:!0},{field:"isSuper",title:"超说明书用药",width:"125",render:!0},{field:"active",title:"是否屏蔽",width:"75",render:!0},{field:"warnSign",title:"禁慎用标识",width:"95",render:!0},{field:"btns",title:"操作",align:"center",width:"130",fixed:"right",render:!0}]);Le(()=>{h.generalId=v.ruleForm.id,B()});function oe(){w.value=!w.value}function B(){return k(this,null,function*(){z.value=[],u.value=!0;const{data:e}=yield Je(h);u.value=!1,I.value=e.records||[],h.total=e.total,I.value.length&&(V.value.tableMethods("setCurrentRow",I.value[0]),O({row:I.value[0]}))})}const le=e=>{h.pageNum=1,h.pageSize=e,B()},M=Ne(e=>{h.pageNum=e,B()},300);function q(e){z.value=V.value.tableMethods("getCheckboxRecords")}function A(e,a){P.value.showDiag(e,a,v.ruleForm)}function ie(){if(!z.value.length){d("请先勾选表格","info");return}J({id:z.value.map(e=>e.id)})}function J(e){Ue.confirm("是否确认删除","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>k(this,null,function*(){u.value=!0;const{msg:a}=yield Oe(e.id);u.value=!1,d(a,"success","hey"),B()})).catch(()=>{d("取消删除","info","hey")})}function se({property:e,values:a}){h[e]=a[0]||"",M(1)}function ce(){return k(this,null,function*(){u.value=!0,F.value=!0;try{const{msg:e}=yield He();F.value=!1,u.value=!1,d(e,"success","hey")}catch(e){F.value=!1}})}function re(e){return k(this,null,function*(){u.value=!0;try{const{msg:a}=yield ae(e);u.value=!1,d(a,"success","hey")}catch(a){d("规则修改失败","info","hey"),e.active=e.active==="1"?"0":"1",u.value=!1}return!1})}function O({row:e}){x.value=e.id,S.value&&S.value.query(e)}function ue(){var f;const a={checkStatus:((f=r.ruleCheckStatus.get(c.value))==null?void 0:f.checkStatus)==="1"?"0":"1",dimensionCode:c.value,refId:v.ruleForm.id};Te(a).then(({msg:b})=>{_(v.ruleForm.id),d(b,"success","hey")}).catch(()=>{_(v.ruleForm.id)})}function de(e){Ke({id:e.id,checkStatus:e.checkStatus}).then(({msg:a})=>{d(a,"success","hey")}).catch(()=>{e.checkStatus=e.checkStatus==="1"?"0":"1"})}function he(e,a){return k(this,null,function*(){u.value=!0;try{let f=Object.assign({},a,{});const b=yield ae(f);u.value=!1,d(b.msg,"success","hey")}catch(f){u.value=!1}})}function fe({row:e,rowIndex:a}){return e.isSuper=="1"?"warning-row":""}function pe(e){let a="";return r.wordbook.caution_signs.filter(f=>{f.dictValue==e.warnSign&&(a=f.dictLabel)}),a}return(e,a)=>{const f=je,b=m("el-tooltip"),me=m("el-input"),H=m("el-checkbox"),U=m("el-button"),_e=m("el-option"),ge=m("el-select"),ve=m("el-switch"),we=De,be=Ee,K=m("el-card"),ke=m("arrow-left-bold"),Q=m("el-icon"),Ce=m("arrow-right-bold"),ye=Ve,Se=xe;return y(),T("div",null,[s("div",Qe,[s("div",{class:L(["left-container",t(w)?"left-container-all":"left-container-half"])},[o(K,{class:"no-bottom-card"},{header:i(()=>{var n,l,W,Y,G;return[s("div",We,[Ye,s("div",Ge,[t(C)("editor")&&((n=t(r).ruleCheckStatus.get(t(c)))==null?void 0:n.checkStatus)==="1"?(y(),T("span",Xe,N(((l=t(r).ruleCheckStatus.get(t(c)))==null?void 0:l.checkName)||((W=t(r).ruleCheckStatus.get(t(c)))==null?void 0:W.checkBy))+"/"+N((Y=t(r).ruleCheckStatus.get(t(c)))==null?void 0:Y.checkTime),1)):j("",!0),t(C)("editor")?(y(),D(b,{key:1,class:"box-item",effect:"dark",content:((G=t(r).ruleCheckStatus.get(t(c)))==null?void 0:G.checkStatus)==="1"?"取消检查":"检查",placement:"top"},{default:i(()=>{var X;return[o(f,{icon:"icon-jiancha",class:L(["refresh-icon",{active:((X=t(r).ruleCheckStatus.get(t(c)))==null?void 0:X.checkStatus)==="1"}]),onClick:ue,style:{padding:"4px 5px 3px"}},null,8,["class"])]}),_:1},8,["content"])):j("",!0),o(b,{class:"box-item",effect:"dark",content:"刷新缓存",placement:"top"},{default:i(()=>[o(f,{icon:"icon-gengxin",class:L({"refresh-icon":!0,"loading-animation":t(F)}),onClick:ce,style:{padding:"4px"}},null,8,["class"])]),_:1})])])]}),default:i(()=>[s("div",Ze,[o(me,{modelValue:t(h).keyword,"onUpdate:modelValue":a[0]||(a[0]=n=>t(h).keyword=n),placeholder:"请输入关键字","suffix-icon":t($e),style:{width:"300px"},clearable:"",onInput:a[1]||(a[1]=n=>t(M)(1))},null,8,["modelValue","suffix-icon"]),s("div",et,[t(z).length?(y(),D(H,{key:0,"model-value":!0,label:"批量删除",border:"",style:{"margin-right":"12px"},onClick:ie})):j("",!0),o(U,{plain:"",type:"warning",onClick:a[2]||(a[2]=n=>A("","add"))},{default:i(()=>[o(f,{icon:"icon-xinzengdianpingjihua"}),tt]),_:1})])]),o(we,{ref_key:"tableRef",ref:V,"table-name":"rule-incompatibilityPrescription-table",loading:t(u),"table-data":t(I),columns:t(ne),isShowTableSet:!1,onCheckboxChange:q,onCheckboxAll:q,onFilterChange:se,onCellClick:O,"row-class-name":fe},{checkStatus:i(n=>[o(H,{modelValue:n.row.checkStatus,"onUpdate:modelValue":l=>n.row.checkStatus=l,disabled:!t(C)("editor_admin"),"true-value":"1","false-value":"0",onClick:a[3]||(a[3]=E(()=>{},["stop"])),onChange:l=>de(n.row)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])]),severity:i(n=>[o(ge,{modelValue:n.row.severity,"onUpdate:modelValue":l=>n.row.severity=l,size:"large",placeholder:"请选择",onChange:l=>he(l,n.row)},{default:i(()=>[(y(!0),T(Re,null,Me(t(r).wordbook.problem_level_rule,l=>(y(),D(_e,{key:l.dictLabel,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),isSuper:i(n=>[s("div",null,N(n.row.isSuper=="1"?"是":"否"),1)]),active:i(n=>[o(ve,{modelValue:n.row.active,"onUpdate:modelValue":l=>n.row.active=l,loading:t(u),onChange:l=>re(n.row),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),warnSign:i(n=>[s("div",null,N(pe(n.row)),1)]),btns:i(n=>[o(U,{text:"",type:"primary",onClick:E(l=>A(n.row,"edit"),["stop"])},{default:i(()=>[Z("编辑")]),_:2},1032,["onClick"]),o(U,{text:"",type:"primary",onClick:E(l=>J({id:[n.row.id]}),["stop"])},{default:i(()=>[Z("删除")]),_:2},1032,["onClick"])]),_:1},8,["loading","table-data","columns"]),o(be,{"current-page":t(h).pageNum,"page-size":t(h).pageSize,total:t(h).total,onCurrentChange:t(M),onSizeChange:le},null,8,["current-page","page-size","total","onCurrentChange"])]),_:1})],2),s("div",{class:L(["right-container",t(w)?"right-container-half":"right-container-all"])},[s("div",{class:"toggle-btn",onClick:oe},[at,s("div",nt,[ee(o(Q,null,{default:i(()=>[o(ke)]),_:1},512),[[te,t(w)]]),ee(o(Q,null,{default:i(()=>[o(Ce)]),_:1},512),[[te,!t(w)]])]),ot]),o(K,{class:"no-bottom-card"},{default:i(()=>[o(ye,{dimensionCode:t(c),refId:t(x),id:t(R),ref_key:"ruleEditingBox",ref:S},null,8,["dimensionCode","refId","id"])]),_:1})],2)]),o(Se,{ref_key:"editRowDiag",ref:P,onQuery:B},null,512)])}}}),bt=Ae(lt,[["__scopeId","data-v-d1807ce0"]]);export{bt as default};
