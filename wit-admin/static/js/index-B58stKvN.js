var b=(h,u,p)=>new Promise((w,M)=>{var x=i=>{try{k(p.next(i))}catch(f){M(f)}},s=i=>{try{k(p.throw(i))}catch(f){M(f)}},k=i=>i.done?w(i.value):Promise.resolve(i.value).then(x,s);k((p=p.apply(h,u)).next())});import fe from"./editDose-D2zDqdO0.js";import ge from"./ruleEditing-CEKDWD36.js";import{d as he,aj as ye,P as Q,r as g,b9 as S,b as _e,bs as pe,a0 as xe,m as _,o as T,c as Y,y as l,s as a,n as r,p as t,B as m,z as N,q as G,a7 as K,aY as ke,C as q,x as R,bL as Ce,H as ve,af as be,ag as Me,I as De,J as Ve,_ as Se}from"./index-BNylXLUF.js";import{d as Te}from"./compatibilityConcentration-DRMCut7a.js";import{u as qe,a as W,b as Ee}from"./ruleDose-DJ78hgkR.js";import"./ruleSetItemContent-BH3GSuI_.js";import"./ruleItem-Bjcpc8f8.js";import"./judgingConditions-B6eb1oAJ.js";import"./index.vue_vue_type_style_index_0_lang-CQ0LplO3.js";import"./ifComponent.vue_vue_type_style_index_0_lang-CZbArpmd.js";import"./index-7iMDeE21.js";import"./index.vue_vue_type_script_setup_true_lang-DuUJu87k.js";import"./dict-C-0c6999.js";import"./ruleCustomParameters-iIrn7otW.js";const X=h=>(De("data-v-aafea988"),h=h(),Ve(),h),Fe={class:"flex justify-between align-center"},$e=X(()=>r("div",{class:"title"},"用法用量",-1)),Ne={class:"header-action-icon"},Re={key:0},ze={class:"flex justify-between align-center",style:{"flex-wrap":"wrap"}},Ie={class:"flex"},Be=X(()=>r("span",null,"新增用法用量",-1)),je=he({__name:"index",props:{ruleForm:{type:Object,default:()=>{}}},setup(h){const u=ye(),{refreshCheckStatus:p}=u,w=h,M=Q("$baseConfirm"),x=Q("$baseMessage"),s=g("rule_usage_dosage"),k=g(null),i=g(!1),f=g([]),D=g([]),Z=g([{width:"40",type:"checkbox"},{field:"updateName",title:"编辑人",width:"80",show:S("editor")},{field:"updateTime",title:"编辑时间",width:"165",show:S("editor")},{field:"countType",title:"计算方式",width:"125",render:!0},{field:"hisRouteCodeNames",title:"给药途径",width:"125"},{field:"age",title:"年龄",width:"80"},{field:"freqDayMin",title:"频次",width:"80",render:!0},{field:"weight",title:"体重范围",width:"80"},{field:"surfaceName",title:"体表面积",width:"80"},{field:"singleDoseMin",title:"单次量",width:"80",render:!0},{field:"dailyVolumeMin",title:"单日量",width:"80",render:!0},{field:"singleDoseExtremum",title:"单次极量",width:"80",render:!0},{field:"dailyVolumeExtremum",title:"单日极量",width:"80",render:!0},{field:"active",title:"是否屏蔽",width:"75",align:"center",render:!0},{field:"btns",title:"操作",align:"center",width:"200",fixed:"right",render:!0}]),d=_e({keyword:"",pageNum:1,pageSize:10,total:0,dosageId:w.ruleForm.id||""});function C(){return b(this,null,function*(){D.value=[];let{data:n}=yield qe(d);f.value=n.records,d.total=n.total,f.value.length&&(k.value.tableMethods("setCurrentRow",f.value[0]),L({row:f.value[0]}))})}const ee=n=>{d.pageNum=1,d.pageSize=n,C()},E=pe(n=>{d.pageNum=n,C()},300);function z(){D.value=k.value.tableMethods("getCheckboxRecords")}const I=g(null);function F(n,o){I.value.showDiag(n,o,w.ruleForm.id,w.ruleForm.dosageUom||"")}function B(n){n.id?M("您确定要删除当前项吗",null,()=>b(this,null,function*(){const{msg:o}=yield W([n.id]);x(o,"success","hey"),yield C()})):M("您确定要批量删除选择项吗",null,()=>b(this,null,function*(){const o=D.value.map(v=>v.id),{msg:c}=yield W(o);x(c,"success","hey"),yield C()}))}function te({property:n,values:o}){d[n]=o[0]||"",E(1)}const $=g(!1);function ne(){return b(this,null,function*(){i.value=!0,$.value=!0;const{msg:n}=yield Ee({dosageId:w.ruleForm.id});i.value=!1,$.value=!1,x(n,"success","hey")})}function oe(n){return b(this,null,function*(){try{i.value=!0;const{msg:o}=yield Te(n);i.value=!1,x(o,"success","hey")}catch(o){n.active=n.active==="1"?"0":"1",i.value=!1}})}function ae(n){let o="";return(u.wordbook.calculation_method||[]).forEach(c=>{c.dictValue==n&&(o=c.dictLabel)}),o}const j=g();function L({row:n}){j.value.query(n)}function le(){var c;const o={checkStatus:((c=u.ruleCheckStatus.get(s.value))==null?void 0:c.checkStatus)==="1"?"0":"1",dimensionCode:s.value,refId:w.ruleForm.id};Ce(o).then(({msg:v})=>{p(w.ruleForm.id),x(v,"success","hey")}).catch(()=>{p(w.ruleForm.id)})}return xe(()=>{C()}),(n,o)=>{const c=ve,v=_("el-tooltip"),ie=_("el-input"),re=_("el-checkbox"),V=_("el-button"),ue=_("el-switch"),se=be,de=Me,P=_("el-card"),U=_("el-col"),ce=ge,me=_("el-row"),we=fe;return T(),Y("div",null,[l(me,{gutter:16},{default:a(()=>[l(U,{span:12},{default:a(()=>[l(P,{class:"no-bottom-card"},{header:a(()=>{var e,y,A,H,J;return[r("div",Fe,[$e,r("div",Ne,[t(S)("editor")&&((e=t(u).ruleCheckStatus.get(t(s)))==null?void 0:e.checkStatus)==="1"?(T(),Y("span",Re,m(((y=t(u).ruleCheckStatus.get(t(s)))==null?void 0:y.checkName)||((A=t(u).ruleCheckStatus.get(t(s)))==null?void 0:A.checkBy))+"/"+m((H=t(u).ruleCheckStatus.get(t(s)))==null?void 0:H.checkTime),1)):N("",!0),t(S)("editor")?(T(),G(v,{key:1,class:"box-item",effect:"dark",content:((J=t(u).ruleCheckStatus.get(t(s)))==null?void 0:J.checkStatus)==="1"?"取消检查":"检查",placement:"top"},{default:a(()=>{var O;return[l(c,{icon:"icon-jiancha",class:K(["refresh-icon",{active:((O=t(u).ruleCheckStatus.get(t(s)))==null?void 0:O.checkStatus)==="1"}]),onClick:le,style:{padding:"4px 5px 3px"}},null,8,["class"])]}),_:1},8,["content"])):N("",!0),l(v,{class:"box-item",effect:"dark",content:"刷新缓存",placement:"top"},{default:a(()=>[l(c,{icon:"icon-gengxin",class:K({"refresh-icon":!0,"loading-animation":t($)}),onClick:ne,style:{padding:"4px"}},null,8,["class"])]),_:1})])])]}),default:a(()=>[r("div",ze,[l(ie,{modelValue:t(d).keyword,"onUpdate:modelValue":o[0]||(o[0]=e=>t(d).keyword=e),clearable:"",placeholder:"请输入关键字","suffix-icon":t(ke),style:{width:"300px"},onInput:o[1]||(o[1]=e=>t(E)(1))},null,8,["modelValue","suffix-icon"]),r("div",Ie,[t(D).length?(T(),G(re,{key:0,"model-value":!0,label:"批量删除",border:"",style:{"margin-right":"12px"},onClick:B})):N("",!0),l(V,{plain:"",type:"warning",onClick:o[2]||(o[2]=e=>F("","add"))},{default:a(()=>[l(c,{icon:"icon-xinzengdianpingjihua"}),Be]),_:1})])]),l(se,{ref_key:"tableRef",ref:k,"table-name":"rule-contraindication-table",loading:t(i),tableData:t(f),columns:t(Z),isShowTableSet:!1,onCheckboxChange:z,onCheckboxAll:z,onFilterChange:te,onCellClick:L},{countType:a(e=>[r("span",null,m(ae(e.row.countType)),1)]),freqDayMin:a(e=>[r("span",null,m(e.row.freqDayMin||e.row.freqDayMin===0?e.row.freqDayMin+"天":"")+m(e.row.freqTimeMin||e.row.freqTimeMin===0?e.row.freqTimeMin+"次":"")+"至"+m(e.row.freqDayMax||e.row.freqDayMax===0?e.row.freqDayMax+"天":"")+m(e.row.freqTimeMax||e.row.freqTimeMax===0?e.row.freqTimeMax+"次":""),1)]),singleDoseMin:a(e=>[r("span",null,m(((e.row.singleDoseMin||e.row.singleDoseMin===0)&&e.row.singleDoseMin!=null?e.row.singleDoseMin+(e.row.countType=="1"?e.row.unit:e.row.countType=="2"?e.row.unit+"/m²":e.row.unit+"/kg"):"")+"-"+((e.row.singleDoseMax||e.row.singleDoseMax===0)&&e.row.singleDoseMax!=null?e.row.singleDoseMax+(e.row.countType=="1"?e.row.unit:e.row.countType=="2"?e.row.unit+"/m²":e.row.unit+"/kg"):"")),1)]),dailyVolumeMin:a(e=>[r("span",null,m(((e.row.dailyVolumeMin||e.row.dailyVolumeMin===0)&&e.row.dailyVolumeMin!=null?e.row.dailyVolumeMin+(e.row.countType=="1"?e.row.unit:e.row.countType=="2"?e.row.unit+"/m²":e.row.unit+"/kg"):"")+"-"+((e.row.dailyVolumeMax||e.row.dailyVolumeMax===0)&&e.row.dailyVolumeMax!=null?e.row.dailyVolumeMax+(e.row.countType=="1"?e.row.unit:e.row.countType=="2"?e.row.unit+"/m²":e.row.unit+"/kg"):"")),1)]),singleDoseExtremum:a(e=>[r("span",null,m((e.row.singleDoseExtremum||e.row.singleDoseExtremum===0)&&e.row.singleDoseExtremum!=null?e.row.singleDoseExtremum+(e.row.countType=="1"?e.row.unit:e.row.countType=="2"?e.row.unit+"/m²":e.row.unit+"/kg"):""),1)]),dailyVolumeExtremum:a(e=>[r("span",null,m((e.row.dailyVolumeExtremum||e.row.dailyVolumeExtremum===0)&&e.row.dailyVolumeExtremum!=null?e.row.dailyVolumeExtremum+(e.row.countType=="1"?e.row.unit:e.row.countType=="2"?e.row.unit+"/m²":e.row.unit+"/kg"):""),1)]),active:a(e=>[l(ue,{modelValue:e.row.active,"onUpdate:modelValue":y=>e.row.active=y,loading:t(i),onClick:o[3]||(o[3]=q(()=>{},["stop"])),onChange:y=>oe(e.row),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),btns:a(e=>[l(V,{text:"",type:"primary",onClick:q(y=>F(e.row,"check"),["stop"])},{default:a(()=>[R("查看")]),_:2},1032,["onClick"]),l(V,{text:"",type:"primary",onClick:q(y=>F(e.row,"edit"),["stop"])},{default:a(()=>[R("编辑")]),_:2},1032,["onClick"]),l(V,{text:"",type:"primary",onClick:q(y=>B(e.row),["stop"])},{default:a(()=>[R("删除")]),_:2},1032,["onClick"])]),_:1},8,["loading","tableData","columns"]),l(de,{"current-page":t(d).pageNum,"page-size":t(d).pageSize,total:t(d).total,"prev-text":"上一页","next-text":"下一页",onCurrentChange:t(E),onSizeChange:ee},null,8,["current-page","page-size","total","onCurrentChange"])]),_:1})]),_:1}),l(U,{span:12},{default:a(()=>[l(P,{class:"no-bottom-card"},{default:a(()=>[l(ce,{dimensionCode:t(s),ref_key:"ruleEditingBox",ref:j},null,8,["dimensionCode"])]),_:1})]),_:1})]),_:1}),l(we,{ref_key:"editDoseRefs",ref:I,onQuery:C,ruleForm:h.ruleForm},null,8,["ruleForm"])])}}}),tt=Se(je,[["__scopeId","data-v-aafea988"]]);export{tt as default};
