var V=(E,w,u)=>new Promise((h,f)=>{var _=i=>{try{e(u.next(i))}catch(p){f(p)}},m=i=>{try{e(u.throw(i))}catch(p){f(p)}},e=i=>i.done?h(i.value):Promise.resolve(i.value).then(_,m);e((u=u.apply(E,w)).next())});import{d as H,aj as J,P as K,r as d,b as L,at as G,l as Q,m as r,o as T,q as M,aP as W,s as n,y as l,x as C,c as X,F as Y,A as Z,p as x,n as ee,av as te,ae as oe,a_ as le,ah as ae,_ as se}from"./index-1fQ0gozz.js";import{T as ne,E as ie}from"./style-nYtQkoWR.js";import{u as de,p as re}from"./fileUpload-ChTulxNu.js";import{g as ue,a as ce,e as me}from"./notice-DtS2RK0I.js";const pe={style:{"margin-top":"10px",border:"1px solid #ccc"}},fe=H({name:"NoticeEdit",__name:"noticeEditBak",emits:["fetch-data"],setup(E,{expose:w,emit:u}){const h=J(),f=u,_=K("$baseMessage"),m=d(null),e=L({noticeTitle:"",noticeType:"",noticeContent:"",status:"1",remark:""}),i=d(""),p=L({noticeTitle:[{required:!0,trigger:"blur",message:"请输入公告标题"}],noticeType:[{required:!0,trigger:"blur",message:"请输入公告类型"}],noticeContent:[{required:!0,trigger:"blur",message:"请输入通知内容"}],status:[{required:!0,trigger:"blur",message:"请选择是否启用"}]}),b=d(null),y=d(""),g=d(!1),I=d(!1),U=d("default"),B=d("");w({showEdit:(o,t)=>{g.value=!0,B.value=t,te(()=>V(this,null,function*(){if(!o.noticeId)y.value="添加",I.value=!1;else{y.value="编辑",I.value=!0;const{data:a}=yield ue(o.noticeId);e.noticeId=a.noticeId,e.noticeTitle=a.noticeTitle,e.noticeType=a.noticeType,e.noticeContent=a.noticeContent,i.value=a.noticeContent,e.status=a.status,e.remark=a.remark,N()}}))}});const v=()=>{m.value.resetFields(),f("fetch-data"),g.value=!1},j=()=>{e.noticeContent=i.value,m.value.validate(o=>V(this,null,function*(){if(o)if(y.value==="添加"){const{msg:t}=yield ce(e);_(t,"success","hey"),v()}else{const{msg:t}=yield me(e);_(t,"success","hey"),v()}}))},R=o=>{b.value=o},q={toolbarKeys:["headerSelect","bold","italic","through","underline","bulletedList","numberedList","color","insertLink","fontSize","lineHeight","uploadImage","uploadVideo","delIndent","indent","deleteImage","divider","insertTable","justifyCenter","justifyJustify","justifyLeft","justifyRight","undo","redo","clearStyle","fullScreen"]},z={placeholder:"请输入内容...",MENU_CONF:{uploadImage:{base64LimitSize:5*1024,allowedFileTypes:["image/*"],customUpload(o,t){return V(this,null,function*(){try{let a="";de({file:o,bucketCode:"99"}).then(function(k){a=k.data.id,t(re(a),"",a),oe({type:"success",message:"上传附件成功！"})})}catch(a){le.error("上传附件失败！")}})}}}};G(()=>{const o=b.value;o!=null&&o.destroy()});const N=()=>{const o=b.value;o!=null&&(e.status=="0"?o.disable():o.enable())};return Q(i,o=>{}),(o,t)=>{const a=r("el-input"),c=r("el-form-item"),k=r("el-option"),$=r("el-select"),S=r("el-radio"),D=r("el-radio-group"),O=r("el-form"),F=r("el-button"),P=ae;return T(),M(P,{modelValue:g.value,"onUpdate:modelValue":t[5]||(t[5]=s=>g.value=s),title:y.value,"append-to-body":"",onClose:v},W({default:n(()=>[l(O,{ref_key:"formRef",ref:m,inline:!0,model:e,rules:p,"label-width":"80px"},{default:n(()=>[l(c,{label:"公告标题",prop:"noticeTitle",style:{width:"95%"}},{default:n(()=>[l(a,{modelValue:e.noticeTitle,"onUpdate:modelValue":t[0]||(t[0]=s=>e.noticeTitle=s),modelModifiers:{trim:!0},disabled:e.status=="0",clearable:"",maxlength:"50","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1}),l(c,{label:"公告类型",prop:"noticeType",style:{width:"400px"}},{default:n(()=>[l($,{modelValue:e.noticeType,"onUpdate:modelValue":t[1]||(t[1]=s=>e.noticeType=s),modelModifiers:{trim:!0},disabled:e.status=="0",clearable:""},{default:n(()=>[(T(!0),X(Y,null,Z(x(h).wordbook.sys_notice_type,(s,A)=>(T(),M(k,{key:A,label:s.dictLabel,value:s.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),l(c,{label:"是否启用",prop:"status",style:{width:"400px"}},{default:n(()=>[l(D,{modelValue:e.status,"onUpdate:modelValue":t[2]||(t[2]=s=>e.status=s),onChange:N},{default:n(()=>[l(S,{value:"0",label:"是"},{default:n(()=>[C("是")]),_:1}),l(S,{value:"1",label:"否"},{default:n(()=>[C("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"备注",prop:"remark",style:{width:"95%"}},{default:n(()=>[l(a,{modelValue:e.remark,"onUpdate:modelValue":t[3]||(t[3]=s=>e.remark=s),modelModifiers:{trim:!0},autosize:{minRows:2,maxRows:4},disabled:e.status=="0",maxlength:"255","show-word-limit":"",type:"textarea"},null,8,["modelValue","disabled"])]),_:1}),l(c,{label:"通知内容",prop:"noticeContent"},{default:n(()=>[ee("div",pe,[l(x(ne),{"default-config":q,editor:b.value,mode:U.value,style:{"border-bottom":"1px solid #ccc"}},null,8,["editor","mode"]),l(x(ie),{modelValue:i.value,"onUpdate:modelValue":t[4]||(t[4]=s=>i.value=s),"default-config":z,mode:U.value,style:{height:"300px","overflow-y":"hidden"},onOnCreated:R},null,8,["modelValue","mode"])])]),_:1})]),_:1},8,["model","rules"])]),_:2},[B.value=="edit"?{name:"footer",fn:n(()=>[l(F,{onClick:v},{default:n(()=>[C("取 消")]),_:1}),l(F,{type:"primary",onClick:j},{default:n(()=>[C("确 定")]),_:1})]),key:"0"}:void 0]),1032,["modelValue","title"])}}}),Ce=se(fe,[["__scopeId","data-v-479df543"]]);export{Ce as default};
