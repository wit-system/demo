var C=(v,r,w)=>new Promise((y,N)=>{var m=s=>{try{k(w.next(s))}catch(f){N(f)}},u=s=>{try{k(w.throw(s))}catch(f){N(f)}},k=s=>s.done?y(s.value):Promise.resolve(s.value).then(m,u);k((w=w.apply(v,r)).next())});import ke from"./editInteractDiag-Bfp_CI3X.js";import Ce from"./ruleEditing-CEKDWD36.js";import{d as ye,aj as be,P as G,r as _,b9 as S,b as Se,a0 as xe,m as p,o as x,c as L,y as l,s as o,n as h,p as n,B as V,z as R,q as M,a7 as K,aY as Ve,C as F,F as Ne,A as Be,x as X,bL as $e,H as Fe,af as Ie,ag as ze,I as De,J as Le,_ as Re}from"./index-BNylXLUF.js";import{R as Me,S as Z,T as Ue,U as ee,V as je}from"./indication-NBH1_vCV.js";import"./ruleSetItemContent-BH3GSuI_.js";import"./ruleItem-Bjcpc8f8.js";import"./judgingConditions-B6eb1oAJ.js";import"./index.vue_vue_type_style_index_0_lang-CQ0LplO3.js";import"./ifComponent.vue_vue_type_style_index_0_lang-CZbArpmd.js";import"./index-7iMDeE21.js";import"./index.vue_vue_type_script_setup_true_lang-DuUJu87k.js";import"./dict-C-0c6999.js";import"./ruleCustomParameters-iIrn7otW.js";const te=v=>(De("data-v-79726390"),v=v(),Le(),v),Te={class:"flex justify-between align-center"},Oe=te(()=>h("div",{class:"title"},"相互作用",-1)),Pe={class:"header-action-icon"},qe={key:0},Ee={class:"flex justify-between align-center",style:{"flex-wrap":"wrap"}},Ae={class:"flex"},He=te(()=>h("span",null,"新增相互作用",-1)),Je=ye({__name:"index",props:{ruleForm:{type:Object,default:()=>{}}},setup(v){const r=be(),{refreshCheckStatus:w}=r,y=v,N=G("$baseConfirm"),m=G("$baseMessage"),u=_("ruleInteract"),k=_(null),s=_(!1),f=_([]),B=_([]),ae=_([{width:"40",type:"checkbox"},{field:"checkStatus",title:"检查标识",width:"100",align:"center",show:S("editor"),render:!0,filters:[{label:"是",value:"1"},{label:"否",value:"0"}],filterMultiple:!1},{field:"updateName",title:"编辑人",width:"80",show:S("editor")},{field:"updateTime",title:"编辑时间",width:"165",show:S("editor")},{field:"drugsBName",title:"名称",minWidth:"140",render:!0},{field:"type",title:"分析类型",width:"100",render:!0},{field:"severity",title:"问题等级",width:"100",align:"center",filters:r.wordbook.problem_level_rule.map(e=>({label:e.dictLabel,value:e.dictValue})),filterMultiple:!1,render:!0},{field:"whetherOverstepSynopsis",title:"超说明书用药",width:"125",filters:[{label:"是",value:"1"},{label:"否",value:"0"}],filterMultiple:!1,render:!0},{field:"active",title:"是否屏蔽",width:"75",align:"center",render:!0},{field:"warnSign",title:"禁慎用标识",width:"95",render:!0},{field:"reference",title:"参考文献",width:"120"},{field:"tipContent",title:"提示内容",width:"120"},{field:"btns",title:"操作",align:"center",width:"130",fixed:"right",render:!0}]),d=Se({query:y.ruleForm.id,keyword:"",pageNum:1,pageSize:10,total:0,whetherOverstepSynopsis:"",severity:""});function b(){return C(this,null,function*(){B.value=[];const{data:e}=yield Me(d);d.total=e.total;const t=e.records;f.value=t,f.value.length&&(k.value.tableMethods("setCurrentRow",f.value[0]),q({row:f.value[0]}))})}const ne=e=>{d.pageNum=1,d.pageSize=e,b()},I=e=>{d.pageNum=e,b()};function U(){B.value=k.value.tableMethods("getCheckboxRecords")}const j=_(null);function T(e,t){j.value.showDiag(e,t)}function O(e){e.id?N("您确定要删除当前项吗",null,()=>C(this,null,function*(){const{msg:t}=yield Z([e.id]);m(t,"success","hey"),yield b()})):N("您确定要批量删除选择项吗",null,()=>C(this,null,function*(){const t=B.value.map(g=>g.id),{msg:c}=yield Z(t);m(c,"success","hey"),yield b()}))}function le({property:e,values:t}){d[e]=t[0]||"",I(1)}const z=_(!1);function oe(){return C(this,null,function*(){s.value=!0,z.value=!0;const{msg:e}=yield Ue();s.value=!1,z.value=!1,m(e,"success","hey")})}function se(e){return C(this,null,function*(){try{s.value=!0;const t=yield ee([e]);s.value=!1,m(t.msg,"success","hey")}catch(t){s.value=!1}})}function ie(e){return C(this,null,function*(){try{s.value=!0;const{msg:t}=yield ee([e]);s.value=!1,m(t,"success","hey")}catch(t){e.active=e.active==="1"?"0":"1",s.value=!1}})}const P=_();function q({row:e}){P.value.query(e)}function re(){var c;const t={checkStatus:((c=r.ruleCheckStatus.get(u.value))==null?void 0:c.checkStatus)==="1"?"0":"1",dimensionCode:u.value,refId:y.ruleForm.id};$e(t).then(({msg:g})=>{w(y.ruleForm.id),m(g,"success","hey")}).catch(()=>{w(y.ruleForm.id)})}function ce(e){je({id:e.id,checkStatus:e.checkStatus}).then(({msg:t})=>{m(t,"success","hey")}).catch(()=>{e.checkStatus=e.checkStatus==="1"?"0":"1"})}function ue(e){let t="",c=e.drugs||[],g=[];return c.map($=>{$.drugsName&&g.push($.drugsName)}),t=g.join("/"),t}function de(e){let t="";return r.wordbook.caution_signs.filter(c=>{c.dictValue==e.warnSign&&(t=c.dictLabel)}),t}return xe(()=>{b()}),(e,t)=>{const c=Fe,g=p("el-tooltip"),$=p("el-input"),E=p("el-checkbox"),D=p("el-button"),pe=p("el-option"),he=p("el-select"),me=p("el-switch"),fe=Ie,ge=ze,A=p("el-card"),H=p("el-col"),_e=Ce,ve=p("el-row"),we=ke;return x(),L("div",null,[l(ve,{gutter:16},{default:o(()=>[l(H,{span:12},{default:o(()=>[l(A,{class:"no-bottom-card"},{header:o(()=>{var a,i,J,Q,W;return[h("div",Te,[Oe,h("div",Pe,[n(S)("editor")&&((a=n(r).ruleCheckStatus.get(n(u)))==null?void 0:a.checkStatus)==="1"?(x(),L("span",qe,V(((i=n(r).ruleCheckStatus.get(n(u)))==null?void 0:i.checkName)||((J=n(r).ruleCheckStatus.get(n(u)))==null?void 0:J.checkBy))+"/"+V((Q=n(r).ruleCheckStatus.get(n(u)))==null?void 0:Q.checkTime),1)):R("",!0),n(S)("editor")?(x(),M(g,{key:1,class:"box-item",effect:"dark",content:((W=n(r).ruleCheckStatus.get(n(u)))==null?void 0:W.checkStatus)==="1"?"取消检查":"检查",placement:"top"},{default:o(()=>{var Y;return[l(c,{icon:"icon-jiancha",class:K(["refresh-icon",{active:((Y=n(r).ruleCheckStatus.get(n(u)))==null?void 0:Y.checkStatus)==="1"}]),onClick:re,style:{padding:"4px 5px 3px"}},null,8,["class"])]}),_:1},8,["content"])):R("",!0),l(g,{class:"box-item",effect:"dark",content:"刷新缓存",placement:"top"},{default:o(()=>[l(c,{icon:"icon-gengxin",class:K({"refresh-icon":!0,"loading-animation":n(z)}),onClick:oe,style:{padding:"4px"}},null,8,["class"])]),_:1})])])]}),default:o(()=>[h("div",Ee,[l($,{modelValue:n(d).keyword,"onUpdate:modelValue":t[0]||(t[0]=a=>n(d).keyword=a),clearable:"",placeholder:"请输入相互作用关键字","suffix-icon":n(Ve),style:{width:"300px"},onInput:t[1]||(t[1]=a=>I(1))},null,8,["modelValue","suffix-icon"]),h("div",Ae,[n(B).length?(x(),M(E,{key:0,"model-value":!0,label:"批量删除",border:"",style:{"margin-right":"12px"},onClick:O})):R("",!0),l(D,{plain:"",type:"warning",onClick:t[2]||(t[2]=a=>T("","add"))},{default:o(()=>[l(c,{icon:"icon-xinzengdianpingjihua"}),He]),_:1})])]),l(fe,{ref_key:"tableRef",ref:k,"table-name":"rule-contraindication-table",loading:n(s),tableData:n(f),columns:n(ae),isShowTableSet:!1,onCheckboxChange:U,onCheckboxAll:U,onFilterChange:le,onCellClick:q},{checkStatus:o(a=>[l(E,{modelValue:a.row.checkStatus,"onUpdate:modelValue":i=>a.row.checkStatus=i,disabled:!n(S)("editor_admin"),"true-value":"1","false-value":"0",onClick:t[3]||(t[3]=F(()=>{},["stop"])),onChange:i=>ce(a.row)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])]),drugsBName:o(a=>[h("span",null,V(ue(a.row)),1)]),type:o(a=>[h("span",null,V(a.type==="1"?"同成份":"同药理作用"),1)]),whetherOverstepSynopsis:o(a=>[h("div",null,V(a.row.whetherOverstepSynopsis=="1"?"是":"否"),1)]),severity:o(a=>[l(he,{modelValue:a.row.severity,"onUpdate:modelValue":i=>a.row.severity=i,placeholder:"请选择",onChange:i=>se(a.row)},{default:o(()=>[(x(!0),L(Ne,null,Be(n(r).wordbook.problem_level_rule,i=>(x(),M(pe,{key:i.dictLabel,label:i.dictLabel,value:i.dictValue},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),active:o(a=>[l(me,{modelValue:a.row.active,"onUpdate:modelValue":i=>a.row.active=i,loading:n(s),onClick:t[4]||(t[4]=F(()=>{},["stop"])),onChange:i=>ie(a.row),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),warnSign:o(a=>[h("div",null,V(de(a.row)),1)]),btns:o(a=>[l(D,{text:"",type:"primary",onClick:F(i=>T(a.row,"edit"),["stop"])},{default:o(()=>[X("编辑")]),_:2},1032,["onClick"]),l(D,{text:"",type:"primary",onClick:F(i=>O(a.row),["stop"])},{default:o(()=>[X("删除")]),_:2},1032,["onClick"])]),_:1},8,["loading","tableData","columns"]),l(ge,{"current-page":n(d).pageNum,"page-size":n(d).pageSize,total:n(d).total,"prev-text":"上一页","next-text":"下一页",onCurrentChange:I,onSizeChange:ne},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),l(H,{span:12},{default:o(()=>[l(A,{class:"no-bottom-card"},{default:o(()=>[l(_e,{dimensionCode:n(u),ref_key:"ruleEditingBox",ref:P},null,8,["dimensionCode"])]),_:1})]),_:1})]),_:1}),l(we,{ref_key:"editInteractDiagRef",ref:j,onQuery:b,ruleForm:v.ruleForm},null,8,["ruleForm"])])}}}),it=Re(Je,[["__scopeId","data-v-79726390"]]);export{it as default};
