import{d as _e,P as ve,r as n,m as U,o as W,q as he,s as i,n as l,B as x,p as a,x as h,y as t,a6 as R,aW as Y,C as ge,ap as be,c as q,z as E,H as ye,af as xe,ag as Ce,ah as Le,I as Ve,J as Te,_ as we}from"./index-1fQ0gozz.js";import{l as ke,p as Ie,f as Se,i as Ne,u as He}from"./reviewerSettings-hsQqJ8rI.js";const g=C=>(Ve("data-v-a191a647"),C=C(),Te(),C),Ue={class:"mode-edit flex-column"},We={class:"info-ul flex up-center"},Oe={class:"info-li flex up-center"},ze=g(()=>l("div",{class:"label"},"药师",-1)),De={class:"desc"},Me={class:"info-li flex up-center"},$e=g(()=>l("div",{class:"label"},"工号",-1)),Be={class:"desc"},Re={class:"info-li flex up-center"},qe=g(()=>l("div",{class:"label"},"所在科室",-1)),Ee={class:"desc"},Ke={class:"info-li flex up-center"},Pe=g(()=>l("div",{class:"label"},"所在医院",-1)),Je={class:"desc"},je={class:"mode-edit-con flex-all padding-around flex-column"},Fe={class:"flex-all flex"},Ae={class:"table-box flex-column"},Ge={class:"title"},Qe={class:"flex-all mt8"},Xe={class:"custom-checkbox flex up-center"},Ye={key:0,class:"table-box flex-column"},Ze={class:"title"},ea={class:"flex-all mt8"},aa={key:1,class:"table-box flex-column"},la=g(()=>l("div",{class:"title-box"},null,-1)),ta={class:"flex-all mt8"},sa={key:2,class:"table-box flex-column"},oa=g(()=>l("div",{class:"title-box"},null,-1)),na={class:"flex-all mt8"},da={class:"flex justify-end mt8"},ia=_e({__name:"modeEdit",emits:["query"],setup(C,{expose:Z,emit:ee}){const ae=ve("$baseMessage"),v=n(!1),le=ee,b=n(""),y=n(""),O=n(null),L=n(!1),c=n([]),te=n([{field:"hosHospName",title:"医院名称",minWidth:"120",render:!0}]),V=n(!1),se=n([{field:"deptName",title:"科室名称",minWidth:"120"},{field:"deptTypeList",title:"科室类型",minWidth:"150",render:!0}]),T=n(1),z=n(20);n(0),n("0");const _=n(!1),D=[{field:"pharmacyName",title:"药房名称",minWidth:"120",render:!0},{field:"drugTypeList",title:"药品类型",minWidth:"220",render:!0}],w=n(),oe=[{field:"drugTypeList",title:"药品类型",minWidth:"220",render:!0}],u=n("3"),m=n(),K=n(""),ne=e=>{b.value="",y.value="",v.value=!0,m.value=e,u.value=e.mode,K.value=e.deptCode,k(),["2","6"].indexOf(u.value)>-1?w.value=D.filter(s=>s.field==="pharmacyName"):["4","7"].indexOf(u.value)>-1?w.value=D.filter(s=>s.field==="drugTypeList"):w.value=D.filter(s=>s.field!=="")},k=()=>{L.value=!0,ke({userId:m.value.userId,keyWord:b.value}).then(({data:e})=>{if(L.value=!1,c.value=e||[],c.value.length>0){const s=c.value.findIndex(d=>d.hosHospCode===K.value);s>-1?(O.value.tableMethods("setCurrentRow",c.value[s]),M({row:c.value[s]})):(O.value.tableMethods("setCurrentRow",c.value[0]),M({row:c.value[0]}))}}).catch(()=>{L.value=!1,c.value=[]})},r=n(),M=({row:e})=>{r.value=e,["1","2","3","4"].indexOf(u.value)>-1&&I(e),["2","3","4","5","6","7"].indexOf(u.value)>-1&&de(e)},I=(e,s="default")=>{(!e.deptInfoList||s==="update")&&(V.value=!0,Ie({userId:m.value.userId,hosHospCode:r.value.hosHospCode,keyWord:y.value,pageNum:T.value,pageSize:z.value}).then(({data:d})=>{V.value=!1,e.deptInfoList=d.records||[],e.total=d.total||0}).catch(()=>{V.value=!1,e.deptInfoList=[],e.total=0}))},$=()=>{T.value=1,I(r.value,"update")},de=e=>{const s={userId:m.value.userId,hosHospCode:r.value.hosHospCode};["4","7"].indexOf(u.value)>-1?e.drugTypeList||(_.value=!0,Se(s).then(({data:d})=>{_.value=!1,e.drugTypeList=[{status:"1",drugTypeList:d||[]}]}).catch(()=>{_.value=!1,e.drugTypeList=[]})):e.pharmacyInfoList||(_.value=!0,Ne(s).then(({data:d})=>{_.value=!1,e.pharmacyInfoList=d||[]}).catch(()=>{_.value=!1,e.pharmacyInfoList=[]}))},ie=e=>{e.status==="1"&&(e.drugTypeList=[])},ue=()=>{const e=JSON.parse(JSON.stringify(c.value));e.forEach(d=>{d.drugTypeList&&(d.drugTypeList=d.drugTypeList[0].drugTypeList)});const s={userId:m.value.userId,hosHospCode:r.value.hosHospCode,trialMode:u.value,hospitalInfoList:e};He(s).then(({msg:d})=>{ae(d,"success","hey"),le("query"),v.value=!1})},ce=()=>{v.value=!1},re=e=>{z.value=e,I(r.value,"update")},pe=e=>{T.value=e,I(r.value,"update")};return Z({showEdit:ne}),(e,s)=>{const d=ye,P=U("el-input"),p=U("el-checkbox"),S=U("el-button"),N=xe,B=U("el-checkbox-group"),fe=Ce,me=Le;return W(),he(me,{modelValue:a(v),"onUpdate:modelValue":s[3]||(s[3]=H=>R(v)?v.value=H:null),title:"编辑",fullscreen:!0,class:"not-padding"},{default:i(()=>{var H,J,j,F,A,G,Q,X;return[l("div",Ue,[l("div",We,[l("div",Oe,[ze,l("div",De,x((H=a(m))==null?void 0:H.userName),1)]),l("div",Me,[$e,l("div",Be,x((J=a(m))==null?void 0:J.userId),1)]),l("div",Re,[qe,l("div",Ee,x((j=a(m))==null?void 0:j.deptName),1)]),l("div",Ke,[Pe,l("div",Je,x((F=a(m))==null?void 0:F.hospitalStr),1)])]),l("div",je,[l("div",Fe,[l("div",Ae,[l("div",Ge,[h(" 所审医院 "),t(P,{modelValue:a(b),"onUpdate:modelValue":s[0]||(s[0]=o=>R(b)?b.value=o:null),style:{width:"240px","margin-left":"8px"},placeholder:"输入关键字查询",clearable:"",onClear:k,onKeydown:Y(k,["enter"])},{suffix:i(()=>[t(d,{icon:"icon-sousuo1",onClick:k})]),_:1},8,["modelValue"])]),l("div",Qe,[t(N,{ref_key:"tableRef",ref:O,"table-name":"param-setting-mode-config-table",loading:a(L),"table-data":a(c),columns:a(te),isShowTableSet:!1,onCellClick:M},{hosHospName:i(o=>[l("div",Xe,[t(p,{modelValue:o.row.status,"onUpdate:modelValue":f=>o.row.status=f,onClick:s[1]||(s[1]=ge(()=>{},["stop"])),"true-value":"1","false-value":"0"},null,8,["modelValue","onUpdate:modelValue"]),l("span",{style:be({"font-family":o.row.status==="1"?"pfct":""})},x(o.row.hosHospName),5)])]),btns:i(o=>[t(S,{text:"",type:"primary"},{default:i(()=>[h("编辑")]),_:1}),t(S,{text:"",type:"primary"},{default:i(()=>[h("重置")]),_:1})]),_:1},8,["loading","table-data","columns"])])]),["1","2","3","4"].indexOf(a(u))>-1?(W(),q("div",Ye,[l("div",Ze,[h(" 科室 "),t(P,{modelValue:a(y),"onUpdate:modelValue":s[2]||(s[2]=o=>R(y)?y.value=o:null),style:{width:"240px","margin-left":"8px"},placeholder:"输入关键字查询",clearable:"",onClear:$,onKeydown:Y($,["enter"])},{suffix:i(()=>[t(d,{icon:"icon-sousuo1",onClick:$})]),_:1},8,["modelValue"])]),l("div",ea,[t(N,{"table-name":"param-setting-mode-config-table",loading:a(V),"table-data":(A=a(r))==null?void 0:A.deptInfoList,columns:a(se),isShowTableSet:!1},{deptTypeList:i(o=>[t(B,{modelValue:o.row.deptTypeList,"onUpdate:modelValue":f=>o.row.deptTypeList=f},{default:i(()=>[t(p,{label:"门诊",value:"1"}),t(p,{label:"住院",value:"2"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["loading","table-data","columns"])]),t(fe,{layout:"total, prev, pager, next","current-page":a(T),"page-size":a(z),total:((G=a(r))==null?void 0:G.total)||0,onCurrentChange:pe,onSizeChange:re},null,8,["current-page","page-size","total"])])):E("",!0),["2","3","5","6"].indexOf(a(u))>-1?(W(),q("div",aa,[la,l("div",ta,[t(N,{"table-name":"param-setting-mode-config-table",loading:a(_),"table-data":(Q=a(r))==null?void 0:Q.pharmacyInfoList,columns:a(w),isShowTableSet:!1},{pharmacyName:i(o=>[t(p,{modelValue:o.row.status,"onUpdate:modelValue":f=>o.row.status=f,label:o.row.pharmacyName,"true-value":"1","false-value":"0",onClick:f=>ie(o.row)},null,8,["modelValue","onUpdate:modelValue","label","onClick"])]),drugTypeList:i(o=>[t(B,{modelValue:o.row.drugTypeList,"onUpdate:modelValue":f=>o.row.drugTypeList=f,disabled:a(u)!=="4"&&a(u)!=="7"&&o.row.status==="0"},{default:i(()=>[t(p,{label:"西药",value:"1"}),t(p,{label:"中成药",value:"2"}),t(p,{label:"中药",value:"3"})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["loading","table-data","columns"])])])):E("",!0),["4","7"].indexOf(a(u))>-1?(W(),q("div",sa,[oa,l("div",na,[t(N,{"table-name":"param-setting-mode-config-table",loading:a(_),"table-data":(X=a(r))==null?void 0:X.drugTypeList,columns:oe,isShowTableSet:!1},{drugTypeList:i(o=>[t(B,{modelValue:o.row.drugTypeList,"onUpdate:modelValue":f=>o.row.drugTypeList=f,disabled:a(u)!=="4"&&a(u)!=="7"&&o.row.status==="0"},{default:i(()=>[t(p,{label:"西药",value:"1"}),t(p,{label:"中成药",value:"2"}),t(p,{label:"中药",value:"3"})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["loading","table-data"])])])):E("",!0)]),l("div",da,[t(S,{onClick:ce},{default:i(()=>[h("取 消")]),_:1}),t(S,{type:"primary",disabled:a(c).length===0,onClick:ue},{default:i(()=>[h("保 存")]),_:1},8,["disabled"])])])])]}),_:1},8,["modelValue"])}}}),ra=we(ia,[["__scopeId","data-v-a191a647"]]);export{ra as default};
