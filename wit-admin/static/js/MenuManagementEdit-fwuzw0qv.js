var j=(i,F,h)=>new Promise((w,y)=>{var N=c=>{try{t(h.next(c))}catch(p){y(p)}},q=c=>{try{t(h.throw(c))}catch(p){y(p)}},t=c=>c.done?w(c.value):Promise.resolve(c.value).then(N,q);t((h=h.apply(i,F)).next())});import{an as x,d as L,P as Q,r as U,b as A,m,o as _,q as b,s as e,y as l,x as u,p as n,z as g,n as v,a6 as G,av as W,ai as X,H as Y,ah as Z,_ as ee}from"./index-CmC8Jr0A.js";import{_ as le}from"./index.vue_vue_type_style_index_0_lang-DGbCLadt.js";function K(i){return x({url:"/system/menu/add",method:"post",data:i})}function te(i){return x({url:"/system/menu/edit",method:"post",data:i})}function me(i){return x({url:`/system/menu/${i.menuId}`,method:"post"})}function ae(i){return x({url:"/system/menu/list",method:"get",params:i})}const ne=L({name:"MenuManagementEdit",__name:"MenuManagementEdit",emits:["fetch-data"],setup(i,{expose:F,emit:h}){const w=h,y=Q("$baseMessage"),N=U(null),q=U([]),t=A({parentId:"",menuType:"M",icon:"",menuName:"",orderNum:"",isFrame:"1",path:"",visible:"1",status:"1",component:"",noKeepAlive:!1,query:"",activeMenu:""}),c=A({menuName:[{required:!0,trigger:"blur",message:"请输入菜单名称"}],path:[{required:!0,trigger:"blur",message:"请输入路由地址"}],orderNum:[{required:!0,trigger:"blur",message:"请输入排序"}],component:[{required:!0,trigger:"blur",message:"请输入组件路径"}]}),p=U(""),I=U(!1),S=s=>{t.icon=s};F({showEdit:(s,a)=>{I.value=!0,t.parentId=s.menuId,J(),W(()=>{a===1?p.value="添加":a===2?(p.value="编辑",delete s.children,delete s.createTime,Object.assign(t,s)):(p.value="添加子菜单",t.menuType="C")})}});const k=()=>{N.value.resetFields(),w("fetch-data"),I.value=!1,R()},B=()=>{N.value.validate(s=>j(this,null,function*(){if(s){if(t.query)try{t.query=JSON.stringify(JSON.parse(t.query))}catch(a){y("路由参数: 不是标准的JSON字符串","warning","hey");return}if(p.value==="添加"){const{msg:a}=yield K(t);y(a,"success","hey"),k()}else if(p.value==="编辑"){const{msg:a}=yield te(t);y(a,"success","hey"),k()}else{const{msg:a}=yield K(t);y(a,"success","hey"),k()}location.reload()}}))};function J(){q.value=[],ae().then(s=>{const C={menuId:0,parentId:0,menuName:"主类目",children:[]};C.children=X(s.data,"menuId","parentId","children"),q.value.push(C)})}function R(){let s={parentId:"",menuType:"M",icon:"",menuName:"",orderNum:"",isFrame:"1",path:"",visible:"1",status:"1",component:"",noKeepAlive:!1,query:"",menuId:""};Object.keys(s).forEach(a=>{t[a]=s[a]})}return(s,a)=>{const C=m("el-tree-select"),d=m("el-form-item"),r=m("el-radio"),T=m("el-radio-group"),V=m("el-input"),z=le,D=m("el-popover"),M=Y,f=m("el-tooltip"),O=m("question-filled"),E=m("el-icon"),H=m("el-form"),$=m("el-button"),P=Z;return _(),b(P,{modelValue:n(I),"onUpdate:modelValue":a[13]||(a[13]=o=>G(I)?I.value=o:null),"append-to-body":"",title:n(p),width:"830px",onClose:k},{footer:e(()=>[l($,{onClick:k},{default:e(()=>[u("取 消")]),_:1}),l($,{type:"primary",onClick:B},{default:e(()=>[u("确 定")]),_:1})]),default:e(()=>[l(H,{ref_key:"formRef",ref:N,inline:"","label-width":"160px",model:n(t),rules:n(c)},{default:e(()=>[l(d,{label:"上级菜单",style:{width:"100%"}},{default:e(()=>[l(C,{modelValue:n(t).parentId,"onUpdate:modelValue":a[0]||(a[0]=o=>n(t).parentId=o),"check-strictly":"",data:n(q),placeholder:"选择上级菜单",props:{value:"menuId",label:"menuName",children:"children"},"value-key":"menuId"},null,8,["modelValue","data"])]),_:1}),l(d,{label:"菜单类型",prop:"menuType"},{default:e(()=>[l(T,{modelValue:n(t).menuType,"onUpdate:modelValue":a[1]||(a[1]=o=>n(t).menuType=o)},{default:e(()=>[l(r,{value:"M",label:"目录"},{default:e(()=>[u("目录")]),_:1}),l(r,{value:"C",label:"菜单"},{default:e(()=>[u("菜单")]),_:1}),l(r,{value:"F",label:"按钮"},{default:e(()=>[u("按钮")]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(t).menuType!="F"?(_(),b(d,{key:0,label:"图标"},{default:e(()=>[l(D,{"popper-class":"icon-selector-popper",trigger:"hover",width:510},{reference:e(()=>[l(V,{modelValue:n(t).icon,"onUpdate:modelValue":a[2]||(a[2]=o=>n(t).icon=o),clearable:""},null,8,["modelValue"])]),default:e(()=>[l(z,{onHandleIcon:S})]),_:1})]),_:1})):g("",!0),l(d,{label:"菜单名称",prop:"menuName"},{default:e(()=>[l(V,{modelValue:n(t).menuName,"onUpdate:modelValue":a[3]||(a[3]=o=>n(t).menuName=o),clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"显示排序",prop:"orderNum"},{default:e(()=>[l(V,{modelValue:n(t).orderNum,"onUpdate:modelValue":a[4]||(a[4]=o=>n(t).orderNum=o),clearable:""},null,8,["modelValue"])]),_:1}),n(t).menuType!="F"?(_(),b(d,{key:1},{label:e(()=>[v("span",null,[l(f,{content:"选择是外链则路由地址需要以`http(s)://`开头",placement:"top"},{default:e(()=>[l(M,{icon:"ri-question-fill"})]),_:1}),u(" 是否外链 ")])]),default:e(()=>[l(T,{modelValue:n(t).isFrame,"onUpdate:modelValue":a[5]||(a[5]=o=>n(t).isFrame=o)},{default:e(()=>[l(r,{value:"0",label:"是"},{default:e(()=>[u("是")]),_:1}),l(r,{value:"1",label:"否"},{default:e(()=>[u("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})):g("",!0),n(t).menuType!="F"?(_(),b(d,{key:2,label:"路由地址",prop:"path"},{label:e(()=>[v("span",null,[l(f,{content:"访问的路由地址，如：`user`，如外网地址需内链访问则以`http(s)://`开头",placement:"top"},{default:e(()=>[l(M,{icon:"ri-question-fill"})]),_:1}),u(" 路由地址 ")])]),default:e(()=>[l(V,{modelValue:n(t).path,"onUpdate:modelValue":a[6]||(a[6]=o=>n(t).path=o),clearable:"",placeholder:"请输入组件路径"},null,8,["modelValue"])]),_:1})):g("",!0),n(t).menuType=="C"&&n(t).isFrame==="1"?(_(),b(d,{key:3,prop:"component"},{label:e(()=>[v("span",null,[l(f,{content:"访问的组件路径，如：`views/system/user/index`",placement:"top"},{default:e(()=>[l(M,{icon:"ri-question-fill"})]),_:1}),u(" 组件路径 ")])]),default:e(()=>[l(V,{modelValue:n(t).component,"onUpdate:modelValue":a[7]||(a[7]=o=>n(t).component=o),placeholder:"请输入组件路径"},null,8,["modelValue"])]),_:1})):g("",!0),n(t).menuType=="C"?(_(),b(d,{key:4},{label:e(()=>[v("span",null,[l(f,{content:'Query形式传递参数，如：`{"id":1}`',placement:"top"},{default:e(()=>[l(E,null,{default:e(()=>[l(O)]),_:1})]),_:1}),u(" 路由参数 ")])]),default:e(()=>[l(V,{modelValue:n(t).query,"onUpdate:modelValue":a[8]||(a[8]=o=>n(t).query=o),placeholder:"请输入路由参数",maxlength:"255"},null,8,["modelValue"])]),_:1})):g("",!0),n(t).menuType=="C"?(_(),b(d,{key:5,prop:"noKeepAlive"},{label:e(()=>[v("span",null,[l(f,{content:"选择是则会被`keep-alive`缓存，需要匹配组件的`name`和地址保持一致",placement:"top"},{default:e(()=>[l(E,null,{default:e(()=>[l(O)]),_:1})]),_:1}),u(" 是否缓存 ")])]),default:e(()=>[l(T,{modelValue:n(t).noKeepAlive,"onUpdate:modelValue":a[9]||(a[9]=o=>n(t).noKeepAlive=o)},{default:e(()=>[l(r,{value:!1,label:"缓存"},{default:e(()=>[u("缓存")]),_:1}),l(r,{value:!0,label:"不缓存"},{default:e(()=>[u("不缓存")]),_:1})]),_:1},8,["modelValue"])]),_:1})):g("",!0),l(d,{label:"显示状态",prop:"visible"},{label:e(()=>[v("span",null,[l(f,{content:"选择隐藏则路由将不会出现在侧边栏，但仍然可以访问",placement:"top"},{default:e(()=>[l(M,{icon:"ri-question-fill"})]),_:1}),u(" 显示状态 ")])]),default:e(()=>[l(T,{modelValue:n(t).visible,"onUpdate:modelValue":a[10]||(a[10]=o=>n(t).visible=o)},{default:e(()=>[l(r,{value:"0",label:"显示"},{default:e(()=>[u("显示")]),_:1}),l(r,{value:"1",label:"隐藏"},{default:e(()=>[u("隐藏")]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(t).visible=="1"?(_(),b(d,{key:6},{label:e(()=>[v("span",null,[l(f,{content:"手动指定高亮菜单，一般是父级路由，如：/spotCheckComments/spotCheck",placement:"top"},{default:e(()=>[l(E,null,{default:e(()=>[l(O)]),_:1})]),_:1}),u(" 高亮菜单路由 ")])]),default:e(()=>[l(V,{modelValue:n(t).activeMenu,"onUpdate:modelValue":a[11]||(a[11]=o=>n(t).activeMenu=o),placeholder:"请输入高亮菜单路由",maxlength:"255"},null,8,["modelValue"])]),_:1})):g("",!0),l(d,{label:"菜单状态",prop:"status"},{label:e(()=>[v("span",null,[l(f,{content:"选择停用则路由将不会出现在侧边栏，也不能被访问",placement:"top"},{default:e(()=>[l(M,{icon:"ri-question-fill"})]),_:1}),u(" 菜单状态 ")])]),default:e(()=>[l(T,{modelValue:n(t).status,"onUpdate:modelValue":a[12]||(a[12]=o=>n(t).status=o)},{default:e(()=>[l(r,{value:"0",label:"正常"},{default:e(()=>[u("正常")]),_:1}),l(r,{value:"1",label:"停用"},{default:e(()=>[u("停用")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),oe=ee(ne,[["__scopeId","data-v-03f78866"]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"}));export{ie as M,oe as _,me as d,ae as g};
