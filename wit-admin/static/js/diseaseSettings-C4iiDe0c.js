var g=(k,C,c)=>new Promise((R,f)=>{var m=s=>{try{r(c.next(s))}catch(p){f(p)}},h=s=>{try{r(c.throw(s))}catch(p){f(p)}},r=s=>s.done?R(s.value):Promise.resolve(s.value).then(m,h);r((c=c.apply(k,C)).next())});import{i as H,a as O,b as G,_ as J}from"./editDiseaseSettingsDiag-D8K_496P.js";import{_ as K}from"./index.vue_vue_type_style_index_0_lang-Rf1iYlx6.js";import{_ as Q}from"./index-Chz8TBPT.js";import{d as X,aj as Y,r as t,P as T,b as Z,a0 as ee,m as I,o as ae,c as te,y as o,s as u,p as i,a6 as x,C as se,x as le,af as oe}from"./index-C3-31E46.js";import"./ifComponent.vue_vue_type_style_index_0_lang-h1Ozx49r.js";import"./index-B93FDT35.js";import"./index.vue_vue_type_script_setup_true_lang-DLP8ok9d.js";import"./dict-Bt1K3r7e.js";const ne={class:"auto-height-container"},ge=X({__name:"diseaseSettings",setup(k){const C=Y(),c=t(null),R=t(null),f=t(null),m=t(null),h=t([]),r=t([]),s=t([]),p=t(0),D=t(!1),$=T("$baseConfirm"),V=T("$baseMessage"),B=t([{field:"dictValue",title:"编码",minWidth:"130"},{field:"dictLabel",title:"疾病类型",minWidth:"130"}]),W=t([{field:"hisIcd10Code",title:"医院诊断代码",minWidth:"130"},{field:"hisIcd10Name",title:"医院诊断名称",minWidth:"130"},{field:"syIcd10Code",title:"系统诊断代码",minWidth:"130"},{field:"syIcd10Name",title:"系统诊断名称",minWidth:"130"},{field:"btns",title:"操作",align:"center",width:"70",fixed:"right",render:!0}]),n=t({keyword:"",type:1,pageNo:1,pageSize:99999}),M=Z({searchListButtons:[{label:"查询",isShowLoading:!0,attrs:{type:"primary"},events:{click:z}}],searchList:[{type:"input",field:"keyword",label:"已添加诊断",isOutBorder:!0,clearable:!0,attrs:{width:180,placeholder:"请输入关键字",clearable:!0}}],rightSearchListButtons:[{label:"新增ICD诊断项",icon:"icon-jiahao",isShowLoading:!0,attrs:{type:"primary"},events:{click:P}}]}),E=t(!1),L=t();function z(){L.value.search()}ee(()=>{A(),y()});const S=e=>{n.value.pageNum=e,y()},A=()=>{let e=C.wordbook.pathology_type.map(a=>({dictValue:a.dictValue,dictLabel:a.dictLabel}));h.value=e,c.value.tableMethods("setCurrentRow",h.value[0]),N({row:h.value[0]})};function y(e){return g(this,null,function*(){D.value=!0;let a={pageNo:n.value.pageNum,pageSize:n.value.pageSize,keyword:n.value.keyword,diseaseType:m.value.dictValue,type:1};const d=yield H(a);r.value=d.data.records,p.value=d.data.total,D.value=!1})}function P(){return g(this,null,function*(){s.value=(r.value||[]).map(e=>e),n.value.keyword="",yield y(),f.value.showEdit({selectorType:6,diseaseType:m.value.dictValue,selectArr:s.value})})}function N(e){m.value=e.row,S(1)}function U(e){e.id&&$("您确定要删除当前项吗",null,()=>g(this,null,function*(){const{msg:a}=yield O(e);V(a,"success","hey"),S(1)}))}function j(e){return g(this,null,function*(){let a=[];(e||[]).forEach(l=>{let v=!1;a.forEach(w=>{l.hisIcd10Code==w.hisIcd10Code&&w.syIcd10Code==l.syIcd10Code&&(v=!0)}),v||a.push(l)});let d={diseaseType:m.value.dictValue,homhIdxDiseaseList:(e||[]).map(l=>({syIcd10Name:l.syIcd10Name||"",syIcd10Code:l.syIcd10Code||"",hisIcd10Code:l.hisIcd10Code||"",hisIcd10Name:l.hisIcd10Name||""}))};const{msg:b}=yield G(d);V(b,"success","hey"),S(1)})}return(e,a)=>{const d=oe,b=Q,l=I("el-col"),v=K,w=I("el-button"),q=I("el-row"),F=J;return ae(),te("div",ne,[o(q,null,{default:u(()=>[o(l,{lg:12},{default:u(()=>[o(b,{class:"auto-height-card has-header"},{default:u(()=>[o(d,{ref_key:"tableRef",ref:c,"table-name":"rule-disease-setting-table",tableData:i(h),columns:i(B),isShowTableSet:!1,onCellClick:N},null,8,["tableData","columns"])]),_:1})]),_:1}),o(l,{lg:12},{default:u(()=>[o(b,{class:"auto-height-card has-header"},{default:u(()=>[o(v,{ref_key:"refSearchR",ref:L,modelValue:i(n),"onUpdate:modelValue":a[0]||(a[0]=_=>x(n)?n.value=_:null),"search-data":i(M),"search-name":"matchingTools-disease-setting-search",searching:i(E),showResult:!1,isCache:!1,border:!1,padding:!1,onSearch:y},null,8,["modelValue","search-data","searching"]),o(d,{ref_key:"tableRef1",ref:R,"table-name":"rule-diagnostic-matching-table","table-data":i(r),columns:i(W),isShowTableSet:!1},{btns:u(_=>[o(w,{text:"",type:"danger",onClick:se(ie=>U(_.row),["stop"])},{default:u(()=>[le("删除")]),_:2},1032,["onClick"])]),_:1},8,["table-data","columns"])]),_:1})]),_:1})]),_:1}),o(F,{modelValue:i(s),"onUpdate:modelValue":[a[1]||(a[1]=_=>x(s)?s.value=_:null),j],ref_key:"editDiseaseSettings",ref:f},null,8,["modelValue"])])}}});export{ge as default};
