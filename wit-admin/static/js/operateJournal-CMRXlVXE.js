var v=(_,f,r)=>new Promise((u,i)=>{var g=a=>{try{t(r.next(a))}catch(l){i(l)}},d=a=>{try{t(r.throw(a))}catch(l){i(l)}},t=a=>a.done?u(a.value):Promise.resolve(a.value).then(g,d);t((r=r.apply(_,f)).next())});import{d as L,P as b,r as s,b as M,h as V,m as W,T as F,o as w,c as J,y as p,n as m,s as h,B as C,t as P,q,x as I,af as Y,ag as j}from"./index-CmC8Jr0A.js";import{_ as R}from"./index.vue_vue_type_style_index_0_lang-D4meg1a3.js";import{_ as E}from"./operateLogDetail.vue_vue_type_script_setup_true_lang-SrGuE2Ae.js";import{c as U,g as A}from"./systemLog-OrPgVpJu.js";import"./ifComponent.vue_vue_type_style_index_0_lang-ZpisXDR_.js";import"./index-COFi4TtR.js";import"./index.vue_vue_type_script_setup_true_lang-DtyLHHVv.js";import"./dict-BvhWhz6G.js";const G={class:"system-operateJournal-container auto-height-container"},H={class:"app-content padding-out"},K={class:"app-pagination"},re=L({name:"OperateJournal",__name:"operateJournal",setup(_){const f=b("$baseConfirm"),r=b("$baseMessage"),u=s([]),i=s(!0),g=s([{field:"operId",title:"日志编号",minWidth:"120"},{field:"userInfo",title:"用户信息",minWidth:"120"},{field:"requestMethodInfo",title:"请求信息",minWidth:"120"},{field:"operParam",title:"请求参数",minWidth:"120"},{field:"title",title:"操作模块",width:"90"},{field:"method",title:"操作名",minWidth:"140"},{field:"operatorType",title:"操作类型",width:"90",render:!0},{field:"operName",title:"操作人",width:"100"},{field:"operIp",title:"操作地址",minWidth:"140"},{field:"status",title:"操作结果",width:"80",render:!0},{field:"operTime",title:"操作日期",width:"140"},{field:"costTime",title:"执行时长",width:"80"},{field:"btns",title:"操作",align:"center",width:"90",fixed:"right",render:!0}]),d=s(0),t=s({title:"",account:"",searchDate:[],operatorType:"",status:"",pageNum:1,pageSize:20}),a=M({searchList:[{type:"input",field:"title",label:"系统模块",isOutBorder:!0,attrs:{width:180,placeholder:"请输入系统模块",clearable:!0},events:{}},{type:"input",field:"operName",label:"操作人员",isOutBorder:!0,attrs:{width:180,placeholder:"请输入操作人员",clearable:!0},events:{}},{type:"select",field:"operatorType",label:"操作类型",isOutBorder:!0,valueField:"institutionCode",labelField:"institutionName",options:[{institutionCode:"0",institutionName:"其他"},{institutionCode:"1",institutionName:"后台用户"},{institutionCode:"2",institutionName:"手机端用户"}],attrs:{width:120,clearable:!0},events:{}},{type:"select",field:"status",label:"操作状态",isOutBorder:!0,valueField:"institutionCode",labelField:"institutionName",options:[{institutionCode:"0",institutionName:"正常"},{institutionCode:"1",institutionName:"异常"}],attrs:{width:100,clearable:!0},events:{}},{type:"date-picker",field:"searchDate",label:"操作日期",isOutBorder:!0,attrs:{width:240,placeholder:"请选择",clearable:!0,format:"YYYY-MM-DD",type:"daterange"},events:{}}],searchListButtons:[{label:"搜 索",isShowLoading:!0,attrs:{type:"primary"},events:{click:D}},{label:"清空日志",isShowLoading:!0,attrs:{type:"primary"},events:{click:k}}]}),l=s();function D(){l.value.search()}const y=s(null);function N(e){y.value.openShow(e)}const S=e=>{t.value.pageSize=e,c()},T=e=>{t.value.pageNum=e,c()};function k(e={}){f("您确定要清空日志吗",null,()=>v(this,null,function*(){const{msg:n}=yield U();r(n,"success","hey"),yield c()}))}const c=()=>v(this,null,function*(){i.value=!0;const e=Object.assign({},t.value);e.searchDate&&e.searchDate.length>0&&(e.beginTime=e.searchDate[0],e.endTime=e.searchDate[1]),delete e.searchDate;try{const{data:n}=yield A(e);u.value=n.records,d.value=n.total,i.value=!1}catch(n){i.value=!1}});return V(()=>{c()}),(e,n)=>{const B=R,$=W("el-button"),z=Y,O=j,x=F("hasPermi");return w(),J("div",G,[p(B,{ref_key:"refSearch",ref:l,modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=o=>t.value=o),"search-data":a,"search-name":"system-operateJournal-search",searching:i.value,onSearch:c},null,8,["modelValue","search-data","searching"]),m("div",H,[p(z,{"table-name":"system-operateJournal-table",height:"100%",loading:i.value,tableData:u.value,columns:g.value},{operatorType:h(o=>[m("span",null,C(o.row.operatorType==0?"其它":o.row.operatorType==1?"后台用户":"手机端用户"),1)]),status:h(o=>[m("span",null,C(o.row.status==0?"正常":"异常"),1)]),btns:h(o=>[P((w(),q($,{link:"",type:"primary",onClick:Q=>N(o.row)},{default:h(()=>[I("详情")]),_:2},1032,["onClick"])),[[x,["infra:config:query"]]])]),_:1},8,["loading","tableData","columns"])]),m("div",K,[p(O,{"current-page":t.value.pageNum,"page-size":t.value.pageSize,total:d.value,onCurrentChange:T,onSizeChange:S},null,8,["current-page","page-size","total"])]),p(E,{ref_key:"detailRef",ref:y},null,512)])}}});export{re as default};
