var y=(g,m,_)=>new Promise((p,I)=>{var E=l=>{try{v(_.next(l))}catch(C){I(C)}},V=l=>{try{v(_.throw(l))}catch(C){I(C)}},v=l=>l.done?p(l.value):Promise.resolve(l.value).then(E,V);v((_=_.apply(g,m)).next())});import Le from"./editContraindicationDiag-q9gUv-Mk.js";import Te from"./ruleEditing-CEKDWD36.js";import{d as Be,r as f,aj as Fe,P as Me,b9 as M,b as Z,a0 as Ne,bs as ze,m as h,o as S,c as D,n as s,a7 as N,p as t,y as o,s as i,B,z as O,q as U,aY as Ee,F as Re,A as $e,C as ee,x as te,t as ae,v as ne,aa as De,ae as j,bL as Oe,H as Ue,af as je,ag as Pe,I as qe,J as We,_ as Ae}from"./index-BNylXLUF.js";import{q as He,s as Je,t as Qe,u as Ye,v as le}from"./indication-NBH1_vCV.js";import"./ruleSetItemContent-BH3GSuI_.js";import"./ruleItem-Bjcpc8f8.js";import"./judgingConditions-B6eb1oAJ.js";import"./index.vue_vue_type_style_index_0_lang-CQ0LplO3.js";import"./ifComponent.vue_vue_type_style_index_0_lang-CZbArpmd.js";import"./index-7iMDeE21.js";import"./index.vue_vue_type_script_setup_true_lang-DuUJu87k.js";import"./dict-C-0c6999.js";import"./ruleCustomParameters-iIrn7otW.js";const z=g=>(qe("data-v-1ebaf5e0"),g=g(),We(),g),Ge={class:"flex justify-between"},Ke={class:"flex justify-between align-center"},Xe=z(()=>s("div",{class:"title"},"禁忌证",-1)),Ze={class:"header-action-icon"},et={key:0},tt={class:"flex justify-between align-center",style:{"flex-wrap":"wrap"}},at={class:"flex"},nt=z(()=>s("span",null,"新增禁忌证",-1)),lt=z(()=>s("div",{class:"top"},null,-1)),ot={class:"center"},it=z(()=>s("div",{class:"bottom"},null,-1)),st=Be({__name:"index",props:{ruleForm:{type:Object,default:()=>{}}},setup(g){const m=g,_=f(null),p=f("icd10_contraindication"),I=f(""),E=f(""),V=f(null),v=f(!1),l=Fe(),{refreshCheckStatus:C}=l,w=Me("$baseMessage"),P=f(null),d=f(!1),b=f([]),L=f([]),k=f(!0),oe=f([{width:"40",type:"checkbox"},{field:"updateName",title:"编辑人",width:"80",show:M("editor")},{field:"updateTime",title:"编辑时间",width:"165",show:M("editor")},{field:"icdCode",title:"编码",minWidth:"140"},{field:"icdName",title:"名称",minWidth:"140"},{field:"icdType",title:"诊断类型",width:"120",filters:l.wordbook.diagnostic_type.map(e=>({label:e.dictLabel,value:e.dictValue})),filterMultiple:!1,render:!0},{field:"whetherOverstepSynopsis",title:"超说明书用药",width:"125",filters:[{label:"是",value:"1"},{label:"否",value:"0"}],filterMultiple:!1,render:!0},{field:"warnSign",title:"禁慎用标识",width:"115",filters:[{label:"禁用",value:"0"},{label:"慎用",value:"1"}],filterMultiple:!1,render:!0},{field:"severity",title:"问题级别",width:"100",filters:l.wordbook.problem_level_rule.map(e=>({label:e.dictLabel,value:e.dictValue})),filterMultiple:!1,render:!0},{field:"active",title:"是否屏蔽",width:"75",render:!0},{field:"btns",title:"操作",align:"center",width:"130",fixed:"right",render:!0}]),F=Z({id:"",generalId:"",noIcd10ProblemLevel:"",keyWord:"",bs:"2"}),r=Z({keyword:"",pageNum:1,pageSize:100,total:0,bs:"2",generalId:"",icdType:"",active:"",whetherOverstepSynopsis:""});Ne(()=>{r.generalId=m.ruleForm.id,F.generalId=m.ruleForm.id,T(),re()});function ie(){k.value=!k.value}function T(){return y(this,null,function*(){L.value=[];let e=yield He(r);if(e.resultCode!=1){b.value=[],r.total=e.data.total;return}b.value=e.data.records||[],r.total=e.data.total,b.value.length&&(b.value.forEach(a=>{a.isChk=!1}),V.value.tableMethods("setCurrentRow",b.value[0]),H({row:b.value[0]}))})}const se=e=>{r.pageNum=1,r.pageSize=e,T()},R=ze(e=>{r.pageNum=e,T()},300);function re(){return y(this,null,function*(){let e=yield Je({generalId:r.generalId,bs:"2"});if(e.resultCode!=1){F.noIcd10ProblemLevel="",F.keyWord="";return}e.data&&Object.assign(F,e.data)})}function q(e){L.value=V.value.tableMethods("getCheckboxRecords")}function W(e,a){P.value.showDiag(e,a,m.ruleForm.id)}function ce(){if(!L.value.length){w("请先勾选表格","info");return}A({id:L.value.map(e=>e.id)})}function A(e){De.confirm("是否确认删除","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>y(this,null,function*(){d.value=!0;const{msg:a}=yield Qe({bs:2,generalId:r.generalId,ids:e.id});d.value=!1,w(a,"success","hey"),T()})).catch(()=>{j({type:"info",message:"取消删除"})})}function de({property:e,values:a}){r[e]=a[0]||"",R(1)}function ue(e){let a="";return l.wordbook.diagnostic_type.forEach(u=>{u.dictValue==e&&(a=u.dictLabel)}),a}function fe(){return y(this,null,function*(){d.value=!0,v.value=!0;let e=yield Ye({bs:2});if(d.value=!1,v.value=!1,e.resultCode!="1"){j({type:"info",message:"刷新失败"});return}j({type:"success",message:"刷新成功"})})}function pe(e){return y(this,null,function*(){d.value=!0;try{let a=yield le(e);if(d.value=!1,a.resultCode!=1){e.active=e.active==="1"?"0":"1",w("规则修改失败","info","hey");return}w("规则修改成功","success","hey")}catch(a){w("规则修改失败","info","hey"),e.active=e.active==="1"?"0":"1",d.value=!1}return!1})}function H({row:e}){I.value=e.id,_.value&&_.value.query(e)}function he(){var u;const a={checkStatus:((u=l.ruleCheckStatus.get(p.value))==null?void 0:u.checkStatus)==="1"?"0":"1",dimensionCode:p.value,refId:m.ruleForm.id};Oe(a).then(({msg:x})=>{C(m.ruleForm.id),w(x,"success","hey")}).catch(()=>{C(m.ruleForm.id)})}function me(e,a){return y(this,null,function*(){d.value=!0;try{let u=Object.assign({},a,{});const x=yield le(u);d.value=!1,w(x.msg,"success","hey")}catch(u){d.value=!1}})}function _e({row:e,rowIndex:a}){return e.whetherOverstepSynopsis=="1"?"warning-row":""}return(e,a)=>{const u=Ue,x=h("el-tooltip"),ge=h("el-input"),ve=h("el-checkbox"),$=h("el-button"),we=h("el-option"),be=h("el-select"),ye=h("el-switch"),Ce=je,ke=Pe,J=h("el-card"),xe=h("arrow-left-bold"),Q=h("el-icon"),Se=h("arrow-right-bold"),Ie=Te,Ve=Le;return S(),D("div",null,[s("div",Ge,[s("div",{class:N(["left-container",t(k)?"left-container-all":"left-container-half"])},[o(J,{class:"no-bottom-card"},{header:i(()=>{var n,c,Y,G,K;return[s("div",Ke,[Xe,s("div",Ze,[t(M)("editor")&&((n=t(l).ruleCheckStatus.get(t(p)))==null?void 0:n.checkStatus)==="1"?(S(),D("span",et,B(((c=t(l).ruleCheckStatus.get(t(p)))==null?void 0:c.checkName)||((Y=t(l).ruleCheckStatus.get(t(p)))==null?void 0:Y.checkBy))+"/"+B((G=t(l).ruleCheckStatus.get(t(p)))==null?void 0:G.checkTime),1)):O("",!0),t(M)("editor")?(S(),U(x,{key:1,class:"box-item",effect:"dark",content:((K=t(l).ruleCheckStatus.get(t(p)))==null?void 0:K.checkStatus)==="1"?"取消检查":"检查",placement:"top"},{default:i(()=>{var X;return[o(u,{icon:"icon-jiancha",class:N(["refresh-icon",{active:((X=t(l).ruleCheckStatus.get(t(p)))==null?void 0:X.checkStatus)==="1"}]),onClick:he,style:{padding:"4px 5px 3px"}},null,8,["class"])]}),_:1},8,["content"])):O("",!0),o(x,{class:"box-item",effect:"dark",content:"刷新缓存",placement:"top"},{default:i(()=>[o(u,{icon:"icon-gengxin",class:N({"refresh-icon":!0,"loading-animation":t(v)}),onClick:fe,style:{padding:"4px"}},null,8,["class"])]),_:1})])])]}),default:i(()=>[s("div",tt,[o(ge,{modelValue:t(r).keyword,"onUpdate:modelValue":a[0]||(a[0]=n=>t(r).keyword=n),placeholder:"请输入禁忌证关键字","suffix-icon":t(Ee),style:{width:"300px"},clearable:"",onInput:a[1]||(a[1]=n=>t(R)(1))},null,8,["modelValue","suffix-icon"]),s("div",at,[t(L).length?(S(),U(ve,{key:0,"model-value":!0,label:"批量删除",border:"",style:{"margin-right":"12px"},onClick:ce})):O("",!0),o($,{plain:"",type:"warning",onClick:a[2]||(a[2]=n=>W("","add"))},{default:i(()=>[o(u,{icon:"icon-xinzengdianpingjihua"}),nt]),_:1})])]),o(Ce,{ref_key:"tableRef",ref:V,"table-name":"rule-contraindication-table",loading:t(d),"table-data":t(b),columns:t(oe),isShowTableSet:!1,onCheckboxChange:q,onCheckboxAll:q,onFilterChange:de,onCellClick:H,"row-class-name":_e},{warnSign:i(n=>[s("span",null,B(n.row.warnSign=="0"?"禁用":n.row.warnSign=="1"?"慎用":""),1)]),icdType:i(n=>[s("span",null,B(ue(n.row.icdType)),1)]),whetherOverstepSynopsis:i(n=>[s("div",null,B(n.row.whetherOverstepSynopsis=="1"?"是":"否"),1)]),severity:i(n=>[o(be,{modelValue:n.row.severity,"onUpdate:modelValue":c=>n.row.severity=c,size:"large",placeholder:"请选择",onChange:c=>me(c,n.row)},{default:i(()=>[(S(!0),D(Re,null,$e(t(l).wordbook.problem_level_rule,c=>(S(),U(we,{key:c.dictLabel,label:c.dictLabel,value:c.dictValue},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),active:i(n=>[o(ye,{modelValue:n.row.active,"onUpdate:modelValue":c=>n.row.active=c,loading:t(d),onChange:c=>pe(n.row),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),btns:i(n=>[o($,{text:"",type:"primary",onClick:ee(c=>W(n.row,"edit"),["stop"])},{default:i(()=>[te("编辑")]),_:2},1032,["onClick"]),o($,{text:"",type:"primary",onClick:ee(c=>A({id:[n.row.id]}),["stop"])},{default:i(()=>[te("删除")]),_:2},1032,["onClick"])]),_:1},8,["loading","table-data","columns"]),o(ke,{"current-page":t(r).pageNum,"page-size":t(r).pageSize,total:t(r).total,"prev-text":"上一页","next-text":"下一页",onCurrentChange:t(R),onSizeChange:se},null,8,["current-page","page-size","total","onCurrentChange"])]),_:1})],2),s("div",{class:N(["right-container",t(k)?"right-container-half":"right-container-all"])},[s("div",{class:"toggle-btn",onClick:ie},[lt,s("div",ot,[ae(o(Q,null,{default:i(()=>[o(xe)]),_:1},512),[[ne,t(k)]]),ae(o(Q,null,{default:i(()=>[o(Se)]),_:1},512),[[ne,!t(k)]])]),it]),o(J,{class:"no-bottom-card"},{default:i(()=>[o(Ie,{dimensionCode:t(p),refId:t(I),id:t(E),ref_key:"ruleEditingBox",ref:_},null,8,["dimensionCode","refId","id"])]),_:1})],2)]),o(Ve,{ref_key:"editRowDiag",ref:P,onQuery:T},null,512)])}}}),Ct=Ae(st,[["__scopeId","data-v-1ebaf5e0"]]);export{Ct as default};
