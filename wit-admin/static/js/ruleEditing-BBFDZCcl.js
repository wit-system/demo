var w=(n,x,d)=>new Promise((I,h)=>{var S=a=>{try{e(d.next(a))}catch(p){h(p)}},l=a=>{try{e(d.throw(a))}catch(p){h(p)}},e=a=>a.done?I(a.value):Promise.resolve(a.value).then(S,l);e((d=d.apply(n,x)).next())});import P from"./ruleSetItemContent-D7rCiVyD.js";import{d as K,r as f,aw as Q,P as U,m as E,T as W,o as i,c as r,y as t,s as _,n as o,B as T,x as R,p as c,z as C,t as X,a7 as N,F as $,A as G,q as Y,bb as Z,H as ee,I as te,J as ne,_ as ae}from"./index-BN8uVNSO.js";import{s as se,c as oe}from"./ruleCustomParameters-D1NrVm7e.js";import"./ruleItem-C9FT7fac.js";import"./judgingConditions-BTKVFXak.js";import"./index.vue_vue_type_style_index_0_lang-CYTYEVrP.js";import"./ifComponent.vue_vue_type_style_index_0_lang-TMjKtAQ8.js";import"./index-DxSYlWYB.js";import"./index.vue_vue_type_script_setup_true_lang-BkXq5IQh.js";import"./dict-Ck584AJf.js";const k=n=>(te("data-v-8520b8d0"),n=n(),ne(),n),le={class:"sub-title"},ie={class:"title"},ce={class:"operate flex up-center space-between"},ue={class:"operate-left"},re={key:0},de=k(()=>o("span",null,"添加集",-1)),pe={class:"rule-set-item-title flex up-center space-between"},me={class:"rule-set-item-title-left"},fe={class:"rule-set-item-title-right"},_e=k(()=>o("span",null,"添加与或组",-1)),ve=k(()=>o("span",null,"添加排除组",-1)),ge=k(()=>o("span",null,"删除本集",-1)),ye={key:0,class:"rule-list-empty"},he={key:0,class:"footer-button"},be=K({name:"RuleEditing",__name:"ruleEditing",props:{dimensionCode:{type:String,default:""},autoFlex:{type:Boolean,default:!1},noEdit:{type:Boolean,default:!1},title:{type:String,default:"规则维护"},apiType:{type:String,default:"default"}},setup(n,{expose:x}){const d=n,I=f(d.apiType);Q("apiType",I);const h=U("$baseMessage"),S=f(null),l=f(!1),e=f([]),a=f([]),p=f(""),b=f("");function O(){return w(this,null,function*(){l.value=!0;try{const{msg:s,data:g}=yield se({dimensionCode:d.dimensionCode,refId:b.value,combinationRule:e.value,id:p.value});p.value=g,h(s,"success","hey"),l.value=!1}catch(s){l.value=!1}})}function j(){e.value.push([])}function D(s){e.value[s].push({groupType:"andOrGroup",ruleset:[],relation:"and",children:[]})}function J(s){e.value[s].push({groupType:"excludeGroup",ruleset:[],relation:"and",children:[]})}function F(s){e.value.splice(s,1)}function V(s){return w(this,null,function*(){l.value=!0,b.value=s.id,e.value=null,a.value=null;try{const{data:{combinationRule:g=[],id:m=""}}=yield oe({dimensionCode:d.dimensionCode,refId:s.id});let u=g||[];p.value=m||"",e.value=u,a.value=JSON.parse(JSON.stringify(u)),l.value=!1}catch(g){p.value="",e.value=[],a.value=[],l.value=!1}})}function A(){e.value=JSON.parse(JSON.stringify(a.value))}return x({query:V}),(s,g)=>{const m=ee,u=E("el-button"),q=P,L=E("el-empty"),M=E("el-form"),H=W("loading");return i(),r("div",{class:N(["rule-maintenance",{"auto-flex":n.autoFlex}])},[t(M,{ref_key:"formRef",ref:S},{default:_(()=>[o("div",le,[o("span",ie,T(n.title),1)]),o("div",ce,[o("div",ue,[t(m,{icon:"icon-tishi1"}),R(" 规则集之间的只有或者关系 ")]),n.noEdit?C("",!0):(i(),r("div",re,[t(u,{type:"warning",onClick:j,disabled:!c(b)},{default:_(()=>[t(m,{icon:"icon-xinzengdianpingjihua"}),de]),_:1},8,["disabled"])]))]),X((i(),r("div",{class:N({"rule-set":!0,"invisible-scrollbar":!0,"rule-set-disabled-height":n.noEdit})},[(i(!0),r($,null,G(c(e),(z,v)=>(i(),r("div",{class:N(["rule-set-item",c(e)[v].length?"":"rule-set-item-padding-bottom-0"]),key:v},[o("div",pe,[o("div",me,T(`规则集(${v+1})`),1),o("div",fe,[t(u,{plain:"",class:"grey",onClick:y=>D(v)},{default:_(()=>[t(m,{icon:"icon-xinzengdianpingjihua"}),_e]),_:2},1032,["onClick"]),t(u,{plain:"",class:"grey",onClick:y=>J(v)},{default:_(()=>[t(m,{icon:"icon-xinzengdianpingjihua"}),ve]),_:2},1032,["onClick"]),t(u,{plain:"",class:"grey",onClick:y=>F(v)},{default:_(()=>[t(m,{icon:"icon-a-zujian2131"}),ge]),_:2},1032,["onClick"])])]),(i(!0),r($,null,G(z,(y,B)=>(i(),Y(q,{key:B,treeData:y.children,parentItem:z,childrenItem:y,index:B},null,8,["treeData","parentItem","childrenItem","index"]))),128))],2))),128)),c(e)!==null&&!c(e).length?(i(),r("div",ye,[t(L,{class:"wit-data-empty no-tip-text",image:c(Z),description:" ","image-size":198},null,8,["image"])])):C("",!0)],2)),[[H,c(l)]]),n.noEdit?C("",!0):(i(),r("div",he,[c(e)!==null&&c(b)?(i(),r($,{key:0},[t(u,{onClick:A},{default:_(()=>[R("取 消")]),_:1}),t(u,{type:"primary",onClick:O,loading:c(l)},{default:_(()=>[R("保 存")]),_:1},8,["loading"])],64)):C("",!0)]))]),_:1},512)],2)}}}),Be=ae(be,[["__scopeId","data-v-8520b8d0"]]);export{Be as default};
