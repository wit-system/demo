var C=(f,c,v)=>new Promise((w,S)=>{var _=s=>{try{y(v.next(s))}catch(p){S(p)}},r=s=>{try{y(v.throw(s))}catch(p){S(p)}},y=s=>s.done?w(s.value):Promise.resolve(s.value).then(_,r);y((v=v.apply(f,c)).next())});import ge from"./editRepeatedMedicationDiag-w6gCSruF.js";import ve from"./ruleEditing-CAVRqa1f.js";import{d as ye,aj as Ce,P as W,r as m,b as we,a0 as ke,m as d,o as x,c as z,y as o,s as l,n as h,p as t,b9 as Y,B as V,z as D,q as I,a7 as G,aY as be,F as xe,A as Se,C as N,x as L,bL as Ve,H as $e,af as Be,ag as Ne,I as Fe,J as Me,_ as Re}from"./index-1fQ0gozz.js";import{r as ze,g as K,h as De,i as X}from"./indication-BrfvaLV3.js";import"./ruleSetItemContent-DXtfKTJL.js";import"./ruleItem-bRexkwVD.js";import"./judgingConditions-wiurioRr.js";import"./index.vue_vue_type_style_index_0_lang-CmHiYd40.js";import"./ifComponent.vue_vue_type_style_index_0_lang-BOVwK668.js";import"./index-BueAkiiY.js";import"./index.vue_vue_type_script_setup_true_lang-BLW0x7SH.js";import"./dict-Cq6Rfk1f.js";import"./ruleCustomParameters-COBbIW-C.js";const Z=f=>(Fe("data-v-8f5b193f"),f=f(),Me(),f),Ie={class:"flex justify-between align-center"},Le=Z(()=>h("div",{class:"title"},"重复用药",-1)),je={class:"header-action-icon"},Ue={key:0},Oe={class:"flex justify-between align-center",style:{"flex-wrap":"wrap"}},Pe={class:"flex"},qe=Z(()=>h("span",null,"新增重复用药",-1)),Ee=ye({__name:"index",props:{ruleForm:{type:Object,default:()=>{}}},setup(f){const c=Ce(),{refreshCheckStatus:v}=c,w=f,S=W("$baseConfirm"),_=W("$baseMessage"),r=m("repeatedMedication"),y=m(null),s=m(!1),p=m([]),$=m([]),ee=m([{width:"40",type:"checkbox"},{field:"drugsBName",title:"药物名称",minWidth:"140",render:!0},{field:"type",title:"分析类型",width:"100",render:!0},{field:"whetherOverstepSynopsis",title:"超说明书用药",width:"125",filters:[{label:"是",value:"1"},{label:"否",value:"0"}],filterMultiple:!1,render:!0},{field:"severity",title:"问题等级",width:"100",align:"center",filters:c.wordbook.problem_level_rule.map(e=>({label:e.dictLabel,value:e.dictValue})),filterMultiple:!1,render:!0},{field:"active",title:"是否屏蔽",width:"75",align:"center",render:!0},{field:"btns",title:"操作",align:"center",width:"200",fixed:"right",render:!0}]),u=we({query:w.ruleForm.id,keyword:"",pageNum:1,pageSize:10,total:0,whetherOverstepSynopsis:"",severity:""});function k(){return C(this,null,function*(){$.value=[];let{data:e}=yield ze(u);p.value=e.records,u.total=e.total,p.value.length&&(y.value.tableMethods("setCurrentRow",p.value[0]),q({row:p.value[0]}))})}const te=e=>{u.pageNum=1,u.pageSize=e,k()},F=e=>{u.pageNum=e,k()};function j(){$.value=y.value.tableMethods("getCheckboxRecords")}const U=m(null);function M(e,n){U.value.showDiag(e,n)}function O(e){e.id?S("您确定要删除当前项吗",null,()=>C(this,null,function*(){const{msg:n}=yield K([e.id]);_(n,"success","hey"),yield k()})):S("您确定要批量删除选择项吗",null,()=>C(this,null,function*(){const n=$.value.map(b=>b.id),{msg:g}=yield K(n);_(g,"success","hey"),yield k()}))}function ae({property:e,values:n}){u[e]=n[0]||"",F(1)}const R=m(!1);function ne(){return C(this,null,function*(){s.value=!0,R.value=!0;const{msg:e}=yield De();s.value=!1,R.value=!1,_(e,"success","hey")})}function oe(e){return C(this,null,function*(){try{s.value=!0;const n=yield X([e]);s.value=!1,_(n.msg,"success","hey")}catch(n){s.value=!1}})}function le(e){return C(this,null,function*(){try{s.value=!0;const{msg:n}=yield X([e]);s.value=!1,_(n,"success","hey")}catch(n){e.active=e.active==="1"?"0":"1",s.value=!1}})}const P=m();function q({row:e}){P.value.query(e)}function se(){var g;const n={checkStatus:((g=c.ruleCheckStatus.get(r.value))==null?void 0:g.checkStatus)==="1"?"0":"1",dimensionCode:r.value,refId:w.ruleForm.id};Ve(n).then(({msg:b})=>{v(w.ruleForm.id),_(b,"success","hey")}).catch(()=>{v(w.ruleForm.id)})}return ke(()=>{k()}),(e,n)=>{const g=$e,b=d("el-tooltip"),ie=d("el-input"),ce=d("el-checkbox"),B=d("el-button"),re=d("el-option"),ue=d("el-select"),de=d("el-switch"),pe=Be,me=Ne,E=d("el-card"),T=d("el-col"),he=ve,fe=d("el-row"),_e=ge;return x(),z("div",null,[o(fe,{gutter:16},{default:l(()=>[o(T,{span:12},{default:l(()=>[o(E,{class:"no-bottom-card"},{header:l(()=>{var a,i,A,H,J;return[h("div",Ie,[Le,h("div",je,[t(Y)("editor")&&((a=t(c).ruleCheckStatus.get(t(r)))==null?void 0:a.checkStatus)==="1"?(x(),z("span",Ue,V(((i=t(c).ruleCheckStatus.get(t(r)))==null?void 0:i.checkName)||((A=t(c).ruleCheckStatus.get(t(r)))==null?void 0:A.checkBy))+"/"+V((H=t(c).ruleCheckStatus.get(t(r)))==null?void 0:H.checkTime),1)):D("",!0),t(Y)("editor")?(x(),I(b,{key:1,class:"box-item",effect:"dark",content:((J=t(c).ruleCheckStatus.get(t(r)))==null?void 0:J.checkStatus)==="1"?"取消检查":"检查",placement:"top"},{default:l(()=>{var Q;return[o(g,{icon:"icon-jiancha",class:G(["refresh-icon",{active:((Q=t(c).ruleCheckStatus.get(t(r)))==null?void 0:Q.checkStatus)==="1"}]),onClick:se,style:{padding:"4px 5px 3px"}},null,8,["class"])]}),_:1},8,["content"])):D("",!0),o(b,{class:"box-item",effect:"dark",content:"刷新缓存",placement:"top"},{default:l(()=>[o(g,{icon:"icon-gengxin",class:G({"refresh-icon":!0,"loading-animation":t(R)}),onClick:ne,style:{padding:"4px"}},null,8,["class"])]),_:1})])])]}),default:l(()=>[h("div",Oe,[o(ie,{modelValue:t(u).keyword,"onUpdate:modelValue":n[0]||(n[0]=a=>t(u).keyword=a),clearable:"",placeholder:"请输入重复用药关键字","suffix-icon":t(be),style:{width:"300px"},onInput:n[1]||(n[1]=a=>F(1))},null,8,["modelValue","suffix-icon"]),h("div",Pe,[t($).length?(x(),I(ce,{key:0,"model-value":!0,label:"批量删除",border:"",style:{"margin-right":"12px"},onClick:O})):D("",!0),o(B,{plain:"",type:"warning",onClick:n[2]||(n[2]=a=>M("","add"))},{default:l(()=>[o(g,{icon:"icon-xinzengdianpingjihua"}),qe]),_:1})])]),o(pe,{ref_key:"tableRef",ref:y,"table-name":"rule-contraindication-table",loading:t(s),tableData:t(p),columns:t(ee),isShowTableSet:!1,onCheckboxChange:j,onCheckboxAll:j,onFilterChange:ae,onCellClick:q},{drugsBName:l(a=>[h("span",null,V(a.row.drugsBName+"/"+a.row.drugsAName),1)]),type:l(a=>[h("span",null,V(a.row.type==="1"?"同成份":"同药理作用"),1)]),whetherOverstepSynopsis:l(a=>[h("div",null,V(a.row.whetherOverstepSynopsis=="1"?"是":"否"),1)]),severity:l(a=>[o(ue,{modelValue:a.row.severity,"onUpdate:modelValue":i=>a.row.severity=i,placeholder:"请选择",onChange:i=>oe(a.row)},{default:l(()=>[(x(!0),z(xe,null,Se(t(c).wordbook.problem_level_rule,i=>(x(),I(re,{key:i.dictLabel,label:i.dictLabel,value:i.dictValue},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),active:l(a=>[o(de,{modelValue:a.row.active,"onUpdate:modelValue":i=>a.row.active=i,loading:t(s),onClick:n[3]||(n[3]=N(()=>{},["stop"])),onChange:i=>le(a.row),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),btns:l(a=>[o(B,{text:"",type:"primary",onClick:N(i=>M(a.row,"check"),["stop"])},{default:l(()=>[L("查看")]),_:2},1032,["onClick"]),o(B,{text:"",type:"primary",onClick:N(i=>M(a.row,"edit"),["stop"])},{default:l(()=>[L("编辑")]),_:2},1032,["onClick"]),o(B,{text:"",type:"primary",onClick:N(i=>O(a.row),["stop"])},{default:l(()=>[L("删除")]),_:2},1032,["onClick"])]),_:1},8,["loading","tableData","columns"]),o(me,{"current-page":t(u).pageNum,"page-size":t(u).pageSize,total:t(u).total,"prev-text":"上一页","next-text":"下一页",onCurrentChange:F,onSizeChange:te},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),o(T,{span:12},{default:l(()=>[o(E,{class:"no-bottom-card"},{default:l(()=>[o(he,{dimensionCode:t(r),ref_key:"ruleEditingBox",ref:P},null,8,["dimensionCode"])]),_:1})]),_:1})]),_:1}),o(_e,{ref_key:"editRepeatedMedicationDiagRef",ref:U,onQuery:k,ruleForm:f.ruleForm},null,8,["ruleForm"])])}}}),nt=Re(Ee,[["__scopeId","data-v-8f5b193f"]]);export{nt as default};
