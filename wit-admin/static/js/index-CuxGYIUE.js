var k=(g,v,w)=>new Promise((u,V)=>{var E=h=>{try{b(w.next(h))}catch(c){V(c)}},_=h=>{try{b(w.throw(h))}catch(c){V(c)}},b=h=>h.done?u(h.value):Promise.resolve(h.value).then(E,_);b((w=w.apply(g,v)).next())});import Fe from"./editIndicationDiag-DZzGVBUf.js";import Te from"./ruleEditing-CEKDWD36.js";import{d as Be,r,P as Ne,aj as ze,b9 as B,b as te,a0 as Ee,bs as ne,m as d,o as I,c as j,n as l,a7 as N,p as t,y as o,s,B as z,z as O,q as U,aY as Me,F as $e,A as Pe,C as ae,x as oe,t as le,v as se,aa as Re,ae as D,bL as We,H as je,af as Oe,ag as Ue,I as De,J as qe,_ as Ae}from"./index-BNylXLUF.js";import{s as Qe,q as He,Q as Je,t as Ye,u as Ge,v as Ke}from"./indication-NBH1_vCV.js";import"./ruleSetItemContent-BH3GSuI_.js";import"./ruleItem-Bjcpc8f8.js";import"./judgingConditions-B6eb1oAJ.js";import"./index.vue_vue_type_style_index_0_lang-CQ0LplO3.js";import"./ifComponent.vue_vue_type_style_index_0_lang-CZbArpmd.js";import"./index-7iMDeE21.js";import"./index.vue_vue_type_script_setup_true_lang-DuUJu87k.js";import"./dict-C-0c6999.js";import"./ruleCustomParameters-iIrn7otW.js";const x=g=>(De("data-v-f2438c40"),g=g(),qe(),g),Xe={class:"flex justify-between"},Ze={class:"flex justify-between align-center"},et=x(()=>l("div",{class:"title"},"适应证",-1)),tt={class:"header-action-icon"},nt={key:0},at={class:"flex justify-between align-center",style:{"flex-wrap":"wrap"}},ot={class:"flex"},lt=x(()=>l("div",{class:"select-label"},"无适应证问题级别",-1)),st={class:"flex"},it=x(()=>l("span",null,"新增适应证",-1)),ct={class:"flex justify-between align-center"},rt=x(()=>l("div",{class:"title"},"关键字",-1)),dt={class:"tip-text flex justify-between align-center"},ut=x(()=>l("div",null,"输入关键字自动实时保存",-1)),pt=x(()=>l("div",{class:"top"},null,-1)),ft={class:"center"},ht=x(()=>l("div",{class:"bottom"},null,-1)),mt=Be({__name:"index",props:{ruleForm:{type:Object,default:()=>{}}},setup(g){const v=g,w=r(null),u=r("icd10_adaptation"),V=r(""),E=r(""),_=Ne("$baseMessage"),b=r(null),h=r(null),c=r(!1),M=r(!1),y=r([]),L=r([]),p=ze(),{refreshCheckStatus:q}=p;r({});const S=r(!0),ie=r([{width:"40",type:"checkbox"},{field:"updateName",title:"编辑人",width:"80",show:B("editor")},{field:"updateTime",title:"编辑时间",width:"165",show:B("editor")},{field:"icdCode",title:"编码",minWidth:"140"},{field:"icdName",title:"名称",minWidth:"140"},{field:"icdType",title:"诊断类型",width:"120",filters:p.wordbook.diagnostic_type.map(e=>({label:e.dictLabel,value:e.dictValue})),filterMultiple:!1,render:!0},{field:"active",title:"是否屏蔽",width:"75",render:!0},{field:"whetherOverstepSynopsis",title:"超说明书用药",width:"125",filters:[{label:"是",value:"1"},{label:"否",value:"0"}],filterMultiple:!1,render:!0},{field:"btns",title:"操作",align:"center",width:"130",fixed:"right",render:!0}]),i=te({keyword:"",pageNum:1,pageSize:100,total:0,bs:"1",generalId:"",icdType:"",active:"",whetherOverstepSynopsis:""}),f=te({id:"",generalId:"",noIcd10ProblemLevel:"",keyWord:"",bs:"1"});Ee(()=>{i.generalId=v.ruleForm.id,F(),re()});function ce(){S.value=!S.value}function re(){return k(this,null,function*(){let e=yield Qe({generalId:i.generalId,bs:"1"});if(e.resultCode!=1){f.noIcd10ProblemLevel="",f.keyWord="";return}e.data&&Object.assign(f,e.data)})}function F(){return k(this,null,function*(){L.value=[];let e=yield He(i);if(e.resultCode!=1){y.value=[],i.total=e.data.total;return}y.value=e.data.records||[],i.total=e.data.total,y.value.length&&(y.value.forEach(n=>{n.isChk=!1}),b.value.tableMethods("setCurrentRow",y.value[0]),Y({row:y.value[0]}))})}const de=e=>{i.pageNum=1,i.pageSize=e,F()},$=ne(e=>{i.pageNum=e,F()},300);function A(e){L.value=b.value.tableMethods("getCheckboxRecords")}function Q(e,n){h.value.showDiag(e,n,v.ruleForm.id)}function ue(){if(!L.value.length){_("请先勾选表格","info");return}H({id:L.value.map(e=>e.id)})}function H(e){Re.confirm("是否确认删除","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>k(this,null,function*(){c.value=!0;const{msg:n}=yield Ye({bs:1,generalId:i.generalId,ids:e.id});c.value=!1,_(n,"success","hey"),F()})).catch(()=>{D({type:"info",message:"取消删除"})})}function pe({property:e,values:n}){i[e]=n[0]||"",$(1)}const J=ne(()=>k(this,null,function*(){f.generalId=i.generalId;let e=yield Je(f);e.resultCode==1&&(f.id||(f.id=e.data))}),600);function fe(e){let n="";return p.wordbook.diagnostic_type.forEach(m=>{m.dictValue==e&&(n=m.dictLabel)}),n}function he(){return k(this,null,function*(){c.value=!0,M.value=!0;let e=yield Ge({bs:1});if(c.value=!1,M.value=!1,e.resultCode!="1"){D({type:"info",message:"刷新失败"});return}D({type:"success",message:"刷新成功"})})}function me(e){return k(this,null,function*(){c.value=!0;try{let n=yield Ke(e);if(c.value=!1,n.resultCode!=1){e.active=e.active==="1"?"0":"1",_("规则修改失败","info","hey");return}_("规则修改成功","success","hey")}catch(n){_("规则修改失败","info","hey"),e.active=e.active==="1"?"0":"1",c.value=!1}return!1})}function Y({row:e}){V.value=e.id,w.value.query(e)}function _e(){var m;const n={checkStatus:((m=p.ruleCheckStatus.get(u.value))==null?void 0:m.checkStatus)==="1"?"0":"1",dimensionCode:u.value,refId:v.ruleForm.id};We(n).then(({msg:T})=>{q(v.ruleForm.id),_(T,"success","hey")}).catch(()=>{q(v.ruleForm.id)})}function ge({row:e,rowIndex:n}){return e.whetherOverstepSynopsis=="1"?"warning-row":""}return(e,n)=>{const m=je,T=d("el-tooltip"),G=d("el-input"),ve=d("el-option"),we=d("el-select"),be=d("el-checkbox"),P=d("el-button"),ye=d("el-switch"),Ce=Oe,ke=Ue,R=d("el-card"),xe=d("Warning"),W=d("el-icon"),Se=d("arrow-left-bold"),Ie=d("arrow-right-bold"),Ve=Te,Le=Fe;return I(),j("div",null,[l("div",Xe,[l("div",{class:N(["left-container",t(S)?"left-container-all":"left-container-half"])},[o(R,null,{header:s(()=>{var a,C,K,X,Z;return[l("div",Ze,[et,l("div",tt,[t(B)("editor")&&((a=t(p).ruleCheckStatus.get(t(u)))==null?void 0:a.checkStatus)==="1"?(I(),j("span",nt,z(((C=t(p).ruleCheckStatus.get(t(u)))==null?void 0:C.checkName)||((K=t(p).ruleCheckStatus.get(t(u)))==null?void 0:K.checkBy))+"/"+z((X=t(p).ruleCheckStatus.get(t(u)))==null?void 0:X.checkTime),1)):O("",!0),t(B)("editor")?(I(),U(T,{key:1,class:"box-item",effect:"dark",content:((Z=t(p).ruleCheckStatus.get(t(u)))==null?void 0:Z.checkStatus)==="1"?"取消检查":"检查",placement:"top"},{default:s(()=>{var ee;return[o(m,{icon:"icon-jiancha",class:N(["refresh-icon",{active:((ee=t(p).ruleCheckStatus.get(t(u)))==null?void 0:ee.checkStatus)==="1"}]),onClick:_e,style:{padding:"4px 5px 3px"}},null,8,["class"])]}),_:1},8,["content"])):O("",!0),o(T,{class:"box-item",effect:"dark",content:"刷新缓存",placement:"top"},{default:s(()=>[o(m,{icon:"icon-gengxin",class:N({"refresh-icon":!0,"loading-animation":t(M)}),onClick:he,style:{padding:"4px"}},null,8,["class"])]),_:1})])])]}),default:s(()=>[l("div",at,[l("div",ot,[o(G,{modelValue:t(i).keyword,"onUpdate:modelValue":n[0]||(n[0]=a=>t(i).keyword=a),placeholder:"请输入适应证关键字","suffix-icon":t(Me),style:{width:"300px"},clearable:"",onInput:n[1]||(n[1]=a=>t($)(1))},null,8,["modelValue","suffix-icon"]),lt,o(we,{style:{width:"128px"},modelValue:t(f).noIcd10ProblemLevel,"onUpdate:modelValue":n[2]||(n[2]=a=>t(f).noIcd10ProblemLevel=a),onChange:t(J)},{default:s(()=>[(I(!0),j($e,null,Pe(t(p).wordbook.problem_level_rule,a=>(I(),U(ve,{key:a.dictLabel,label:a.dictLabel,value:a.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),l("div",st,[t(L).length?(I(),U(be,{key:0,"model-value":!0,label:"批量删除",border:"",style:{"margin-right":"12px"},onClick:ue})):O("",!0),o(P,{plain:"",type:"warning",onClick:n[3]||(n[3]=a=>Q("","add"))},{default:s(()=>[o(m,{icon:"icon-xinzengdianpingjihua"}),it]),_:1})])]),o(Ce,{ref_key:"tableRef",ref:b,"table-name":"rule-indication-table",loading:t(c),"table-data":t(y),columns:t(ie),isShowTableSet:!1,onCheckboxChange:A,onCheckboxAll:A,onFilterChange:pe,"row-class-name":ge,onCellClick:n[4]||(n[4]=a=>{Y({row:a.row})})},{icdType:s(a=>[l("span",null,z(fe(a.row.icdType)),1)]),active:s(a=>[o(ye,{modelValue:a.row.active,"onUpdate:modelValue":C=>a.row.active=C,loading:t(c),onChange:C=>me(a.row),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),whetherOverstepSynopsis:s(a=>[l("div",null,z(a.row.whetherOverstepSynopsis=="1"?"是":"否"),1)]),btns:s(a=>[o(P,{text:"",type:"primary",onClick:ae(C=>Q(a.row,"edit"),["stop"])},{default:s(()=>[oe("编辑")]),_:2},1032,["onClick"]),o(P,{text:"",type:"primary",onClick:ae(C=>H({id:[a.row.id]}),["stop"])},{default:s(()=>[oe("删除")]),_:2},1032,["onClick"])]),_:1},8,["loading","table-data","columns"]),o(ke,{"current-page":t(i).pageNum,"page-size":t(i).pageSize,total:t(i).total,"prev-text":"上一页","next-text":"下一页",onCurrentChange:t($),onSizeChange:de},null,8,["current-page","page-size","total","onCurrentChange"])]),_:1}),o(R,{class:"no-bottom-card"},{header:s(()=>[l("div",ct,[rt,l("div",dt,[o(W,{color:"#FC9F15",size:"18px"},{default:s(()=>[o(xe)]),_:1}),ut])])]),default:s(()=>[o(G,{modelValue:t(f).keyWord,"onUpdate:modelValue":n[5]||(n[5]=a=>t(f).keyWord=a),maxlength:"1000",placeholder:"请输入","show-word-limit":"",type:"textarea",rows:4,onInput:t(J)},null,8,["modelValue","onInput"])]),_:1})],2),l("div",{class:N(["right-container",t(S)?"right-container-half":"right-container-all"])},[l("div",{class:"toggle-btn",onClick:ce},[pt,l("div",ft,[le(o(W,null,{default:s(()=>[o(Se)]),_:1},512),[[se,t(S)]]),le(o(W,null,{default:s(()=>[o(Ie)]),_:1},512),[[se,!t(S)]])]),ht]),o(R,{class:"no-bottom-card"},{default:s(()=>[o(Ve,{dimensionCode:t(u),refId:t(V),id:t(E),ref_key:"ruleEditingBox",ref:w},null,8,["dimensionCode","refId","id"])]),_:1})],2)]),o(Le,{ref_key:"editIndication",ref:h,onQuery:F},null,512)])}}}),Tt=Ae(mt,[["__scopeId","data-v-f2438c40"]]);export{Tt as default};
