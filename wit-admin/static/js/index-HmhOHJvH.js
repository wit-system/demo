var v=(T,b,r)=>new Promise((h,g)=>{var p=l=>{try{n(r.next(l))}catch(u){g(u)}},y=l=>{try{n(r.throw(l))}catch(u){g(u)}},n=l=>l.done?h(l.value):Promise.resolve(l.value).then(p,y);n((r=r.apply(T,b)).next())});import{d as J,P as $,r as m,b as P,h as A,m as f,T as U,o as z,c as G,y as e,p as s,a6 as H,n as k,t as K,q as Q,s as o,x as _,B as w,ag as W}from"./index-C3-31E46.js";import X from"./noticeEdit-CdleE9FC.js";import{_ as Y}from"./index.vue_vue_type_style_index_0_lang-Rf1iYlx6.js";import{d as Z,b as ee}from"./notice-BIK-jFa_.js";import{g as D}from"./dict-Bt1K3r7e.js";import"./index-nc088U4r.js";import"./style-Cm3xdryd.js";import"./fileUpload-Lxedd9Va.js";import"./ifComponent.vue_vue_type_style_index_0_lang-h1Ozx49r.js";import"./index-B93FDT35.js";import"./index.vue_vue_type_script_setup_true_lang-DLP8ok9d.js";const te={class:"user-management-container auto-height-container"},ae={class:"app-content padding-out"},ne={style:{"text-align":"left"}},oe={class:"app-pagination"},fe=J({name:"notice",__name:"index",setup(T){const b=$("$baseConfirm"),r=$("$baseMessage"),h=m(null),g=m([]),p=m(!0),y=m(0),n=m({pageNum:1,pageSize:10,noticeTitle:"",noticeType:""}),l=P({searchList:[{type:"input",field:"noticeTitle",label:"公告标题",isOutBorder:!0,attrs:{width:220,placeholder:"请输入公告标题",clearable:!0},events:{}},{type:"select",field:"noticeType",label:"公告类型",isOutBorder:!0,valueField:"institutionCode",labelField:"institutionName",options:[{institutionCode:"0",institutionName:"全部"},{institutionCode:"1",institutionName:"通知"},{institutionCode:"2",institutionName:"公告"}],attrs:{width:180,clearable:!0},events:{}}],searchListButtons:[{label:"搜 索",isShowLoading:!0,attrs:{type:"primary"},events:{click:L}},{label:"新建",icon:"icon-xinzengdianpingjihua",attrs:{type:"warning"},events:{click:F}}]}),u=m();function L(){u.value.search()}const V=(t={})=>{if(t.status==0){r("已启用的公告/通知无法删除！","error","hey");return}let i=[];i.push(t.noticeId),t.noticeId&&b("您确定要删除吗",null,()=>v(this,null,function*(){const{msg:C}=yield Z(i);r(C,"success","hey"),yield d()}))};function F(){h.value.showEdit("")}const S=(...C)=>v(this,[...C],function*(t={},i){h.value.showEdit(t,i)}),d=()=>v(this,null,function*(){p.value=!0;const t=JSON.parse(JSON.stringify(n.value));t.noticeType=t.noticeType==0?"":t.noticeType;const{data:i}=yield ee(t);g.value=i.records,y.value=i.total,p.value=!1});A(()=>{d()});const I=t=>{n.value.pageNum=1,n.value.pageSize=t,d()},O=t=>{n.value.pageNum=t,d()};return(t,i)=>{const C=Y,c=f("el-table-column"),x=f("el-tag"),N=f("el-button"),E=f("el-empty"),M=f("el-table"),R=X,j=W,q=U("loading");return z(),G("div",te,[e(C,{ref_key:"refSearch",ref:u,modelValue:s(n),"onUpdate:modelValue":i[0]||(i[0]=a=>H(n)?n.value=a:null),"search-data":s(l),"search-name":"system-config",searching:s(p),onSearch:d},null,8,["modelValue","search-data","searching"]),k("div",ae,[K((z(),Q(M,{data:s(g),border:""},{empty:o(()=>[e(E,{class:"wit-data-empty",description:"暂无数据"})]),default:o(()=>[e(c,{align:"center",label:"序号",width:"55"},{default:o(({$index:a})=>[_(w(a+1),1)]),_:1}),e(c,{align:"center",label:"公告标题","min-width":"180",prop:"noticeTitle","show-overflow-tooltip":""},{default:o(({row:a})=>[k("div",ne,w(a.noticeTitle),1)]),_:1}),e(c,{align:"center",label:"公告类型","min-width":"160",prop:"noticeType","show-overflow-tooltip":""},{default:o(a=>[e(x,{class:"ml-2"},{default:o(()=>[_(w(s(D)("sys_notice_type",a.row.noticeType)),1)]),_:2},1024)]),_:1}),e(c,{align:"center",label:"备注","min-width":"120",prop:"remark","show-overflow-tooltip":""}),e(c,{align:"center",label:"创建人","min-width":"120",prop:"createBy","show-overflow-tooltip":""}),e(c,{align:"center",label:"创建时间","min-width":"120",prop:"createTime","show-overflow-tooltip":""}),e(c,{align:"center",label:"状态","min-width":"80",prop:"status","show-overflow-tooltip":""},{default:o(a=>[e(x,{type:a.row.status==="0"?"success":"danger",class:"ml-2"},{default:o(()=>[_(w(s(D)("sys_notice_status",a.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(c,{align:"center",label:"操作",width:"240"},{default:o(({row:a})=>[e(N,{text:"",type:"primary",onClick:B=>S(a,"preview")},{default:o(()=>[_("预览")]),_:2},1032,["onClick"]),e(N,{text:"",type:"primary",onClick:B=>S(a,"edit")},{default:o(()=>[_("编辑")]),_:2},1032,["onClick"]),e(N,{text:"",type:"danger",onClick:B=>V(a)},{default:o(()=>[_("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[q,s(p)]])]),e(R,{ref_key:"noticeRef",ref:h,onFetchData:d},null,512),k("div",oe,[e(j,{"current-page":s(n).pageNum,"page-size":s(n).pageSize,total:s(y),onCurrentChange:O,onSizeChange:I},null,8,["current-page","page-size","total"])])])}}});export{fe as default};
