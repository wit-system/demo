var g=(h,y,i)=>new Promise((V,w)=>{var m=d=>{try{a(i.next(d))}catch(u){w(u)}},C=d=>{try{a(i.throw(d))}catch(u){w(u)}},a=d=>d.done?V(d.value):Promise.resolve(d.value).then(m,C);a((i=i.apply(h,y)).next())});import{_ as te}from"./ruleDecoctingMethodDiag.vue_vue_type_script_setup_true_lang-CPZ0xNTX.js";import{d as ae,P as ne,aj as oe,r as f,b as le,a0 as ie,bs as se,m as p,o as D,c as B,y as o,s as r,n as v,a7 as ce,p as l,aY as re,q as R,z as de,F as ue,A as fe,C as S,x as $,aa as pe,H as he,af as ge,ag as me,I as _e,J as ve,_ as we}from"./index-CmC8Jr0A.js";import{y as ye,z as Ce,A as be,B as F,C as xe}from"./indication-Cjl8NcsF.js";const j=h=>(_e("data-v-9cbd6418"),h=h(),ve(),h),ke={class:"flex justify-between align-center"},De=j(()=>v("div",{class:"title"},"中药煎煮方法",-1)),Ve={class:"header-action-icon"},Me={class:"flex justify-between align-center",style:{"flex-wrap":"wrap"}},Ie={class:"flex"},Se=j(()=>v("span",null,"新增中药煎煮方法",-1)),$e=ae({__name:"index",props:{ruleForm:{type:Object,default:()=>{}}},setup(h){const y=h,i=ne("$baseMessage"),V=oe(),w=f(null),m=f(!1),C=f(null),a=f(!1),d=f([]),u=f([]),q=f([{width:"40",type:"checkbox"},{field:"routeCode",title:"代码",width:"150"},{field:"routeName",title:"煎煮方法",width:"150"},{field:"questionLevel",title:"问题级别",width:"150",render:!0},{field:"active",title:"是否屏蔽",width:"100",render:!0},{field:"reference",title:"参考文献",minWidth:"120"},{field:"tipContent",title:"提示内容",minWidth:"120"},{field:"btns",title:"操作",align:"center",width:"200",fixed:"right",render:!0}]),s=le({keyword:"",pageNum:1,pageSize:10,total:0,generalId:""}),z=f([]);ie(()=>{s.generalId=y.ruleForm.id,U(),b()});function U(){return g(this,null,function*(){const{data:e}=yield ye();z.value=(e||[]).map(t=>({routeName:t.name,routeCode:t.code}))})}function b(){return g(this,null,function*(){u.value=[];const{data:e}=yield Ce(s);d.value=e.records||[],s.total=e.total||0})}const T=e=>{s.pageNum=1,s.pageSize=e,b()},M=se(e=>{s.pageNum=e,b()},300);function L(e){u.value=w.value.tableMethods("getCheckboxRecords")}function I(e,t){C.value.showDiag(e,t,y.ruleForm.id,z.value)}function A(){if(!u.value.length){i("请先勾选表格","info");return}N({id:u.value.map(e=>e.id)})}function N(e){pe.confirm("是否确认删除","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>g(this,null,function*(){a.value=!0;const{msg:t}=yield be({generalId:s.generalId,ids:e.id});a.value=!1,i(t,"success","hey"),b()})).catch(()=>{i("取消删除","info","hey")})}function P(e){return g(this,null,function*(){a.value=!0;try{const{msg:t}=yield F(e);a.value=!1,i(t,"success","hey")}catch(t){i("规则修改失败","info","hey"),e.active=e.active==="1"?"0":"1",a.value=!1}return!1})}function E(e,t){return g(this,null,function*(){a.value=!0;try{let _=Object.assign({},t,{});const{msg:x}=yield F(_);a.value=!1,i(x,"success","hey")}catch(_){a.value=!1}})}function O(){return g(this,null,function*(){a.value=!0,m.value=!0;try{const{msg:e}=yield xe({generalId:s.generalId});a.value=!1,m.value=!1,i(e,"success","hey")}catch(e){a.value=!1,m.value=!1}})}function W(){i("暂未添加接口","warning","hey")}return(e,t)=>{const _=he,x=p("el-tooltip"),G=p("el-input"),H=p("el-checkbox"),k=p("el-button"),J=p("el-option"),Y=p("el-select"),K=p("el-switch"),Q=ge,X=me,Z=p("el-card"),ee=te;return D(),B("div",null,[o(Z,{class:"no-bottom-card"},{header:r(()=>[v("div",ke,[De,v("div",Ve,[o(x,{class:"box-item",effect:"dark",content:"检查",placement:"top"},{default:r(()=>[o(_,{icon:"icon-jiancha",class:"refresh-icon",onClick:W,style:{padding:"4px 5px 3px"}})]),_:1}),o(x,{class:"box-item",effect:"dark",content:"刷新缓存",placement:"top"},{default:r(()=>[o(_,{icon:"icon-gengxin",class:ce({"refresh-icon":!0,"loading-animation":l(m)}),onClick:O,style:{padding:"4px"}},null,8,["class"])]),_:1})])])]),default:r(()=>[v("div",Me,[o(G,{modelValue:l(s).keyword,"onUpdate:modelValue":t[0]||(t[0]=n=>l(s).keyword=n),placeholder:"请输入关键字","suffix-icon":l(re),style:{width:"300px"},clearable:"",onInput:t[1]||(t[1]=n=>l(M)(1))},null,8,["modelValue","suffix-icon"]),v("div",Ie,[l(u).length?(D(),R(H,{key:0,"model-value":!0,label:"批量删除",border:"",style:{"margin-right":"12px"},onClick:A})):de("",!0),o(k,{plain:"",type:"warning",onClick:t[2]||(t[2]=n=>I("","add"))},{default:r(()=>[o(_,{icon:"icon-xinzengdianpingjihua"}),Se]),_:1})])]),o(Q,{ref_key:"tableRef",ref:w,"table-name":"rule-decoctingMethod-table",loading:l(a),"table-data":l(d),columns:l(q),isShowTableSet:!1,onCheckboxChange:L,onCheckboxAll:L},{questionLevel:r(n=>[o(Y,{modelValue:n.row.questionLevel,"onUpdate:modelValue":c=>n.row.questionLevel=c,size:"large",placeholder:"请选择",onChange:c=>E(c,n.row)},{default:r(()=>[(D(!0),B(ue,null,fe(l(V).wordbook.problem_level_rule,c=>(D(),R(J,{key:c.dictValue,label:c.dictLabel,value:c.dictValue},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),active:r(n=>[o(K,{modelValue:n.row.active,"onUpdate:modelValue":c=>n.row.active=c,loading:l(a),onChange:c=>P(n.row),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),btns:r(n=>[o(k,{text:"",type:"primary",onClick:S(c=>I(n.row,"view"),["stop"])},{default:r(()=>[$("查看")]),_:2},1032,["onClick"]),o(k,{text:"",type:"primary",onClick:S(c=>I(n.row,"edit"),["stop"])},{default:r(()=>[$("编辑")]),_:2},1032,["onClick"]),o(k,{text:"",type:"primary",onClick:S(c=>N({id:[n.row.id]}),["stop"])},{default:r(()=>[$("删除")]),_:2},1032,["onClick"])]),_:1},8,["loading","table-data","columns"]),o(X,{"current-page":l(s).pageNum,"page-size":l(s).pageSize,total:l(s).total,"prev-text":"上一页","next-text":"下一页",onCurrentChange:l(M),onSizeChange:T},null,8,["current-page","page-size","total","onCurrentChange"])]),_:1}),o(ee,{ref_key:"ruleDecoctingMethodDiagRef",ref:C,onFetchData:t[3]||(t[3]=n=>l(M)(1))},null,512)])}}}),Re=we($e,[["__scopeId","data-v-9cbd6418"]]);export{Re as default};
