var L=(b,y,r)=>new Promise((R,p)=>{var T=u=>{try{C(r.next(u))}catch(_){p(_)}},c=u=>{try{C(r.throw(u))}catch(_){p(_)}},C=u=>u.done?R(u.value):Promise.resolve(u.value).then(T,c);C((r=r.apply(b,y)).next())});import be from"./editSpecialPopulationsDiag-BZOGmyzT.js";import ye from"./ruleEditing-CEKDWD36.js";import{d as ke,aj as xe,P as Se,r as f,b9 as z,b as Ve,a0 as Me,bs as Le,m as h,o as m,c as k,n as s,a7 as B,p as t,y as l,s as o,B as w,z as x,q as D,aY as Ne,F as Re,A as Te,C as E,x as O,t as K,v as X,aa as Ie,ae as ze,bL as Be,H as $e,af as Fe,ag as Ae,I as Ue,J as De,_ as Ee}from"./index-BNylXLUF.js";import{a0 as Oe,a1 as Pe,a2 as je,a3 as Z}from"./indication-NBH1_vCV.js";import"./ageSetting-DT66XvN6.js";import"./ruleSetItemContent-BH3GSuI_.js";import"./ruleItem-Bjcpc8f8.js";import"./judgingConditions-B6eb1oAJ.js";import"./index.vue_vue_type_style_index_0_lang-CQ0LplO3.js";import"./ifComponent.vue_vue_type_style_index_0_lang-CZbArpmd.js";import"./index-7iMDeE21.js";import"./index.vue_vue_type_script_setup_true_lang-DuUJu87k.js";import"./dict-C-0c6999.js";import"./ruleCustomParameters-iIrn7otW.js";const N=b=>(Ue("data-v-605b13f1"),b=b(),De(),b),qe={class:"flex justify-between"},We={class:"flex justify-between align-center"},He=N(()=>s("div",{class:"title"},"特殊人群",-1)),Je={class:"header-action-icon"},Qe={key:0},Ye={class:"flex justify-between align-center",style:{"flex-wrap":"wrap"}},Ge={class:"flex"},Ke=N(()=>s("span",null,"新增特殊人群",-1)),Xe={key:0},Ze={key:1},et={key:0},tt=N(()=>s("span",null,"~",-1)),at={key:1},nt=N(()=>s("div",{class:"top"},null,-1)),lt={class:"center"},ot=N(()=>s("div",{class:"bottom"},null,-1)),st=ke({__name:"index",props:{ruleForm:{type:Object,default:()=>{}}},setup(b){const y=b,r=xe(),{refreshCheckStatus:R}=r,p=Se("$baseMessage"),T=f(null),c=f(!1),C=f(!1),u=f([]),_=f([]),$=f(null),F=f(null),g=f("age_result"),S=f(!0),ee=f([{width:"40",type:"checkbox"},{field:"updateName",title:"编辑人",width:"80",show:z("editor")},{field:"updateTime",title:"编辑时间",width:"165",show:z("editor")},{field:"patientName",title:"患者类型",width:"110",render:!0},{field:"tipContent",title:"提示内容",minWidth:"140"},{field:"reference",title:"参考文献",minWidth:"140"},{field:"warnSign",title:"禁慎用标识",width:"107",render:!0},{field:"problemLevelCode",title:"问题等级",width:"120",filters:r.wordbook.problem_level_rule.map(e=>({label:e.dictLabel,value:e.dictValue})),filterMultiple:!1,render:!0},{field:"whetherOverstepSynopsis",title:"超说明书用药",width:"125",filters:[{label:"是",value:"1"},{label:"否",value:"0"}],filterMultiple:!1,render:!0},{field:"active",title:"是否屏蔽",width:"75",render:!0},{field:"btns",title:"操作",align:"center",width:"190",fixed:"right",render:!0}]),d=Ve({keyword:"",pageNum:1,pageSize:10,total:0,patientType:"",problemLevelCode:"",generalId:"",active:"",whetherOverstepSynopsis:"",libType:"1"});Me(()=>{d.generalId=y.ruleForm.id,M()});function te(){S.value=!S.value}function M(){return L(this,null,function*(){_.value=[];let e=yield Oe(d);if(e.resultCode!=1){u.value=[],d.total=e.data.total;return}u.value=e.data.records||[],d.total=e.data.total,u.value.length&&(u.value.forEach(n=>{n.isChk=!1}),$.value.tableMethods("setCurrentRow",u.value[0]),q({row:u.value[0]}))})}const ae=e=>{d.pageNum=1,d.pageSize=e,M()},A=Le(e=>{d.pageNum=e,M()},300);function P(e){_.value=$.value.tableMethods("getCheckboxRecords")}function U(e,n){T.value.showDiag(e,n,y.ruleForm.id)}function ne(){if(!_.value.length){p("请先勾选表格","info");return}j({id:_.value.map(e=>e.id)})}function j(e){Ie.confirm("是否确认删除规则","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>L(this,null,function*(){c.value=!0;const{msg:n}=yield Pe(e.id);c.value=!1,p(n,"success","hey"),M()})).catch(()=>{ze({type:"info",message:"取消删除"})})}function le({property:e,values:n}){d[e]=n[0]||"",A(1)}function oe(){c.value=!0,C.value=!0;try{je().then(e=>{if(C.value=!1,c.value=!1,e.resultCode!="1"){p("刷新缓存失败","info","hey");return}p("刷新缓存成功","success","hey")})}catch(e){C.value=!1,c.value=!1}}function se(e){return L(this,null,function*(){e.libType="1",c.value=!0;try{let n=yield Z(e);if(c.value=!1,n.resultCode!=1){e.active=e.active==="1"?"0":"1",p("规则修改失败","info","hey");return}p("规则修改成功","success","hey")}catch(n){p("规则修改失败","info","hey"),e.active=e.active==="1"?"0":"1",c.value=!1}return!1})}function q({row:e}){F.value&&F.value.query(e)}function ie(){var v;const n={checkStatus:((v=r.ruleCheckStatus.get(g.value))==null?void 0:v.checkStatus)==="1"?"0":"1",dimensionCode:g.value,refId:y.ruleForm.id};Be(n).then(({msg:V})=>{R(y.ruleForm.id),p(V,"success","hey")}).catch(()=>{R(y.ruleForm.id)})}function re(e,n){return L(this,null,function*(){c.value=!0;try{let v=Object.assign({},n);const V=yield Z(v);c.value=!1,p(V.msg,"success","hey")}catch(v){c.value=!1}})}function ce({row:e,rowIndex:n}){return e.whetherOverstepSynopsis=="1"?"warning-row":""}return(e,n)=>{const v=$e,V=h("el-tooltip"),ue=h("el-input"),de=h("el-checkbox"),I=h("el-button"),pe=h("el-option"),he=h("el-select"),fe=h("el-switch"),me=Fe,_e=Ae,W=h("el-card"),ge=h("arrow-left-bold"),H=h("el-icon"),ve=h("arrow-right-bold"),we=ye,Ce=be;return m(),k("div",null,[s("div",qe,[s("div",{class:B(["left-container",t(S)?"left-container-all":"left-container-half"])},[l(W,{class:"no-bottom-card"},{header:o(()=>{var a,i,J,Q,Y;return[s("div",We,[He,s("div",Je,[t(z)("editor")&&((a=t(r).ruleCheckStatus.get(t(g)))==null?void 0:a.checkStatus)==="1"?(m(),k("span",Qe,w(((i=t(r).ruleCheckStatus.get(t(g)))==null?void 0:i.checkName)||((J=t(r).ruleCheckStatus.get(t(g)))==null?void 0:J.checkBy))+"/"+w((Q=t(r).ruleCheckStatus.get(t(g)))==null?void 0:Q.checkTime),1)):x("",!0),t(z)("editor")?(m(),D(V,{key:1,class:"box-item",effect:"dark",content:((Y=t(r).ruleCheckStatus.get(t(g)))==null?void 0:Y.checkStatus)==="1"?"取消检查":"检查",placement:"top"},{default:o(()=>{var G;return[l(v,{icon:"icon-jiancha",class:B(["refresh-icon",{active:((G=t(r).ruleCheckStatus.get(t(g)))==null?void 0:G.checkStatus)==="1"}]),onClick:ie,style:{padding:"4px 5px 3px"}},null,8,["class"])]}),_:1},8,["content"])):x("",!0),l(V,{class:"box-item",effect:"dark",content:"刷新缓存",placement:"top"},{default:o(()=>[l(v,{icon:"icon-gengxin",class:B({"refresh-icon":!0,"loading-animation":t(C)}),onClick:oe,style:{padding:"4px"}},null,8,["class"])]),_:1})])])]}),default:o(()=>[s("div",Ye,[l(ue,{modelValue:t(d).keyword,"onUpdate:modelValue":n[0]||(n[0]=a=>t(d).keyword=a),placeholder:"请输入关键字","suffix-icon":t(Ne),style:{width:"300px"},clearable:"",onInput:n[1]||(n[1]=a=>t(A)(1))},null,8,["modelValue","suffix-icon"]),s("div",Ge,[t(_).length?(m(),D(de,{key:0,"model-value":!0,label:"批量删除",border:"",style:{"margin-right":"12px"},onClick:ne})):x("",!0),l(I,{plain:"",type:"warning",onClick:n[2]||(n[2]=a=>U("","add"))},{default:o(()=>[l(v,{icon:"icon-xinzengdianpingjihua"}),Ke]),_:1})])]),l(me,{ref_key:"tableRef",ref:$,"table-name":"rule-special-populations-table",loading:t(c),"table-data":t(u),columns:t(ee),isShowTableSet:!1,onCheckboxChange:P,onCheckboxAll:P,onFilterChange:le,onCellClick:q,"row-class-name":ce},{patientName:o(a=>[s("span",null,[a.row.patientType!=="18"?(m(),k("span",Xe,w(a.row.patientName),1)):x("",!0),a.row.patientType==="18"?(m(),k("span",Ze,[a.row.customAgeMin!==null?(m(),k("span",et,w(a.row.customAgeMin)+w(a.row.customAgeMinUnit),1)):x("",!0),tt,a.row.customAgeMax!==null?(m(),k("span",at,w(a.row.customAgeMax)+w(a.row.customAgeMaxUnit),1)):x("",!0)])):x("",!0)])]),problemLevelCode:o(a=>[l(he,{modelValue:a.row.problemLevelCode,"onUpdate:modelValue":i=>a.row.problemLevelCode=i,size:"large",placeholder:"请选择",onChange:i=>re(i,a.row)},{default:o(()=>[(m(!0),k(Re,null,Te(t(r).wordbook.problem_level_rule,i=>(m(),D(pe,{key:i.dictLabel,label:i.dictLabel,value:i.dictValue},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),whetherOverstepSynopsis:o(a=>[s("div",null,w(a.row.whetherOverstepSynopsis=="1"?"是":"否"),1)]),active:o(a=>[l(fe,{modelValue:a.row.active,"onUpdate:modelValue":i=>a.row.active=i,loading:t(c),onChange:i=>se(a.row),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),warnSign:o(a=>[s("span",null,w(a.row.warnSign=="0"?"禁用":a.row.warnSign=="1"?"慎用":""),1)]),btns:o(({row:a})=>[l(I,{text:"",type:"primary",onClick:E(i=>U(a,"see"),["stop"])},{default:o(()=>[O("查看")]),_:2},1032,["onClick"]),l(I,{text:"",type:"primary",onClick:E(i=>U(a,"edit"),["stop"])},{default:o(()=>[O("编辑")]),_:2},1032,["onClick"]),l(I,{text:"",type:"primary",onClick:E(i=>j({id:[a.id]}),["stop"])},{default:o(()=>[O("删除")]),_:2},1032,["onClick"])]),_:1},8,["loading","table-data","columns"]),l(_e,{"current-page":t(d).pageNum,"page-size":t(d).pageSize,total:t(d).total,"prev-text":"上一页","next-text":"下一页",onCurrentChange:t(A),onSizeChange:ae},null,8,["current-page","page-size","total","onCurrentChange"])]),_:1})],2),s("div",{class:B(["right-container",t(S)?"right-container-half":"right-container-all"])},[s("div",{class:"toggle-btn",onClick:te},[nt,s("div",lt,[K(l(H,null,{default:o(()=>[l(ge)]),_:1},512),[[X,t(S)]]),K(l(H,null,{default:o(()=>[l(ve)]),_:1},512),[[X,!t(S)]])]),ot]),l(W,{class:"no-bottom-card"},{default:o(()=>[l(we,{dimensionCode:t(g),ref_key:"ruleEditingBox",ref:F},null,8,["dimensionCode"])]),_:1})],2)]),l(Ce,{ref_key:"editRowDiag",ref:T,onQuery:M},null,512)])}}}),yt=Ee(st,[["__scopeId","data-v-605b13f1"]]);export{yt as default};
