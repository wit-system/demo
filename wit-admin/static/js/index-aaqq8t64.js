var oe=Object.defineProperty;var P=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var U=(a,o,l)=>o in a?oe(a,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[o]=l,A=(a,o)=>{for(var l in o||(o={}))ne.call(o,l)&&U(a,l,o[l]);if(P)for(var l of P(o))se.call(o,l)&&U(a,l,o[l]);return a};var x=(a,o,l)=>new Promise((b,w)=>{var v=u=>{try{p(l.next(u))}catch(g){w(g)}},S=u=>{try{p(l.throw(u))}catch(g){w(g)}},p=u=>u.done?b(u.value):Promise.resolve(u.value).then(v,S);p((l=l.apply(a,o)).next())});import{d as ie,p as O,a as re,_ as ce}from"./ruleAdd-DzjlvNMz.js";import ue from"./ruleEditing-BBFDZCcl.js";import{d as de,aj as ge,r as n,P as Q,b as W,l as me,b9 as pe,a0 as he,m as k,o as fe,c as ve,y as i,s as c,n as d,p as s,a6 as _e,x as L,B as I,ap as ye,C as be,af as we,ag as Ce,I as xe,J as ke,_ as Le}from"./index-BN8uVNSO.js";import{_ as Se}from"./index.vue_vue_type_style_index_0_lang-CYTYEVrP.js";import{g as Be}from"./dict-Ck584AJf.js";import"./ruleSetItemContent-D7rCiVyD.js";import"./ruleItem-C9FT7fac.js";import"./judgingConditions-BTKVFXak.js";import"./ruleCustomParameters-D1NrVm7e.js";import"./ifComponent.vue_vue_type_style_index_0_lang-TMjKtAQ8.js";import"./index-DxSYlWYB.js";import"./index.vue_vue_type_script_setup_true_lang-BkXq5IQh.js";const ze=a=>(xe("data-v-597f176c"),a=a(),ke(),a),Ne={class:"matching-tools-pharmaceutical-monitoring-rule-page auto-height-container"},Fe={class:"rule-left flex-column"},Ie=ze(()=>d("div",{class:"sub-title"},[d("span",{class:"title"},"药学监护规则管理")],-1)),Ve={class:"padding-horizontal flex-all"},$e={style:{color:"#333333"}},Re={class:"rule-right"},Te=de({__name:"index",props:{signs:{type:Number,default:0},ruleForm:{type:Object,default:()=>({id:"",generalName:""})}},setup(a){ge();const o=n([]),l=Q("$baseMessage"),b=Q("$baseConfirm"),w=a,v=n(null),S=n("pharmaceutical_care"),p=n(""),u=n(""),g=n(0),r=n({tutelageType:"",tutelageLevel:"",keyword:"",pageNum:1,pageSize:20});let B=n([]);const V=W({searchListButtons:[{label:"搜 索",isShowLoading:!0,attrs:{type:"primary"},events:{click:C}}],searchList:[{type:"input",field:"keyword",label:"",isOutBorder:!1,options:[],attrs:{width:200,placeholder:"输入关键字搜索",filterable:!0,clearable:!0,suffixIcon:"Search"}}],rightSearchListButtons:[{label:"批量删除",isShowLoading:!0,attrs:{type:"primary",plain:!0},events:{click:()=>G()}},{label:"新增匹配规则",icon:"icon-xinzengdianpingjihua",isShowLoading:!0,attrs:{type:"primary",plain:!0},events:{click:()=>M({})}}]}),z=n(null),h=n(!1),f=n([]),$=n([{type:"checkbox",field:"tutelageType",title:"监护类型",width:"112",render:!0},{field:"ruleName",title:"规则名称",width:"117"},{field:"ruleBigCategory",title:"规则大类",minWidth:"120",render:!0},{field:"ruleSmallCategory",title:"规则小类",minWidth:"120"},{field:"tutelageLevel",title:"监护级别",width:"92",render:!0},{field:"ratingBasis",title:"评级依据",width:"92"},{field:"status",title:"启用状态",width:"80",render:!0},{field:"btns",title:"操作",align:"center",width:"120",fixed:"right",render:!0}]),_=n([]);me(()=>w.signs,e=>{e===1?(_.value=[...$.value],pe("editor")&&(_.value.splice(1,0,{field:"updateName",title:"编辑人",width:"80"}),_.value.splice(2,0,{field:"updateTime",title:"编辑时间",width:"165"}))):_.value=[...$.value]},{immediate:!0});const J=()=>x(this,null,function*(){const{data:e}=yield O(r.value);B.value=e||[],V.searchList[0].options=B.value});W({hisFreqCodes:[],syFreqCode:""}),he(()=>{J()});const R=n(null);function C(){R.value.search()}const N=()=>{h.value=!0,O(A({},r.value)).then(({data:e})=>{h.value=!1,f.value=e.records||[],g.value=e.total,f.value.length>0&&(z.value.tableMethods("setCurrentRow",f.value[0]),T({row:f.value[0]}))}).catch(()=>{h.value=!1,f.value=[],g.value=0})},T=({row:e})=>{p.value=e.id,v.value&&v.value.query(e)},D=n();function M(e){D.value.open(e)}const E=e=>{o.value=z.value.tableMethods("getCheckboxRecords")};function G(e){if(console.log(o.value.length),o.value.length>0){const m=o.value.map(y=>y.id);b("您确定要删除选中项吗",null,()=>x(this,null,function*(){console.log(m);const{msg:y}=yield ie(m);l(y,"success","hey"),yield N()}))}else l("您未选中任何行","warning","hey")}function H(e){console.log(e.id),b("您确定要删除当前项吗",null,()=>x(this,null,function*(){const{msg:m}=yield re(e.id);l(m,"success","hey"),yield N()}))}const K=e=>{r.value.pageNum=1,r.value.pageSize=e,C()},X=e=>{r.value.pageNum=e,C()};return(e,m)=>{const y=Se,Y=k("el-switch"),j=k("el-button"),Z=we,ee=Ce,q=k("el-col"),te=ue,ae=k("el-row"),le=ce;return fe(),ve("div",Ne,[i(ae,{gutter:8,class:"rowclass"},{default:c(()=>[i(q,{span:12},{default:c(()=>[d("div",Fe,[Ie,i(y,{ref_key:"searchRef",ref:R,modelValue:s(r),"onUpdate:modelValue":m[0]||(m[0]=t=>_e(r)?r.value=t:null),"search-data":s(V),"search-name":"matching-tools-vertify-audit-rule-search",searching:s(h),border:!1,onSearch:N},null,8,["modelValue","search-data","searching"]),d("div",Ve,[i(Z,{ref_key:"tableRef",ref:z,"table-name":"matching-tools-vertify-audit-rule-table",loading:s(h),"table-data":s(f),columns:s(_),onCheckboxChange:E,onCheckboxAll:E,onCellClick:T},{ruleBigCategory:c(t=>[L(I(s(Be)("rule_big_category",t.row.ruleBigCategory)),1)]),tutelageType:c(t=>[L(I(t.row.tutelageType),1)]),tutelageLevel:c(t=>[d("div",null,[d("span",{class:"circleStyle",style:ye({backgroundColor:t.row.tutelageLevel=="1"?"#22C580":t.row.tutelageLevel=="2"?"#FC9F15":"#ED6356"})},null,4),d("span",$e,I(t.row.tutelageLevel==="1"?"一级监护":t.row.tutelageLevel==="2"?"二级监护":t.row.tutelageLevel==="3"?"三级监护":""),1)])]),status:c(t=>[i(Y,{modelValue:t.row.status,"onUpdate:modelValue":F=>t.row.status=F,loading:s(h),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading"])]),btns:c(t=>[i(j,{text:"",type:"primary",disabled:a.signs==1&&t.row.signs==0,onClick:F=>M(t.row)},{default:c(()=>[L("编辑")]),_:2},1032,["disabled","onClick"]),i(j,{text:"",type:"primary",disabled:a.signs==1&&t.row.signs==0,onClick:be(F=>H(t.row),["stop"])},{default:c(()=>[L(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:1},8,["loading","table-data","columns"])]),i(ee,{layout:"total, sizes, prev, pager, next","current-page":s(r).pageNum,"page-size":s(r).pageSize,total:s(g),"prev-text":"上一页","next-text":"下一页",onCurrentChange:X,onSizeChange:K},null,8,["current-page","page-size","total"])])]),_:1}),i(q,{span:12},{default:c(()=>[d("div",Re,[i(te,{title:"规则组合条件维护",apiType:"tutelage",autoFlex:!0,dimensionCode:s(S),refId:s(p),id:s(u),ref_key:"ruleEditingBox",ref:v},null,8,["dimensionCode","refId","id"])])]),_:1})]),_:1}),i(le,{ref_key:"addRef",ref:D,signs:a.signs,ruleForm:a.ruleForm,laboratoryList:s(B),onQuery:C,onClick:t=>"editClick",modal:!0},null,8,["signs","ruleForm","laboratoryList"])])}}}),He=Le(Te,[["__scopeId","data-v-597f176c"]]);export{He as default};
