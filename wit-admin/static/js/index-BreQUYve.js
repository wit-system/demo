var x=(n,k,m)=>new Promise((f,v)=>{var S=r=>{try{d(m.next(r))}catch(u){v(u)}},_=r=>{try{d(m.throw(r))}catch(u){v(u)}},d=r=>r.done?f(r.value):Promise.resolve(r.value).then(S,_);d((m=m.apply(n,k)).next())});import{an as g,d as Z,r as i,P as F,b as $,h as ee,m as w,o as te,c as ae,y as o,n as B,s as l,B as oe,x as V,ae as U,af as se,ag as le,ah as ne}from"./index-9sA7DK8G.js";import{_ as re}from"./index.vue_vue_type_style_index_0_lang-BRnHlKRC.js";import"./ifComponent.vue_vue_type_style_index_0_lang-Bop7xqfB.js";import"./index-B9NkytPw.js";import"./index.vue_vue_type_script_setup_true_lang-_NT1uA2K.js";import"./dict-urOAkSAA.js";function ie(n){return g({url:"/system/post/list",method:"get",params:n})}function de(n){return g({url:`/system/post/${n}`,method:"get"})}function ue(n){return g({url:"/system/post/del-ids",method:"post",data:n})}function pe(n){return g({url:"/system/post/add",method:"post",data:n})}function ce(n){return g({url:"/system/post/edit",method:"post",data:n})}const me={class:"system-operateJournal-container auto-height-container"},fe={class:"app-content padding-out"},he={class:"app-pagination"},Ve=Z({name:"OperateJournal",__name:"index",emits:["fetch-data"],setup(n,{emit:k}){const m=k,f=i(null),v=F("$baseConfirm"),S=F("$baseMessage"),_=i([]),d=i(!0),r=i([{field:"postId",title:"职位Id",width:"100"},{field:"postCode",title:"职位编码",minWidth:"120"},{field:"postName",title:"职位名称",minWidth:"120"},{field:"status",title:"状态",width:"70",render:!0},{field:"postSort",title:"显示顺序",width:"80"},{field:"createTime",title:"创建时间",width:"165"},{field:"remark",title:"备注",minWidth:"120"},{field:"btns",title:"操作",align:"center",width:"140",fixed:"right",render:!0}]),u=i(!1),h=i(!1),L=[{value:"0",label:"正常"},{value:"1",label:"异常"}],j=$({postCode:[{required:!0,trigger:"blur",message:"请输入职位编码"}],postName:[{required:!0,trigger:"blur",message:"请输入职位名称"}]}),I=i(0),p=i({title:"",account:"",postCode:"",postName:"",status:"",searchDate:"",pageNum:1,pageSize:20}),t=$({postCode:"",postName:"",postSort:"",remark:""}),E=$({searchList:[{type:"input",field:"postCode",label:"职位编码",isOutBorder:!0,attrs:{width:130,placeholder:"请输入职位编码",clearable:!0},events:{}},{type:"input",field:"postName",label:"职位名称",isOutBorder:!0,attrs:{width:130,placeholder:"请输入职位名称",clearable:!0},events:{}},{type:"select",field:"status",label:"操作状态",isOutBorder:!0,valueField:"value",labelField:"label",options:L,attrs:{width:90,clearable:!0},events:{}},{type:"date-picker",field:"searchDate",label:"操作日期",isOutBorder:!0,attrs:{width:240,placeholder:"请选择",clearable:!0,format:"YYYY-MM-DD",type:"daterange"},events:{}}],searchListButtons:[{label:"搜 索",isShowLoading:!0,attrs:{type:"primary"},events:{click:J}},{label:"新建",icon:"icon-xinzengdianpingjihua",attrs:{type:"warning"},events:{click:A}}]}),z=i();function J(){z.value.search()}const Y=()=>{f.value.resetFields(),O(),h.value=!1},M=a=>{h.value=!0,a?(u.value="编辑",de(a.postId).then(e=>{t.postId=e.data.postId,t.postCode=e.data.postCode,t.postName=e.data.postName,t.postSort=e.data.postSort,t.remark=e.data.remark})):u.value="新增"},q=a=>{p.value.pageSize=a,c()},T=a=>{p.value.pageNum=a,c()},N=()=>{f.value.resetFields(),O(),m("fetch-data"),h.value=!1},O=()=>{t.postId="",t.postCode="",t.postName="",t.postSort="",t.remark=""},W=()=>{f.value.validate(a=>{a&&(t.postId?ce(t).then(()=>{U.success("职位更改成功"),N(),c()}):pe(t).then(()=>{U.success("职位新增成功"),N(),c()}))})},P=(a={})=>{M(a)},R=(a={})=>{if(a.postId){const e=[];e.push(a.postId),v("您确定要删除选中项吗",null,()=>x(this,null,function*(){const{msg:D}=yield ue(e);S(D,"success","hey"),yield c()}))}};function A(){M(void 0)}const c=()=>x(this,null,function*(){d.value=!1;let a=JSON.parse(JSON.stringify(p.value));a.searchDate&&(a.startDate=a.searchDate[0],a.endDate=a.searchDate[1],delete a.searchDate);const{data:e}=yield ie(a);_.value=e.records||[],I.value=e.total,d.value=!1});return ee(()=>{c()}),(a,e)=>{const D=re,b=w("el-button"),G=se,H=le,y=w("el-input"),C=w("el-form-item"),K=w("el-form"),Q=ne;return te(),ae("div",me,[o(D,{ref_key:"refSearch",ref:z,modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),"search-data":E,"is-cache":!1,"search-name":"system-jobManagement-search",searching:d.value,onSearch:c},null,8,["modelValue","search-data","searching"]),B("div",fe,[o(G,{"table-name":"system-jobManagement-table",loading:d.value,tableData:_.value,columns:r.value},{status:l(s=>[B("span",null,oe(s.row.status==1?"停用":"正常"),1)]),btns:l(s=>[o(b,{text:"",type:"primary",onClick:X=>P(s.row)},{default:l(()=>[V("编辑")]),_:2},1032,["onClick"]),o(b,{text:"",type:"primary",onClick:X=>R(s.row)},{default:l(()=>[V("删除")]),_:2},1032,["onClick"])]),_:1},8,["loading","tableData","columns"])]),B("div",he,[o(H,{"current-page":p.value.pageNum,"page-size":p.value.pageSize,total:I.value,onCurrentChange:T,onSizeChange:q},null,8,["current-page","page-size","total"])]),o(Q,{modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=s=>h.value=s),"before-close":Y,title:u.value,width:"30%"},{footer:l(()=>[o(b,{onClick:N},{default:l(()=>[V("取 消")]),_:1}),o(b,{type:"primary",onClick:W},{default:l(()=>[V("确 定")]),_:1})]),default:l(()=>[o(K,{ref_key:"formRef",ref:f,model:t,rules:j,"label-width":"100px"},{default:l(()=>[o(C,{label:"职位编码",prop:"postCode"},{default:l(()=>[o(y,{modelValue:t.postCode,"onUpdate:modelValue":e[1]||(e[1]=s=>t.postCode=s),clearable:""},null,8,["modelValue"])]),_:1}),o(C,{label:"职位名称",prop:"postName"},{default:l(()=>[o(y,{modelValue:t.postName,"onUpdate:modelValue":e[2]||(e[2]=s=>t.postName=s),clearable:""},null,8,["modelValue"])]),_:1}),o(C,{label:"显示顺序",prop:"postSort"},{default:l(()=>[o(y,{modelValue:t.postSort,"onUpdate:modelValue":e[3]||(e[3]=s=>t.postSort=s),clearable:""},null,8,["modelValue"])]),_:1}),o(C,{label:"备注",prop:"remark"},{default:l(()=>[o(y,{modelValue:t.remark,"onUpdate:modelValue":e[4]||(e[4]=s=>t.remark=s),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Ve as default};
