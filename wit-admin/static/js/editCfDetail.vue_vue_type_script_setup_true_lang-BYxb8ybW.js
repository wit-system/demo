var x=(M,$,C)=>new Promise((L,w)=>{var B=g=>{try{b(C.next(g))}catch(_){w(_)}},r=g=>{try{b(C.throw(g))}catch(_){w(_)}},b=g=>g.done?L(g.value):Promise.resolve(g.value).then(B,r);b((C=C.apply(M,$)).next())});import{d as te,aj as oe,r as p,P as de,b as se,m as c,o as u,c as q,y as s,s as o,x as y,p as l,q as m,a6 as j,z as D,F as T,A as P,bc as re,bd as ue,be as ne,bf as ie,bg as me,bh as ge,bi as ce,bj as fe,H as pe,ah as be}from"./index-C3-31E46.js";const ye={class:"edit-cf-edit-container"},Ve=te({name:"EditYpcfDetail",__name:"editCfDetail",props:{ylflTreeData:{type:Array,default:()=>[]}},emits:["close-diag"],setup(M,{expose:$,emit:C}){const L=oe(),w=p(null),B=de("$baseMessage"),r=p("1"),b=p(""),g=p(""),_=p([]),G=p([]),N=p(!1),v=p("新增药品分类"),R=p(null),A=p(null),K=C,a=se({id:"",classifyCode:"",drugsName:"",classifyName:"",parentCode:"",sort:void 0,drugsId:"",generalName:"",unit:"",dosageUom:"",dosage:"",generalId:""}),O={parentCode:[{required:!0,message:"请选择分类上级",trigger:"change"}],drugsId:[{required:!0,message:"请选择药物分类",trigger:"change"}],generalId:[{required:!0,message:"请选择通用名分类",trigger:"change"}],classifyCode:[{required:!0,message:"请输入分类编码",trigger:"blur"}],classifyName:[{required:!0,message:"请输入分类名称",trigger:"blur"}],drugsName:[{required:!0,message:"请输入药物名称",trigger:"blur"}],generalName:[{required:!0,message:"请输入通用名名称",trigger:"blur"}],unit:[{required:!0,message:"请选择单位",trigger:"blur"}],dosage:[{required:!0,message:"请输入剂量",trigger:"blur"}]},Q=(n,e,d,f)=>x(this,null,function*(){yield Y(""),yield H(""),N.value=!0;for(let i in a)a[i]="",i==="sort"&&(a[i]=void 0);g.value=e,b.value=f,a.classifyCode=d||"",e=="edit"?(v.value="编辑药品分类",r.value=f):(v.value="新增药品分类",r.value=f?f=="1"?"2":"3":"1"),n&&(yield W(f,n))}),W=(n,e)=>x(this,null,function*(){const d=n=="1"?yield re({id:e}):n=="2"?yield ue({id:e}):yield ne({id:e});d.code==200&&d.data&&(a.id=d.data.id,a.classifyCode=d.data.classifyCode||"",a.drugsName=d.data.drugsName||"",a.sort=d.data.sort,a.generalName=d.data.generalName||"",a.unit=d.data.unit||"",a.drugsId=d.data.drugsId||"",a.dosageUom=d.data.dosageUom||d.data.unit,a.dosage=d.data.dosage,a.generalId=d.data.generalId,g.value=="add"&&n=="1"&&(a.drugsId=e),g.value=="add"&&n=="2"&&(a.generalId=e))}),X=()=>{N.value=!1,w.value.resetFields(),K("close-diag")},Z=()=>{w.value.validate(n=>x(this,null,function*(){if(n){let e={};const{id:d,classifyCode:f,drugsName:i,sort:z,generalName:k,unit:I,drugsId:U,generalId:E,dosage:F,dosageUom:S}=a;e={classifyCode:f,drugsName:i,sort:z},g.value=="edit"&&(e.id=d),r.value=="2"?(e.generalName=k,e.unit=I,e.drugsId=U):r.value=="3"&&(e.generalId=E,e.dosage=F,e.dosageUom=S,e.drugsId=U);const h=r.value=="1"?yield ie(e):r.value=="2"?yield me(e):yield ge(e);if(h.resultCode!=1){B(h.msg,"error","hey");return}B(h.msg,"success","hey")}}))},Y=n=>{clearTimeout(R.value),R.value=setTimeout(()=>x(this,null,function*(){const e=yield ce({pageNum:1,pageSize:9999,keyword:n,classifyCode:a.classifyCode});e.resultCode==1&&(_.value=e.data.records||[])}),300)},H=n=>{clearTimeout(A.value),A.value=setTimeout(()=>x(this,null,function*(){const e=yield fe({pageNum:1,pageSize:9999,keyword:n,classifyCode:a.classifyCode});e.resultCode==1&&(G.value=e.data.records||[])}),300)},ee=n=>{_.value.forEach(e=>{e.id==n&&(a.classifyCode=e.classifyCode,a.dosageUom=e.unit,a.drugsId=e.drugsId)})};return $({showEdit:Q}),(n,e)=>{const d=c("el-radio"),f=c("el-radio-group"),i=c("el-form-item"),z=c("el-tree-select"),k=c("el-option"),I=c("el-select"),U=c("el-input"),E=c("el-input-number"),F=pe,S=c("el-icon"),h=c("el-tooltip"),ae=c("el-form"),J=c("el-button"),le=be;return u(),q("div",ye,[s(le,{modelValue:l(N),"onUpdate:modelValue":e[12]||(e[12]=t=>j(N)?N.value=t:null),"append-to-body":"","before-close":X,title:l(v),width:"600"},{footer:o(()=>[s(J,{onClick:e[11]||(e[11]=t=>N.value=!1)},{default:o(()=>[y("取 消")]),_:1}),s(J,{type:"primary",onClick:Z},{default:o(()=>[y("确 定")]),_:1})]),default:o(()=>[s(ae,{ref_key:"formRef",ref:w,"label-width":"120px",model:l(a),rules:O},{default:o(()=>[s(i,{label:"",prop:"parentCodeList"},{default:o(()=>[l(v)=="编辑药品分类"?(u(),m(f,{key:0,modelValue:l(r),"onUpdate:modelValue":e[0]||(e[0]=t=>j(r)?r.value=t:null)},{default:o(()=>[s(d,{disabled:l(v)=="编辑药品分类",value:"1",label:"药物"},{default:o(()=>[y("药物")]),_:1},8,["disabled"]),s(d,{disabled:l(v)=="编辑药品分类",value:"2",label:"通用名"},{default:o(()=>[y("通用名")]),_:1},8,["disabled"]),s(d,{disabled:l(v)=="编辑药品分类",value:"3",label:"剂量"},{default:o(()=>[y("剂量")]),_:1},8,["disabled"])]),_:1},8,["modelValue"])):(u(),m(f,{key:1,modelValue:l(r),"onUpdate:modelValue":e[1]||(e[1]=t=>j(r)?r.value=t:null)},{default:o(()=>[l(b)?D("",!0):(u(),m(d,{key:0,value:"1",label:"药物"},{default:o(()=>[y("药物")]),_:1})),l(b)==""||l(b)=="1"?(u(),m(d,{key:1,value:"2",label:"通用名"},{default:o(()=>[y("通用名")]),_:1})):D("",!0),s(d,{value:"3",label:"剂量"},{default:o(()=>[y("剂量")]),_:1})]),_:1},8,["modelValue"]))]),_:1}),l(r)=="1"?(u(),m(i,{key:0,label:"药理分类:",prop:"classifyCode"},{default:o(()=>[s(z,{modelValue:l(a).classifyCode,"onUpdate:modelValue":e[2]||(e[2]=t=>l(a).classifyCode=t),"check-strictly":"",data:[{classifyName:"根目录",classifyCode:"0",children:M.ylflTreeData}],placeholder:"请选择或者输入关键字搜索",props:{value:"classifyCode",label:"classifyName",children:"children"},style:{width:"300px"},"value-key":"classifyCode"},null,8,["modelValue","data"])]),_:1})):l(r)=="2"?(u(),m(i,{key:1,label:"药物分类:",prop:"drugsId"},{default:o(()=>[s(I,{modelValue:l(a).drugsId,"onUpdate:modelValue":e[3]||(e[3]=t=>l(a).drugsId=t),clearable:"",filterable:"",remote:"","remote-method":H,style:{width:"300px"}},{default:o(()=>[(u(!0),q(T,null,P(l(G),(t,V)=>(u(),m(k,{key:V,label:t.drugsName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):l(r)=="3"?(u(),m(i,{key:2,label:"通用名称分类:",prop:"generalId"},{default:o(()=>[s(I,{modelValue:l(a).generalId,"onUpdate:modelValue":e[4]||(e[4]=t=>l(a).generalId=t),clearable:"",filterable:"",remote:"","remote-method":Y,style:{width:"300px"},onChange:ee},{default:o(()=>[(u(!0),q(T,null,P(l(_),(t,V)=>(u(),m(k,{key:V,label:t.generalName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):D("",!0),l(r)=="1"?(u(),m(i,{key:3,label:"药物名称:",prop:"drugsName"},{default:o(()=>[s(U,{modelValue:l(a).drugsName,"onUpdate:modelValue":e[5]||(e[5]=t=>l(a).drugsName=t),modelModifiers:{trim:!0},clearable:"",placeholder:"请输入",style:{width:"300px"}},null,8,["modelValue"])]),_:1})):l(r)=="2"?(u(),m(i,{key:4,label:"通用名名称:",prop:"generalName"},{default:o(()=>[s(U,{modelValue:l(a).generalName,"onUpdate:modelValue":e[6]||(e[6]=t=>l(a).generalName=t),modelModifiers:{trim:!0},clearable:"",placeholder:"请输入",style:{width:"300px"}},null,8,["modelValue"])]),_:1})):D("",!0),l(r)=="2"?(u(),m(i,{key:5,label:"单位:",prop:"unit"},{default:o(()=>[s(I,{modelValue:l(a).unit,"onUpdate:modelValue":e[7]||(e[7]=t=>l(a).unit=t),placeholder:"单位",style:{width:"300px"}},{default:o(()=>[(u(!0),q(T,null,P(l(L).wordbook.dosage_unit,(t,V)=>(u(),m(k,{key:V,label:t.dictLabel,value:t.dictLabel},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):l(r)=="3"?(u(),m(i,{key:6,label:"剂量:",prop:"dosage"},{default:o(()=>[s(U,{modelValue:l(a).dosage,"onUpdate:modelValue":e[8]||(e[8]=t=>l(a).dosage=t),modelModifiers:{trim:!0},clearable:"",placeholder:"请输入",oninput:"value=value.replace(/[^\\d.]/g,'')",style:{width:"200px"}},null,8,["modelValue"]),s(I,{modelValue:l(a).dosageUom,"onUpdate:modelValue":e[9]||(e[9]=t=>l(a).dosageUom=t),placeholder:"单位",style:{width:"100px"},disabled:""},{default:o(()=>[(u(!0),q(T,null,P(l(L).wordbook.dosage_unit,(t,V)=>(u(),m(k,{key:V,label:t.dictLabel,value:t.dictLabel},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):D("",!0),s(i,{label:"显示顺序:"},{default:o(()=>[s(E,{modelValue:l(a).sort,"onUpdate:modelValue":e[10]||(e[10]=t=>l(a).sort=t),"controls-position":"right",min:1,style:{width:"88px"}},null,8,["modelValue"]),s(h,{content:"若未填写显示顺序，则默认为上级分类中的末位排序",placement:"top-start"},{default:o(()=>[s(S,{class:"color-warning",style:{"margin-left":"8px","font-size":"18px"}},{default:o(()=>[s(F,{icon:"icon-xintishi"})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{Ve as _};
