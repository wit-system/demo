var k=(m,x,f)=>new Promise((C,b)=>{var p=l=>{try{v(f.next(l))}catch(_){b(_)}},T=l=>{try{v(f.throw(l))}catch(_){b(_)}},v=l=>l.done?C(l.value):Promise.resolve(l.value).then(p,T);v((f=f.apply(m,x)).next())});import{d as me,P as z,r as i,b as fe,m as d,o as h,q,s as t,y as a,x as c,p as u,a6 as L,c as M,F as Q,A,t as G,B as _e,v as H,av as be,H as ve,af as ye,ah as ge,I as ke,J as he,n as J,_ as we}from"./index-9sA7DK8G.js";import Ve from"./index-DNTDtGZt.js";import{a as xe,b as Ce}from"./prescriptionIssueSettings-pS7GoePx.js";const P=m=>(ke("data-v-747f3f7a"),m=m(),he(),m),Te=P(()=>J("span",null,"添加",-1)),Ie=P(()=>J("span",null,"删除",-1)),Se=me({name:"prescriptionIssueSettingsEdit",__name:"prescriptionIssueSettingsEdit",emits:["fetch-data"],setup(m,{expose:x,emit:f}){const C=f;z("$baseConfirm");const b=z("$baseMessage"),p=i(""),T=i([{label:"添加药品",value:"1"},{label:"添加科室",value:"2"},{label:"添加医生",value:"3"}]),v=i([{label:"西药",value:"1"},{label:"中成药",value:"2"},{label:"中药",value:"3"}]),l=i("1"),_=i(1),I=i(""),y=i(!1),K=i(null),$=i(null),W={questionCode:"",type:"",status:"",drugTypes:[],deptType:"",items:[]},s=fe({questionCode:"",type:"",status:"",drugTypes:[],deptType:"",items:[]}),X=i(!1),r=i([]),S=i([]),Y=()=>"boldFont";function Z(n){return k(this,null,function*(){y.value=!0,I.value=n.questionCode,p.value="药品",l.value="1",S.value=U(),yield j(l.value),yield be()})}x({showEdit:Z});function j(n){return k(this,null,function*(){const{data:e}=yield xe({questionCode:I.value,type:n});ee(e)?Object.assign(s,W):Object.assign(s,e),r.value=e.items||[]})}const ee=n=>Object.keys(n).length===0;function D(){C("fetch-data"),y.value=!1}function te(){if(l.value=="2"&&s.deptType==""){b("请选择一个适用类型","success","hey");return}_.value=l.value=="1"?1:l.value=="3"?4:l.value=="2"&&s.deptType=="1"?2:3,$.value.showEdit({selectorType:_.value})}function ae(n){s.items.splice(n.scope.rowIndex,1),r.value.splice(n.scope.rowIndex,1)}function le(n,e){return k(this,null,function*(){N(!1,e),yield j(n),B(n)})}function B(n=l.value){p.value=n=="1"?"药品":n=="3"?"医生":s.deptType==1?"科室":s.deptType==2?"科室组":"",S.value=U()}function oe(){B()}function N(se){return k(this,arguments,function*(n,e=l.value){s.type=e,s.questionCode=I.value;const{msg:E}=yield Ce(s);b(E,"success","hey"),n&&D()})}function U(){return[{field:"code",title:p.value+"编码",width:"200"},{field:"name",title:p.value+"名称",width:"503"},{field:"btns",title:"操作",width:"90",fixed:"right",render:!0}]}function ne(n){s.items=n,r.value=n}return(n,e)=>{const se=d("el-tab-pane"),E=d("el-tabs"),g=d("el-radio"),F=d("el-radio-group"),w=d("el-form-item"),ue=d("el-checkbox"),ie=d("el-checkbox-group"),R=ve,V=d("el-button"),de=d("el-form"),ce=ye,pe=Ve,re=ge;return h(),q(re,{modelValue:u(y),"onUpdate:modelValue":e[6]||(e[6]=o=>L(y)?y.value=o:null),"append-to-body":"",title:"添加类型",width:"826px",onClose:D,class:"addTypeFormDialog"},{footer:t(()=>[a(V,{onClick:D},{default:t(()=>[c("取 消")]),_:1}),a(V,{type:"primary",onClick:e[4]||(e[4]=o=>N(!0))},{default:t(()=>[c("保 存")]),_:1})]),default:t(()=>[a(E,{modelValue:u(l),"onUpdate:modelValue":e[0]||(e[0]=o=>L(l)?l.value=o:null),"before-leave":le},{default:t(()=>[(h(!0),M(Q,null,A(u(T),(o,O)=>(h(),q(se,{key:O,label:o.label,name:o.value},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),a(de,{ref_key:"formRef",ref:K,"label-width":"64px",model:u(s),"label-position":"left"},{default:t(()=>[a(w,{label:"适用状态"},{default:t(()=>[a(F,{modelValue:u(s).status,"onUpdate:modelValue":e[1]||(e[1]=o=>u(s).status=o),class:"backLink"},{default:t(()=>[a(g,{value:"1",label:"所有"},{default:t(()=>[c("所有")]),_:1}),a(g,{value:"2",label:"只适用"},{default:t(()=>[c("只适用")]),_:1}),a(g,{value:"3",label:"排除"},{default:t(()=>[c("排除")]),_:1})]),_:1},8,["modelValue"])]),_:1}),G(a(w,{label:"药品类型"},{default:t(()=>[a(ie,{modelValue:u(s).drugTypes,"onUpdate:modelValue":e[2]||(e[2]=o=>u(s).drugTypes=o),class:"backLink"},{default:t(()=>[(h(!0),M(Q,null,A(u(v),o=>(h(),q(ue,{key:o.value,label:o.value},{default:t(()=>[c(_e(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},512),[[H,u(l)=="1"]]),G(a(w,{label:"适用类型"},{default:t(()=>[a(F,{modelValue:u(s).deptType,"onUpdate:modelValue":e[3]||(e[3]=o=>u(s).deptType=o),class:"backLink",onChange:oe},{default:t(()=>[a(g,{value:"1",label:"科室"},{default:t(()=>[c("科室")]),_:1}),a(g,{value:"2",label:"科室组"},{default:t(()=>[c("科室组")]),_:1})]),_:1},8,["modelValue"])]),_:1},512),[[H,u(l)=="2"]]),a(w,{label:u(p)+"选择","label-width":"78px"},{default:t(()=>[a(V,{type:"primary",onClick:te},{default:t(()=>[a(R,{icon:"icon-xinzengdianpingjihua"}),Te]),_:1})]),_:1},8,["label"])]),_:1},8,["model"]),a(ce,{height:"435","table-name":"system-prescriptionIssueSettings",loading:u(X),tableData:u(r),columns:u(S),"header-cell-class-name":Y,isShowTableSet:!1},{btns:t(o=>[a(V,{text:"",type:"primary",onClick:O=>ae(o)},{default:t(()=>[a(R,{icon:"icon-a-zujian2131",style:{"font-size":"16px"}}),Ie]),_:2},1032,["onClick"])]),_:1},8,["loading","tableData","columns"]),a(pe,{modelValue:u(r),"onUpdate:modelValue":[e[5]||(e[5]=o=>L(r)?r.value=o:null),ne],ref_key:"issueEditRef",ref:$},null,8,["modelValue"])]),_:1},8,["modelValue"])}}}),$e=we(Se,[["__scopeId","data-v-747f3f7a"]]);export{$e as default};
