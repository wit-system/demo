var V=(w,y,x)=>new Promise((f,z)=>{var T=u=>{try{R(x.next(u))}catch(N){z(N)}},m=u=>{try{R(x.throw(u))}catch(N){z(N)}},R=u=>u.done?f(u.value):Promise.resolve(u.value).then(T,m);R((x=x.apply(w,y)).next())});import ye from"./editAdministrationRouteDiag-CNWbNp9d.js";import be from"./ruleEditing-CH1f3cji.js";import{d as Se,r as d,aj as ke,P as Re,b as Ne,a0 as Ie,bs as Le,m as h,T as Oe,o as k,c as ee,n as c,a7 as E,p as t,y as n,s as i,b9 as $,B as q,z as B,q as j,aY as Ve,t as M,bb as qe,x as te,v as ae,aa as Be,ae as U,bL as je,H as ze,ag as Fe,I as Ee,J as $e,_ as De}from"./index-C3-31E46.js";import{l as Te,m as Pe,n as Me,o as Ue}from"./indication-pDCgof6D.js";import"./ruleSetItemContent-BLjp2f7D.js";import"./ruleItem-B6kFXL4R.js";import"./judgingConditions-DJTe05cX.js";import"./index.vue_vue_type_style_index_0_lang-Rf1iYlx6.js";import"./ifComponent.vue_vue_type_style_index_0_lang-h1Ozx49r.js";import"./index-B93FDT35.js";import"./index.vue_vue_type_script_setup_true_lang-DLP8ok9d.js";import"./dict-Bt1K3r7e.js";import"./ruleCustomParameters-XoFX0xKS.js";const D=w=>(Ee("data-v-4c3f1ef5"),w=w(),$e(),w),He={class:"flex justify-between"},Je={class:"flex justify-between align-center"},Qe=D(()=>c("div",{class:"title"},"给药途径",-1)),Ye={class:"header-action-icon"},Ae={key:0},Ge={class:"flex justify-between align-center",style:{"flex-wrap":"wrap"}},Ke={class:"flex"},We=D(()=>c("span",null,"新增给药途径",-1)),Xe=D(()=>c("div",{class:"top"},null,-1)),Ze={class:"center"},et=D(()=>c("div",{class:"bottom"},null,-1)),tt=Se({__name:"index",props:{ruleForm:{type:Object,default:()=>{}}},setup(w){const y=w,x=d(null),f=d("administer"),z=d(""),T=d(""),m=ke(),{refreshCheckStatus:R}=m,u=Re("$baseMessage"),N=d(null),_=d(!1),H=d(null),P=d(!1),v=d([]),L=d([]),I=d(!0);d([{dictLabel:"禁用",dictValue:"1"},{dictLabel:"不推荐",dictValue:"2"},{dictLabel:"慎用",dictValue:"3"},{dictLabel:"提示",dictValue:"4"}]),d([]);const s=Ne({routeName:"",pageNum:1,pageSize:10,total:0,generalId:"",questionLevel:"",whetherOverstepSynopsis:""});Ie(()=>{s.generalId=y.ruleForm.id,O()});function ne(){I.value=!I.value}function O(){return V(this,null,function*(){L.value=[],v.value=[];let e=yield Te(s);if(e.resultCode!=1){s.total=e.data.total;return}s.total=e.data.total,(e.data.records||[]).forEach(a=>{a.isChk=!1;let l=a.idxRoutes;l&&l.length<1?v.value.push(a):l&&l.length>=1?l.forEach((b,g)=>{let r=Object.assign({},a,b,{id:a.id});g==0&&(r.idxRoutes[0].idxRoutes=[],r.idxRoutes[0].idxRoutes.length=r.idxRoutes.length||0);for(let C in r)C!="idxRoutes"&&(r.idxRoutes[g][C]||(r.idxRoutes[g][C]=r[C]));r.idxRoutes[g].hisRouteCode=r.idxRoutes[g].hisRouteCode,r.idxRoutes[g].hisRouteName=r.idxRoutes[g].hisRouteName,v.value.push(Object.assign({},r.idxRoutes[g],{id:r.id}))}):v.value.push(a)}),v.value.length&&(v.value.forEach(a=>{a.isChk=!1}),H.value.setCurrentRow(v.value[0]),Y(v.value[0]))})}const oe=e=>{s.pageNum=1,s.pageSize=e,O()},F=Le(e=>{s.pageNum=e,O()},300);function se(e){L.value=e||[]}function J(e,a){N.value.showDiag(e,a,y.ruleForm.id)}function le(){if(!L.value.length){u("请先勾选表格","info");return}Q({id:L.value.map(e=>e.id)})}function Q(e){Be.confirm("是否确认删除","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>V(this,null,function*(){_.value=!0;const{msg:a}=yield Pe({generalId:s.generalId,ids:e.id});_.value=!1,u(a,"success","hey"),F(1)})).catch(()=>{U({type:"info",message:"取消删除"})})}function ie(e){const a=e.questionLevel;e.active;const l=e.whetherOverstepSynopsis;a&&(a.length===0?s.questionLevel="":a.length===1&&(s.questionLevel=a[0])),l&&(l.length===0?s.whetherOverstepSynopsis="":l.length===1&&(s.whetherOverstepSynopsis=l[0])),F(1)}function ce(){return V(this,null,function*(){_.value=!0,P.value=!0;let e=yield Me();if(_.value=!1,P.value=!1,e.resultCode!="1"){U({type:"info",message:"刷新失败"});return}s.pageNum=1,O(),U({type:"success",message:"刷新成功"})})}function re({row:e,column:a,rowIndex:l,columnIndex:b}){if(e.hasOwnProperty("idxRoutes")){if(e.idxRoutes&&e.idxRoutes.length>1&&["hisRouteCode","hisRouteName"].indexOf(a.property)<0)return{rowspan:e.idxRoutes.length,colspan:1}}else if(e.hasOwnProperty("hisRouteCode")&&e.hasOwnProperty("hisRouteName")&&["hisRouteName","hisRouteCode"].indexOf(a.property)<0)return{rowspan:0,colspan:0}}function ue(e){return V(this,null,function*(){_.value=!0;try{let a=yield Ue(e);if(_.value=!1,a.resultCode!=1){e.active=e.active==="1"?"0":"1",u("规则修改失败","info","hey");return}u("规则修改成功","success","hey")}catch(a){u("规则修改失败","info","hey"),e.active=e.active==="1"?"0":"1",_.value=!1}return!1})}function de(){var l;const a={checkStatus:((l=m.ruleCheckStatus.get(f.value))==null?void 0:l.checkStatus)==="1"?"0":"1",dimensionCode:f.value,refId:y.ruleForm.id};je(a).then(({msg:b})=>{R(y.ruleForm.id),u(b,"success","hey")}).catch(()=>{R(y.ruleForm.id)})}function Y(e){x.value&&x.value.query(e)}function pe({row:e,rowIndex:a}){return e.whetherOverstepSynopsis=="1"?"warning-row":""}return(e,a)=>{const l=ze,b=h("el-tooltip"),g=h("el-input"),r=h("el-checkbox"),C=h("el-button"),p=h("el-table-column"),he=h("el-switch"),fe=h("el-empty"),me=h("el-table"),ge=Fe,A=h("el-card"),_e=h("arrow-left-bold"),G=h("el-icon"),ve=h("arrow-right-bold"),xe=be,Ce=ye,we=Oe("loading");return k(),ee("div",null,[c("div",He,[c("div",{class:E(["left-container",t(I)?"left-container-all":"left-container-half"])},[n(A,{class:"no-bottom-card"},{header:i(()=>{var o,S,K,W,X;return[c("div",Je,[Qe,c("div",Ye,[t($)("editor")&&((o=t(m).ruleCheckStatus.get(t(f)))==null?void 0:o.checkStatus)==="1"?(k(),ee("span",Ae,q(((S=t(m).ruleCheckStatus.get(t(f)))==null?void 0:S.checkName)||((K=t(m).ruleCheckStatus.get(t(f)))==null?void 0:K.checkBy))+"/"+q((W=t(m).ruleCheckStatus.get(t(f)))==null?void 0:W.checkTime),1)):B("",!0),t($)("editor")?(k(),j(b,{key:1,class:"box-item",effect:"dark",content:((X=t(m).ruleCheckStatus.get(t(f)))==null?void 0:X.checkStatus)==="1"?"取消检查":"检查",placement:"top"},{default:i(()=>{var Z;return[n(l,{icon:"icon-jiancha",class:E(["refresh-icon",{active:((Z=t(m).ruleCheckStatus.get(t(f)))==null?void 0:Z.checkStatus)==="1"}]),onClick:de,style:{padding:"4px 5px 3px"}},null,8,["class"])]}),_:1},8,["content"])):B("",!0),n(b,{class:"box-item",effect:"dark",content:"刷新缓存",placement:"top"},{default:i(()=>[n(l,{icon:"icon-gengxin",class:E({"refresh-icon":!0,"loading-animation":t(P)}),onClick:ce,style:{padding:"4px"}},null,8,["class"])]),_:1})])])]}),default:i(()=>[c("div",Ge,[n(g,{modelValue:t(s).routeName,"onUpdate:modelValue":a[0]||(a[0]=o=>t(s).routeName=o),placeholder:"请输入关键字","suffix-icon":t(Ve),style:{width:"300px"},clearable:"",onInput:a[1]||(a[1]=o=>t(F)(1))},null,8,["modelValue","suffix-icon"]),c("div",Ke,[t(L).length?(k(),j(r,{key:0,"model-value":!0,label:"批量删除",border:"",style:{"margin-right":"12px"},onClick:le})):B("",!0),n(C,{plain:"",type:"warning",onClick:a[2]||(a[2]=o=>J("","add"))},{default:i(()=>[n(l,{icon:"icon-xinzengdianpingjihua"}),We]),_:1})])]),M((k(),j(me,{ref_key:"tableRef",ref:H,border:!0,data:t(v),class:"drug-table","span-method":re,onSelectionChange:se,onFilterChange:ie,onRowClick:Y,"highlight-current-row":"",isShowTableSe:!1,"row-class-name":pe},{empty:i(()=>[n(fe,{class:"wit-data-empty no-tip-text",image:t(qe),"image-size":198},null,8,["image"])]),default:i(()=>[n(p,{type:"selection",width:"50"}),t($)("editor")?(k(),j(p,{key:0,label:"编辑人",prop:"updateName",width:"80"})):B("",!0),t($)("editor")?(k(),j(p,{key:1,label:"编辑时间",prop:"updateTime",width:"165"})):B("",!0),n(p,{label:"名称(HIS)",prop:"hisRouteName","min-width":"110"}),n(p,{label:"代码(HIS)",prop:"hisRouteCode",width:"90"}),n(p,{label:"名称(系统)",prop:"routeName","min-width":"110"}),n(p,{label:"代码(系统)",prop:"routeCode",width:"95"}),n(p,{label:"问题类型",prop:"questionLevel",width:"95","filter-multiple":!1,filters:[{text:"适用",value:"0"},{text:"禁用",value:"1"}],"column-key":"questionLevel"},{default:i(({row:o})=>[c("div",null,q(o.questionLevel=="0"?"适用":o.questionLevel=="1"?"禁用":""),1)]),_:1}),n(p,{label:"超说明书用药",prop:"whetherOverstepSynopsis","filter-multiple":!1,filters:[{text:"是",value:"1"},{text:"否",value:"0"}],width:"126","column-key":"whetherOverstepSynopsis"},{default:i(({row:o})=>[c("div",null,q(o.whetherOverstepSynopsis==1?"是":"否"),1)]),_:1}),n(p,{label:"禁慎用标识",prop:"active",width:"100",align:"center"},{default:i(({row:o})=>[c("span",null,q(o.questionLevel=="1"?o.warnSign=="0"?"禁用":o.warnSign=="1"?"慎用":"":""),1)]),_:1}),n(p,{label:"是否屏蔽",prop:"active",width:"85"},{default:i(({row:o})=>[n(he,{modelValue:o.active,"onUpdate:modelValue":S=>o.active=S,loading:t(_),onChange:S=>ue(o),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),_:1}),n(p,{label:"操作",width:"130",fixed:"right",align:"center",class:"td-active"},{default:i(({row:o})=>[n(C,{text:"",type:"primary",onClick:S=>J(o,"edit")},{default:i(()=>[te("编辑")]),_:2},1032,["onClick"]),n(C,{text:"",type:"primary",onClick:S=>Q({id:[o.id]})},{default:i(()=>[te("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[we,t(_)]]),n(ge,{"current-page":t(s).pageNum,"page-size":t(s).pageSize,total:t(s).total,onCurrentChange:t(F),onSizeChange:oe},null,8,["current-page","page-size","total","onCurrentChange"])]),_:1})],2),c("div",{class:E(["right-container",t(I)?"right-container-half":"right-container-all"])},[c("div",{class:"toggle-btn",onClick:ne},[Xe,c("div",Ze,[M(n(G,null,{default:i(()=>[n(_e)]),_:1},512),[[ae,t(I)]]),M(n(G,null,{default:i(()=>[n(ve)]),_:1},512),[[ae,!t(I)]])]),et]),n(A,{class:"no-bottom-card"},{default:i(()=>[n(xe,{dimensionCode:t(f),refId:t(z),id:t(T),ref_key:"ruleEditingBox",ref:x},null,8,["dimensionCode","refId","id"])]),_:1})],2)]),n(Ce,{ref_key:"editRowDiag",ref:N,onQuery:O},null,512)])}}}),gt=De(tt,[["__scopeId","data-v-4c3f1ef5"]]);export{gt as default};
