var V=(G,O,M)=>new Promise((L,w)=>{var C=i=>{try{g(M.next(i))}catch(b){w(b)}},v=i=>{try{g(M.throw(i))}catch(b){w(b)}},g=i=>i.done?L(i.value):Promise.resolve(i.value).then(C,v);g((M=M.apply(G,O)).next())});import{d as ae,aj as oe,P as te,r as f,b as re,m as c,T as se,o as p,c as R,y as s,s as u,x as _,p as n,t as ie,q as x,F as U,A as q,n as I,B as de,a6 as ue,H as me,ah as ce,_ as pe}from"./index-9sA7DK8G.js";import{g as ge,e as fe,d as be}from"./compatibilityConcentration-BC-gZbkn.js";const he={class:"edit-cf-edit-container"},_e={class:"radio-bg"},Ce={class:"radio-bg flex"},ve={class:"common-attention"},Me=ae({__name:"editCompatibilityConcentration",emits:["query"],setup(G,{expose:O,emit:M}){const L=M,w=oe(),C=te("$baseMessage"),v=f(!1),g=f(!1),i=f(""),b=f(),z=f([]),D=f([]),J=f([{label:"是",value:"1"},{label:"否",value:"0"}]),A={rmGeneralId:[{required:!0,message:"请选择溶媒",trigger:"change"}],rmConcentrationMin:[{required:!0,message:"请输入",trigger:"blur"}],rmConcentrationMax:[{required:!0,message:"请输入",trigger:"blur"}]},e=re({id:"",generalId:"",questionLevel:"0",reference:"",tipContent:"",rmGeneralId:"",syRouteCode:"",syRouteCodeTree:[],syRouteCodeList:[],rmDosageMin:null,rmDosageMax:null,rmConcentrationMin:null,rmConcentrationMax:null,whetherOverstepSynopsis:"0",active:"0",rmGeneralName:" "}),E=JSON.parse(JSON.stringify(e)),P=f([]),k=(r,l)=>(r.map(o=>{o.disabled=l,o.children&&k(o.children,l)}),r),H=(r,l)=>{const o=[...r];for(;o.length>0;){const m=o.shift();if(l(m))return m;if(m.children&&m.children.length>0)for(const t of m.children)o.push(t)}},K=r=>{let l=D.value;k(l,!1),r.map(o=>{let m=H(l,t=>t.routeCode==o);if(m.children){const t=k(m.children,!0);m.children=t}})},T=f(),$=r=>{let l=JSON.parse(JSON.stringify(r)),o=[];l.map(t=>{if(t.length==1)o.push(t),o=o.filter(d=>!(d.join(",").indexOf(t.join(","))>-1&&d.join(",").length>t.join(",").length));else if(o.length>0){let d=!1;for(let y=0;y<o.length;y++){for(let h=0;h<o[y].length;h++)if(t.indexOf(o[y][h])==-1){o.push(t),o=o.filter(N=>!(N.join(",").indexOf(t.join(","))>-1&&N.join(",").length>t.join(",").length)),d=!0;break}if(d)break}}else o.push(t),o=o.filter(d=>!(d.join(",").indexOf(t.join(","))>-1&&d.join(",").length>t.join(",").length))}),e.syRouteCodeTree=o;let m=[];r.map(t=>{m.push(t[t.length-1])}),m.length>0?K(m):k(D.value,!1)},Q=(r,l,o)=>V(this,null,function*(){e.generalId=o,v.value=!0,W(),yield B(""),l=="edit"||l=="check"?(i.value=l=="check"?"查看溶媒药物规则":"编辑溶媒药物规则",Object.assign(e,r),$(e.syRouteCodeTree)):(i.value="新增溶媒药物规则",P.value=[{generalId:"",generalName:""}])});function B(r){return V(this,null,function*(){const{data:l}=yield ge({keyword:r||"",pageNum:1,pageSize:10,isRm:"1"});z.value=l||[]})}function W(){return V(this,null,function*(){const{data:r}=yield fe({pageNum:1,pageSize:99999});D.value=r||[]})}function j(r){r==1?(e.rmDosageMax||e.rmDosageMax===0)&&(e.rmDosageMin||e.rmDosageMin===0)&&e.rmDosageMin>e.rmDosageMax&&(C("最小值不能大于最大值","warning","hey"),e.rmDosageMin=null):r==2?(e.rmDosageMax||e.rmDosageMax===0)&&(e.rmDosageMin||e.rmDosageMin===0)&&e.rmDosageMax<e.rmDosageMin&&(C("最大值不能小于最小值","warning","hey"),e.rmDosageMax=null):r==3?(e.rmConcentrationMax||e.rmConcentrationMax===0)&&(e.rmConcentrationMin||e.rmConcentrationMin===0)&&e.rmConcentrationMin>e.rmConcentrationMax&&(C("最小值不能大于最大值","warning","hey"),e.rmConcentrationMin=null):r==4&&(e.rmConcentrationMax||e.rmConcentrationMax===0)&&(e.rmConcentrationMin||e.rmConcentrationMin===0)&&e.rmConcentrationMax<e.rmConcentrationMin&&(C("最大值不能小于最小值","warning","hey"),e.rmConcentrationMax=null)}const S=()=>{g.value=!1,v.value=!1,b.value.resetFields(),Object.assign(e,E)},X=()=>V(this,null,function*(){b.value.validate(r=>V(this,null,function*(){if(r)try{let l=Object.assign({},e);const o=T.value.getCheckedNodes();l.syRouteCodeList=[],o.forEach(t=>{l.syRouteCodeList.push({name:t.pathLabels[t.pathLabels.length-1],value:t.pathValues[t.pathValues.length-1]})});const{msg:m}=yield be(l);g.value=!1,b.value.resetFields(),C(m,"success","hey"),S(),L("query")}catch(l){g.value=!1}}))});return O({showDiag:Q}),(r,l)=>{const o=c("el-option"),m=c("el-select"),t=c("el-input"),d=c("el-form-item"),y=c("el-cascader"),h=c("el-input-number"),N=me,Y=c("el-radio"),Z=c("el-radio-group"),ee=c("el-form"),F=c("el-button"),le=ce,ne=se("loading");return p(),R("div",he,[s(le,{modelValue:n(v),"onUpdate:modelValue":l[15]||(l[15]=a=>ue(v)?v.value=a:null),title:n(i),width:"826px",modal:!1,"append-to-body":"",onClose:S,class:"no-form-line-margin pointerEvents"},{footer:u(()=>[s(F,{onClick:S},{default:u(()=>[_("取 消")]),_:1}),s(F,{disabled:n(g),type:"primary",onClick:X},{default:u(()=>[_("确 定")]),_:1},8,["disabled"])]),default:u(()=>[ie((p(),x(ee,{ref_key:"formRef",ref:b,model:n(e),"label-width":"120px",rules:A},{default:u(()=>[s(d,{label:"溶媒选择",prop:"rmGeneralId"},{default:u(()=>[n(i)=="新增溶媒药物规则"?(p(),x(m,{key:0,modelValue:n(e).rmGeneralId,"onUpdate:modelValue":l[0]||(l[0]=a=>n(e).rmGeneralId=a),size:"large",placeholder:"请选择",remote:"","remote-method":B,filterable:""},{default:u(()=>[(p(!0),R(U,null,q(n(z),a=>(p(),x(o,{key:a.id,label:a.generalName,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(p(),x(t,{key:1,placeholder:"请选择",modelValue:n(e).rmGeneralName,"onUpdate:modelValue":l[1]||(l[1]=a=>n(e).rmGeneralName=a),disabled:""},null,8,["modelValue"]))]),_:1}),s(d,{label:"给药途径"},{default:u(()=>[s(y,{ref_key:"cascaderRef",ref:T,options:n(D),modelValue:n(e).syRouteCodeTree,"onUpdate:modelValue":l[2]||(l[2]=a=>n(e).syRouteCodeTree=a),filterable:"",props:{checkStrictly:!0,multiple:!0,value:"routeCode",label:"routeName"},clearable:"","collapse-tags":!0,placeholder:"请选择",style:{width:"100%"},disabled:n(i)=="查看溶媒药物规则",onChange:$},null,8,["options","modelValue","disabled"])]),_:1}),s(d,{label:"溶媒量范围"},{default:u(()=>[I("div",_e,[s(h,{modelValue:n(e).rmDosageMin,"onUpdate:modelValue":l[3]||(l[3]=a=>n(e).rmDosageMin=a),min:0,"controls-position":"right",size:"large",class:"w-80",onChange:l[4]||(l[4]=a=>j(1)),disabled:n(i)=="查看溶媒药物规则"},null,8,["modelValue","disabled"]),_(" 至 "),s(h,{modelValue:n(e).rmDosageMax,"onUpdate:modelValue":l[5]||(l[5]=a=>n(e).rmDosageMax=a),min:0,"controls-position":"right",size:"large",class:"w-80",onChange:l[6]||(l[6]=a=>j(2)),disabled:n(i)=="查看溶媒药物规则"},null,8,["modelValue","disabled"]),_(" ml ")])]),_:1}),s(d,{label:"浓度范围",required:""},{default:u(()=>[I("div",Ce,[s(d,{prop:"rmConcentrationMin"},{default:u(()=>[s(h,{modelValue:n(e).rmConcentrationMin,"onUpdate:modelValue":l[7]||(l[7]=a=>n(e).rmConcentrationMin=a),min:0,"controls-position":"right",size:"large",class:"w-80",onChange:l[8]||(l[8]=a=>j(3)),disabled:n(i)=="查看溶媒药物规则"},null,8,["modelValue","disabled"])]),_:1}),_(" 至 "),s(d,{prop:"rmConcentrationMax"},{default:u(()=>[s(h,{modelValue:n(e).rmConcentrationMax,"onUpdate:modelValue":l[9]||(l[9]=a=>n(e).rmConcentrationMax=a),min:0,"controls-position":"right",size:"large",class:"w-80",onChange:l[10]||(l[10]=a=>j(4)),disabled:n(i)=="查看溶媒药物规则"},null,8,["modelValue","disabled"])]),_:1}),_(" % "),I("span",ve,[s(N,{icon:"icon-xintishi"}),_(" 说明：浓度按常用的100ml含多少g来进行计算 ")])])]),_:1}),s(d,{label:"问题等级"},{default:u(()=>[s(m,{modelValue:n(e).questionLevel,"onUpdate:modelValue":l[11]||(l[11]=a=>n(e).questionLevel=a),size:"large",placeholder:"请选择",disabled:n(i)=="查看溶媒药物规则"},{default:u(()=>[(p(!0),R(U,null,q(n(w).wordbook.problem_level_rule,a=>(p(),x(o,{key:a.dictLabel,label:a.dictLabel,value:a.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),s(d,{label:"是否超说明书用药"},{default:u(()=>[s(Z,{modelValue:n(e).whetherOverstepSynopsis,"onUpdate:modelValue":l[12]||(l[12]=a=>n(e).whetherOverstepSynopsis=a),class:"radio-bg"},{default:u(()=>[(p(!0),R(U,null,q(n(J),a=>(p(),x(Y,{key:a.value,value:a.value,label:a.label,disabled:n(i)=="查看溶媒药物规则"},{default:u(()=>[_(de(a.label),1)]),_:2},1032,["value","label","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(d,{label:"参考文献"},{default:u(()=>[s(t,{modelValue:n(e).reference,"onUpdate:modelValue":l[13]||(l[13]=a=>n(e).reference=a),placeholder:"请输入",type:"textarea",style:{width:"100%"},rows:3,disabled:n(i)=="查看溶媒药物规则",maxlength:"1000","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1}),s(d,{label:"提示内容"},{default:u(()=>[s(t,{modelValue:n(e).tipContent,"onUpdate:modelValue":l[14]||(l[14]=a=>n(e).tipContent=a),placeholder:"请输入",type:"textarea",style:{width:"100%"},rows:4,disabled:n(i)=="查看溶媒药物规则",maxlength:"1000","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1})]),_:1},8,["model"])),[[ne,n(g)]])]),_:1},8,["modelValue","title"])])}}}),we=pe(Me,[["__scopeId","data-v-7df02434"]]);export{we as default};
