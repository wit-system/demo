var ne=Object.defineProperty,re=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var j=(n,l,r)=>l in n?ne(n,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[l]=r,N=(n,l)=>{for(var r in l||(l={}))oe.call(l,r)&&j(n,r,l[r]);if(P)for(var r of P(l))ie.call(l,r)&&j(n,r,l[r]);return n},V=(n,l)=>re(n,le(l));var q=(n,l,r)=>new Promise((R,k)=>{var L=t=>{try{f(r.next(t))}catch(h){k(h)}},c=t=>{try{f(r.throw(t))}catch(h){k(h)}},f=t=>t.done?R(t.value):Promise.resolve(t.value).then(L,c);f((r=r.apply(n,l)).next())});import se from"./winAdd-CLFUG9SP.js";import{d as ue,aj as de,P as A,r as u,b as ce,l as me,b9 as ge,a0 as fe,m as x,o as m,c as v,y as g,p as i,a6 as he,n as F,s as d,B as o,z as C,F as pe,A as ve,q as we,C as O,x as W,af as _e,ag as ye,_ as be}from"./index-CmC8Jr0A.js";import{_ as Ce}from"./index.vue_vue_type_style_index_0_lang-D4meg1a3.js";import{l as Re,e as ke,a as xe,b as Le}from"./vertifyAuditRule-Czbca3Z3.js";import"./ifComponent.vue_vue_type_style_index_0_lang-ZpisXDR_.js";import"./index-COFi4TtR.js";import"./index.vue_vue_type_script_setup_true_lang-DtyLHHVv.js";import"./dict-BvhWhz6G.js";const Ne={class:"vertify-audit flex-column"},Ve={class:"padding-horizontal flex-all"},Fe={key:0},Se={key:1},Te={key:2},$e={key:3},ze={key:4},Me=ue({__name:"index",props:{signs:{type:Number,default:0},ruleForm:{type:Object,default:()=>({id:"",generalName:""})}},emits:["tableRowClick"],setup(n,{emit:l}){const r=de(),R=A("$baseMessage"),k=A("$baseConfirm"),L=l,c=n,f=u(0),t=u({laboratoryCode:"",generalId:"",generalName:""});let h=u([]);const S=ce({searchListButtons:[{label:"搜 索",isShowLoading:!0,attrs:{type:"primary"},events:{click:y}}],searchList:[{type:"select",field:"laboratoryCode",label:"检验项",valueField:"hosLaboratoryCode",labelField:"hosLaboratoryName",isOutBorder:!0,options:[],attrs:{width:130,placeholder:"请选择",filterable:!0,clearable:!0}}],rightSearchListButtons:[{label:"新增",icon:"icon-xinzengdianpingjihua",isShowLoading:!0,attrs:{type:"warning",plain:!0},events:{click:()=>U({})}}]}),T=u(null),w=u(!1),_=u([]),$=u([{width:"50",title:"序号",type:"seq"},{field:"isInspectionReport",title:"检验报告",width:"75",render:!0},{field:"reportingCycle",title:"报告周期",width:"80",render:!0},{field:"laboratoryName",title:"检验项",minWidth:"120"},{field:"referenceRangeType",title:"区间",minWidth:"140",render:!0},{field:"unit",title:"单位",width:"50"},{field:"severity",title:"自定义级别",width:"100",render:!0},{field:"active",title:"是否屏蔽",width:"80",render:!0},{field:"btns",title:"操作",align:"center",width:"120",fixed:"right",render:!0}]),b=u([]);me(()=>c.signs,a=>{a===1?(b.value=[...$.value],ge("editor")&&(b.value.splice(1,0,{field:"updateName",title:"编辑人",width:"80"}),b.value.splice(2,0,{field:"updateTime",title:"编辑时间",width:"165"}))):b.value=[...$.value]},{immediate:!0});const E=()=>q(this,null,function*(){const{data:a}=yield Re();h.value=a||[],S.searchList[0].options=h.value});fe(()=>{t.value.generalId=c.ruleForm.id,t.value.generalName=c.ruleForm.generalName,E()});const z=u(null);function y(){z.value.search()}const Q=()=>{w.value=!0,ke(V(N({},t.value),{signs:c.signs==0?0:""})).then(({data:a})=>{w.value=!1,_.value=a.records||[],f.value=a.total,_.value.length>0&&(T.value.tableMethods("setCurrentRow",_.value[0]),M({row:_.value[0]}))}).catch(()=>{w.value=!1,_.value=[],f.value=0})},M=({row:a})=>{L("tableRowClick",a)};function B(a){xe(V(N({},a),{generalId:c.ruleForm.id,generalName:c.ruleForm.generalName})).then(({msg:p})=>{R(p,"success","hey")}).catch(()=>{y()})}const I=u();function U(a){I.value.open(a)}function G(a){k("您确定要删除当前项吗","是否确定删除？",()=>{Le(a).then(({data:p})=>{R("删除成功","success","hey"),y()})})}const H=a=>{t.value.pageNum=1,t.value.pageSize=a,y()},J=a=>{t.value.pageNum=a,y()};return(a,p)=>{const K=Ce,X=x("el-option"),Y=x("el-select"),Z=x("el-switch"),D=x("el-button"),ee=_e,te=ye,ae=se;return m(),v("div",Ne,[g(K,{ref_key:"searchRef",ref:z,modelValue:i(t),"onUpdate:modelValue":p[0]||(p[0]=e=>he(t)?t.value=e:null),"search-data":i(S),"search-name":"matching-tools-vertify-audit-rule-search",searching:i(w),border:!1,onSearch:Q},null,8,["modelValue","search-data","searching"]),F("div",Ve,[g(ee,{ref_key:"tableRef",ref:T,"table-name":"matching-tools-vertify-audit-rule-table",loading:i(w),"table-data":i(_),columns:i(b),isShowTableSet:!1,onCellClick:M},{isInspectionReport:d(e=>[F("span",null,o(e.row.isInspectionReport==1?"存在":"不存在"),1)]),reportingCycle:d(e=>[F("span",null,o(e.row.reportingCycle)+"天内",1)]),referenceRangeType:d(e=>[e.row.referenceRangeType==1?(m(),v("span",Fe," 偏高或偏低("+o(["","大于","大于等于","小于","小于等于"][Number(e.row.referenceCondition)])+o(e.row.referenceFixedValue)+o(e.row.unit)+") ",1)):C("",!0),e.row.referenceRangeType==2?(m(),v("span",Se," 区间内("+o(e.row.referenceRangeMin)+"-"+o(e.row.referenceRangeMax)+o(e.row.unit)+") ",1)):C("",!0),e.row.referenceRangeType==3?(m(),v("span",Te," 区间外("+o(e.row.referenceRangeMin)+"-"+o(e.row.referenceRangeMax)+o(e.row.unit)+") ",1)):C("",!0),e.row.referenceRangeType==4?(m(),v("span",$e,"固定值("+o(e.row.referenceFixedValue)+o(e.row.unit)+")",1)):C("",!0),e.row.referenceRangeType==5?(m(),v("span",ze,"非数值类型("+o(e.row.referenceRange)+")",1)):C("",!0)]),severity:d(e=>[g(Y,{modelValue:e.row.severity,"onUpdate:modelValue":s=>e.row.severity=s,placeholder:"请选择",onChange:s=>B(e.row)},{default:d(()=>[(m(!0),v(pe,null,ve(i(r).wordbook.problem_level_rule,s=>(m(),we(X,{key:s.dictLabel,label:s.dictLabel,value:s.dictValue},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),active:d(e=>[g(Z,{modelValue:e.row.active,"onUpdate:modelValue":s=>e.row.active=s,loading:i(w),onClick:p[1]||(p[1]=O(()=>{},["stop"])),onChange:s=>B(e.row),"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),btns:d(e=>[g(D,{text:"",type:"primary",disabled:n.signs==1&&e.row.signs==0,onClick:s=>U(e.row)},{default:d(()=>[W("编辑")]),_:2},1032,["disabled","onClick"]),g(D,{text:"",type:"primary",disabled:n.signs==1&&e.row.signs==0,onClick:O(s=>G(e.row.id),["stop"])},{default:d(()=>[W(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:1},8,["loading","table-data","columns"])]),g(te,{layout:"total, sizes, prev, pager, next","current-page":i(t).pageNum,"page-size":i(t).pageSize,total:i(f),"prev-text":"上一页","next-text":"下一页",onCurrentChange:J,onSizeChange:H},null,8,["current-page","page-size","total"]),g(ae,{ref_key:"addRef",ref:I,signs:n.signs,ruleForm:n.ruleForm,laboratoryList:i(h),onQuery:y},null,8,["signs","ruleForm","laboratoryList"])])}}}),We=be(Me,[["__scopeId","data-v-b8cec1ec"]]);export{We as default};
